{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 4970b119575f3113a15a","webpack:///./src/utils/index.js","webpack:///./src/utils/streamy.js","webpack:///./src/index.js","webpack:///./src/utils/streamy-dom.js","webpack:///./test/helpers/test-component.js","webpack:///./~/deep-equal/index.js","webpack:///./~/deep-equal/lib/is_arguments.js","webpack:///./~/deep-equal/lib/keys.js","webpack:///./~/process/browser.js","webpack:///./~/setimmediate/setImmediate.js","webpack:///./~/timers-browserify/main.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/utils/router.js","webpack:///./src/utils/streamy-helpers.js","webpack:///./src/utils/streamy-hyperscript.js"],"names":["merge$","isStream","stream","init_value","s","value","undefined","update","IS_STREAM","listeners","map","fn","is","cur","flatMap","filter","deepSelect","distinct","$","selectorArr","query","until","stopEmit$","patch","partialChange","reduce","startValue","debounce","timer","valuesChanged","oldValue","newValue","parent$","notifyListeners","forEach","notifyListener","listener","fork$","mapFunction","initValue","newStream","push","mapValue","result$","updateOuterStream","result","attachToResult$","mapFn","parentValue","getChildStreamValue","flatMapValue","removeItem","filterValue","selector","selectors","split","select","parent","input","deepSelectValue","Array","isArray","a","b","setImmediate","Object","assign","stopEmitValues$","subscribeTo","stopEmitValues","aggregate","reduceValue","curTimer","debounceValue","window","clearTimeout","setTimeout","updateChildStream","potentialStreamsArr","values","indexOf","potentialStream","index","updateMergedStream","arr","item","splice","render","diff","createNode","TEXT_NODE","vdom$","parentElement","renderUpdate","oldElement","element","oldVersion","version","oldChildren","children","keyContainer","tag","props","appendChild","newElement","triggerLifecycle","copyChildren","newChildren","newVersion","cacheContainer","isCaching","id","diffCachedElement","diffElement","gotCreated","gotUpdated","document","createElement","vdom","elementCache","diffAttributes","diffChildren","replaceChild","isTextNode","updateTextNode","shouldRecycleElement","removeNotNeededNodes","parentElements","remaining","childNodes","length","childToRemove","removeChild","console","log","updateExistingNodes","nodes","i","oldChildChildren","addNewNodes","cycle","mounted","error","getOwnPropertyNames","applyPropertyToElement","attribute","applyAttribute","cleanupAttributes","className","style","removeAttribute","oldChildNodes","unifiedNewChildren","unifyChildren","unifiedOldChildren","child","createTextNode","JSON","parse","stringify","oldChild","event","nodeTypeDiffers","nodeName","toLowerCase","Text","nodeValue","testRender","test$","schedule","done","container","iteration","Error","testSchedule","fail","pSlice","prototype","slice","objectKeys","require","isArguments","deepEqual","module","exports","actual","expected","opts","Date","getTime","strict","objEquiv","isUndefinedOrNull","isBuffer","x","copy","key","call","ka","kb","e","sort","supportsArgumentsClass","toString","arguments","supported","unsupported","object","hasOwnProperty","propertyIsEnumerable","keys","shim","obj","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","nextTick","args","Item","array","apply","title","browser","env","argv","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","name","binding","cwd","chdir","dir","umask","global","nextHandle","tasksByHandle","currentlyRunningATask","doc","registerImmediate","callback","Function","task","clearImmediate","handle","runIfPresent","installNextTickImplementation","canUsePostMessage","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","installPostMessageImplementation","messagePrefix","Math","random","onGlobalMessage","source","data","addEventListener","attachEvent","installMessageChannelImplementation","channel","MessageChannel","port1","port2","installReadyStateChangeImplementation","html","documentElement","script","onreadystatechange","installSetTimeoutImplementation","attachTo","getPrototypeOf","self","Timeout","setInterval","clearInterval","close","clearFn","_id","_clearFn","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","onTimeout","_onTimeout","g","eval","Router","initRouter","interceptLinks","routerState$","interceptClickEvent","target","srcElement","tagName","href","getAttribute","isLocal","startsWith","isAnchor","parseLink","anchor","route","goTo","preventDefault","onpopstate","state","dispatchRouteChange","location","pathname","search","hash","getUrlParams","urlRegex","regExResultHash","RegExp","exec","regExResultSearch","vars","params","pair","decodeURIComponent","children$","router$","routes","sanitizedRoute$","routeWasHit$","wasHit","link","regexp","matchArr","substr","history","pushState","if$","join$","promise$","promise","output$","loading","then","boolean$","onTrue","onFalse","$arr","join","flatten","h","component","mergedChildren$","mergeChildren$","wrapProps$","_","childrenVdom$arr","getChildrenVdom$arr","childrenArr","children$Arr","makeArray","vdomArr","makeStreams","mutable","arrayTypeStr","node","pop","reverse","nestedStreams","extractNestedStreams","updateStreams","makeNestedStreamUpdateProps"],"mappings":"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","file":"zliq.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"zliq\"] = factory();\n\telse\n\t\troot[\"zliq\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4970b119575f3113a15a","export * from './streamy';\r\nexport * from './streamy-dom';\r\nexport * from './streamy-hyperscript';\r\nexport * from './streamy-helpers';\r\nexport * from './router';\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js","import deepEqual from 'deep-equal';\r\n\r\n/*\r\n* stream constructor\r\n* constructor returns a stream\r\n* get the current value of stream like: stream.value\r\n*/\r\nexport const stream = function(init_value) {\r\n\tlet s = function(value) {\r\n\t\tif (value === undefined) {\r\n\t\t\treturn s.value;\r\n\t\t}\r\n\t\tupdate(s, value);\r\n\t\treturn s;\r\n\t}\r\n\r\n\ts.IS_STREAM = true;\r\n\ts.value = init_value;\r\n\ts.listeners = [];\r\n\r\n\ts.map = (fn) => map(s, fn);\r\n\ts.is = (value) => map(s, (cur) => cur === value);\r\n\ts.flatMap = (fn) => flatMap(s, fn);\r\n\ts.filter = (fn) => filter(s, fn);\r\n\ts.deepSelect = (fn) => deepSelect(s, fn);\r\n\ts.distinct = (fn) => distinct(s, fn);\r\n\ts.$ = (selectorArr) => query(s, selectorArr);\r\n\ts.until = (stopEmit$) => until(s, stopEmit$);\r\n\ts.patch = (partialChange) => patch(s, partialChange);\r\n\ts.reduce = (fn, startValue) => reduce(s, fn, startValue);\r\n\ts.debounce = (timer) => debounce(s, timer);\r\n\r\n\treturn s;\r\n};\r\n\r\n/*\r\n* wrapper for the diffing of stream values\r\n*/\r\nfunction valuesChanged(oldValue, newValue) {\r\n\treturn !deepEqual(oldValue, newValue);\r\n}\r\n\r\n/*\r\n* update the stream value and notify listeners on the stream\r\n*/\r\nfunction update(parent$, newValue) {\r\n\tparent$.value = newValue;\r\n\tnotifyListeners(parent$.listeners, newValue);\r\n};\r\n\r\n/*\r\n* provide a new value to all listeners registered for a stream\r\n*/\r\nfunction notifyListeners(listeners, value) {\r\n\tlisteners.forEach(function notifyListener(listener) {\r\n\t\tlistener(value);\r\n\t});\r\n}\r\n\r\n/*\r\n* Do not pipe the value undefined. This allows to wait for an external initialization.\r\n* It also saves you from checking for an initial null on every map function.\r\n*/\r\nfunction fork$(parent$, mapFunction) {\r\n\tlet initValue = parent$.value !== undefined ? mapFunction(parent$.value) : undefined\r\n\treturn stream(initValue);\r\n}\r\n\r\n/*\r\n* provides a new stream applying a transformation function to the value of a parent stream\r\n*/\r\nfunction map(parent$, fn) {\r\n\tlet newStream = fork$(parent$, fn);\r\n\tparent$.listeners.push(function mapValue(value) {\r\n\t\tnewStream(fn(value));\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* provides a new stream applying a transformation function to the value of a parent stream\r\n*/\r\nfunction flatMap(parent$, fn) {\r\n\tlet result$;\r\n\tlet listener = function updateOuterStream(result) {\r\n\t\tnewStream(result);\r\n\t};\r\n\tfunction attachToResult$(mapFn, parentValue, listener) {\r\n\t\tlet result$ = mapFn(parentValue);\r\n\t\tresult$.listeners.push(listener);\r\n\t\treturn result$;\r\n\t}\r\n\tlet newStream = fork$(parent$, function getChildStreamValue(value) {\r\n\t\tresult$ = attachToResult$(fn, value, listener);\r\n\t\treturn result$.value;\r\n\t});\r\n\tparent$.listeners.push(function flatMapValue(value) {\r\n\t\t// clean up listeners or they will stack on child streams\r\n\t\tif (result$) {\r\n\t\t\tremoveItem(result$.listeners, listener);\r\n\t\t}\r\n\r\n\t\tresult$ = attachToResult$(fn, value, listener);\r\n\t\tnewStream(result$.value);\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* provides a new stream that only serves the values that a filter function returns true for\r\n* still a stream ALWAYS has a value -> so it starts at least with NULL\r\n*/\r\nfunction filter(parent$, fn) {\r\n\tlet newStream = fork$(parent$, (value) => fn(value) ? value : undefined);\r\n\tparent$.listeners.push(function filterValue(value) {\r\n\t\tif (fn(value)) {\r\n\t\t\tnewStream(value);\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* provides a new stream that has a selected sub property of the object value of the parent stream\r\n* the selector has the format [{propertyName}.]*\r\n*/\r\nfunction deepSelect(parent$, selector) {\r\n\tlet selectors = selector.split('.');\r\n\r\n\tfunction select(parent, selectors) {\r\n\t\treturn selectors.reduce((input, selector) => {\r\n\t\t\treturn input[selector];\r\n\t\t}, parent);\r\n\t}\r\n\r\n\tlet newStream = fork$(parent$, (value) => select(value, selectors));\r\n\tparent$.listeners.push(function deepSelectValue(newValue) {\r\n\t\tnewStream(select(newValue, selectors));\r\n\t});\r\n\treturn newStream;\r\n};\r\n\r\nfunction query(parent$, selectorArr) {\r\n\tif(!Array.isArray(selectorArr)) {\r\n\t\treturn deepSelect(parent$, selectorArr);\r\n\t}\r\n\treturn merge$(selectorArr.map(selector => deepSelect(parent$, selector)));\r\n}\r\n\r\n// TODO: maybe refactor with filter\r\n/*\r\n* provide a new stream that only notifys its children if the containing value actualy changes\r\n*/\r\nfunction distinct(parent$, fn = (a, b) => valuesChanged(a, b)) {\r\n\tlet newStream = fork$(parent$, (value) => value);\r\n\tparent$.listeners.push(function deepSelectValue(value) {\r\n\t\tif (fn(newStream.value, value)) {\r\n\t\t\tnewStream(value);\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* update only the properties of an object passed\r\n* i.e. {name: 'Fabian', lastname: 'Weber} patched with {name: 'Fabo'} produces {name: 'Fabo', lastname: 'Weber}\r\n*/\r\nfunction patch(parent$, partialChange) {\r\n\tsetImmediate(() => {\r\n\t\tif (parent$.value == null) {\r\n\t\t\tparent$(partialChange);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tparent$(Object.assign({}, parent$.value, partialChange));\r\n\t})\r\n}\r\n\r\nfunction until(parent$, stopEmitValues$) {\r\n\tlet newStream = stream(stopEmitValues$.value ? undefined : parent$.value);\r\n\tlet subscribeTo = (stream) => {\r\n\t\tnewStream(parent$.value);\r\n\t\tstream.listeners.push(newStream);\r\n\t}\r\n\tstopEmitValues$.map(stopEmitValues => {\r\n\t\tif(stopEmitValues) {\r\n\t\t\tremoveItem(parent$.listeners, newStream);\r\n\t\t} else {\r\n\t\t\tsubscribeTo(parent$);\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* reduce a stream over time\r\n* this will pass the last output value to the calculation function\r\n* reads like the array reduce function\r\n*/\r\nfunction reduce(parent$, fn, startValue) {\r\n\tlet aggregate = startValue;\r\n\tlet newStream = stream();\r\n\tfunction reduceValue(value) {\r\n\t\taggregate = fn(aggregate, parent$.value);\r\n\t\tnewStream(aggregate);\r\n\t}\r\n\tif (parent$.value !== undefined) {\r\n\t\treduceValue(parent$.value);\r\n\t};\r\n\tparent$.listeners.push(reduceValue);\r\n\treturn newStream;\r\n}\r\n\r\nfunction debounce(parent$, timer) {\r\n\tlet curTimer;\r\n\tfunction debounceValue(value) {\r\n\t\tif (curTimer) {\r\n\t\t\twindow.clearTimeout(curTimer);\r\n\t\t}\r\n\t\tcurTimer = setTimeout(function updateChildStream() {\r\n\t\t\tnewStream(value);\r\n\t\t\tcurTimer = null;\r\n\t\t}, timer);\r\n\t}\r\n\tlet newStream = stream();\r\n\tif (parent$.value !== undefined) {\r\n\t\tdebounceValue(parent$.value);\r\n\t}\r\n\tparent$.listeners.push(debounceValue);\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* merge several streams into one stream providing the values of all streams as an array\r\n* accepts also non stream elements, those are just copied to the output\r\n* the merge will only have a value if every stream for the merge has a value\r\n*/\r\nexport function merge$(potentialStreamsArr) {\r\n\tlet values = potentialStreamsArr.map(parent$ => parent$ && parent$.IS_STREAM ? parent$.value : parent$);\r\n\tlet newStream = stream(values.indexOf(undefined) === -1 ? values : undefined);\r\n\r\n\tpotentialStreamsArr.forEach((potentialStream, index) => {\r\n\t\tif (potentialStream.IS_STREAM) {\r\n\t\t\tpotentialStream.listeners.push(function updateMergedStream(value) {\r\n\t\t\t\tvalues[index] = value;\r\n\t\t\t\tnewStream(values.indexOf(undefined) === -1 ? values : undefined);\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\nexport function isStream(parent$) {\r\n\treturn parent$ != null && !!parent$.IS_STREAM;\r\n}\r\n\r\nfunction removeItem(arr, item) {\r\n\tvar index = arr.indexOf(item);\r\n\tif (index !== -1) {\r\n\t\tarr.splice(index, 1);\r\n\t}\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy.js","export * from './utils';\r\nexport * from '../test/helpers/test-component';\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import {isStream} from './streamy';\r\n\r\nconst TEXT_NODE = '#text';\r\n\r\nexport function render(vdom$, parentElement, debounce = 10) {\r\n\treturn vdom$.debounce(debounce).reduce(\r\n\t\tfunction renderUpdate({\r\n\t\t\t\telement:oldElement,\r\n\t\t\t\tversion:oldVersion,\r\n\t\t\t\tchildren:oldChildren,\r\n\t\t\t\tkeyContainer\r\n\t\t\t}, {tag, props, children, version}) {\r\n\t\t\t\tif (oldElement === null) {\r\n\t\t\t\t\toldElement = createNode(tag, children);\r\n\t\t\t\t\tif (parentElement) {\r\n\t\t\t\t\t\tparentElement.appendChild(oldElement);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet newElement = diff(oldElement, tag, props, children, version, oldChildren, oldVersion, keyContainer);\r\n\r\n\t\t\t\t// signalise mount of root element on initial render\r\n\t\t\t\tif (parentElement && version === 0) {\r\n\t\t\t\t\ttriggerLifecycle(oldElement, props, 'mounted');\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\telement: newElement,\r\n\t\t\t\t\tversion,\r\n\t\t\t\t\tchildren: copyChildren(children),\r\n\t\t\t\t\tkeyContainer\r\n\t\t\t\t}\r\n\t\t}, {\r\n\t\t\telement: null,\r\n\t\t\tversion: -1,\r\n\t\t\tchildren: [],\r\n\t\t\tkeyContainer: {}\r\n\t\t})\r\n}\r\n\r\nexport function diff(oldElement, tag, props, newChildren, newVersion, oldChildren, oldVersion, cacheContainer) {\r\n\tlet newElement = oldElement;\r\n\tlet isCaching = props && props.id;\r\n\t// for keyed elements, we recall unchanged elements\r\n\tif (isCaching) {\r\n\t\tnewElement = diffCachedElement(oldElement, tag, props, newChildren, newVersion, cacheContainer);\r\n\t} else {\r\n\t\tnewElement = diffElement(oldElement, tag, props, newChildren, newVersion, oldChildren, oldVersion, cacheContainer);\r\n\t}\r\n\r\n\treturn newElement;\r\n}\r\n\r\n\r\n\r\nfunction diffCachedElement(oldElement, tag, props, newChildren, newVersion, cacheContainer) {\r\n\tlet id = props.id;\r\n\tlet gotCreated = false;\r\n\tlet gotUpdated = false;\r\n\r\n\t// if there is no cache, create one\r\n\tif (cacheContainer[id] === undefined) {\r\n\t\tcacheContainer[id] = {\r\n\t\t\telement: document.createElement(tag),\r\n\t\t\tvdom: {\r\n\t\t\t\ttag,\r\n\t\t\t\tprops: {},\r\n\t\t\t\tchildren: []\r\n\t\t\t}\r\n\t\t}\r\n\t\tgotCreated = true;\r\n\t}\r\n\r\n\tlet elementCache = cacheContainer[id];\r\n\r\n\t// ignore update if version equals cache\r\n\tif (newVersion !== elementCache.version) {\r\n\t\tdiffAttributes(elementCache.element, props);\r\n\t\tdiffChildren(elementCache.element, newChildren, elementCache.vdom.children, cacheContainer);\r\n\t\t\r\n\t\telementCache.version = newVersion;\r\n\t\telementCache.vdom.props = props;\r\n\t\telementCache.vdom.children = newChildren;\r\n\r\n\t\tgotUpdated = true;\r\n\t}\r\n\r\n\tif (gotCreated) {\r\n\t\ttriggerLifecycle(elementCache.element, props, 'created');\r\n\t} else if (gotUpdated) {\r\n\t\ttriggerLifecycle(elementCache.element, props, 'updated');\r\n\t}\r\n\r\n\t// elements are updated in place, so only insert cached element if it's not already there\r\n\tif (oldElement !== elementCache.element) {\r\n\t\toldElement.parentElement.replaceChild(elementCache.element, oldElement);\r\n\t\ttriggerLifecycle(elementCache.element, props, 'mounted');\r\n\t}\r\n\r\n\treturn elementCache.element;\r\n}\r\n\r\nfunction diffElement(element, tag, props, newChildren, newVersion, oldChildren, oldVersion, cacheContainer) {\r\n\t// text nodes behave differently then normal dom elements\r\n\tif (isTextNode(element) && tag === TEXT_NODE ) {\r\n\t\tupdateTextNode(element, newChildren[0]);\r\n\t\treturn element;\r\n\t}\r\n\r\n\t// if the node types do not differ, we reuse the old node\r\n\t// we reuse the existing node to save time rerendering it\r\n\t// we do not reuse/mutate cached (id) elements as this will mutate the cache\r\n\tif (shouldRecycleElement(element, props, tag) === false) {\r\n\t\tlet newElement = createNode(tag, newChildren);\r\n\t\telement.parentElement.replaceChild(newElement, element);\r\n\t\telement = newElement;\r\n\t\t// there are no children anymore on the newly created node\r\n\t\toldChildren = [];\r\n\t}\r\n\r\n\tdiffAttributes(element, props);\r\n\r\n\t// text nodes have no real child-nodes, but have a string value as first child\r\n\tif (tag !== TEXT_NODE) {\r\n\t\tdiffChildren(element, newChildren, oldChildren, cacheContainer);\r\n\t}\r\n\t\r\n\tif (newVersion === 0) {\r\n\t\ttriggerLifecycle(element, props, 'created');\r\n\t}\r\n\r\n\tif (newVersion > 0) {\r\n\t\ttriggerLifecycle(element, props, 'updated');\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n\r\n// this removes nodes at the end of the children, that are not needed anymore in the current state for recycling\r\nfunction removeNotNeededNodes(parentElements, newChildren, oldChildren) {\r\n\tfor(let remaining = parentElements.childNodes.length; remaining > newChildren.length; remaining--) {\r\n\t\tlet childToRemove = parentElements.childNodes[remaining - 1];\r\n\t\tparentElements.removeChild(childToRemove);\r\n\r\n\t\tif (oldChildren.length < remaining) {\r\n\t\t\tconsole.log(\"ZLIQ: Something other then ZLIQ has manipulated the children of the element\", parentElements, \". This can lead to sideffects. Please check your code.\");\r\n\t\t\tcontinue;\r\n\t\t} else {\r\n\t\t\tlet {props} = oldChildren[remaining - 1];\r\n\r\n\t\t\ttriggerLifecycle(childToRemove, props, 'removed');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction updateExistingNodes(parentElement, newChildren, oldChildren, cacheContainer) {\r\n\tlet nodes = parentElement.childNodes;\r\n\tfor(let i = 0; i < nodes.length && i < newChildren.length; i++) {\r\n\t\tlet oldElement = nodes[i];\r\n\t\tlet {version: oldVersion, children: oldChildChildren} = oldChildren[i];\r\n\t\tlet {tag, props, children, version} = newChildren[i];\r\n\r\n\t\tdiff(oldElement, tag, props, children, version, oldChildChildren, oldVersion, cacheContainer);\r\n\t}\r\n}\r\n\r\nfunction addNewNodes(parentElement, newChildren, cacheContainer) {\r\n\tfor(let i = parentElement.childNodes.length; i < newChildren.length; i++) {\r\n\t\tlet {tag, props, children, version} = newChildren[i];\r\n\t\tlet newElement = createNode(tag, children);\r\n\r\n\t\tparentElement.appendChild(newElement);\r\n\r\n\t\tdiff(newElement, tag, props, children, version, [], -1, cacheContainer);\r\n\r\n\t\tif (props && props.cycle && props.cycle.mounted) {\r\n\t\t\tconsole.error('The \\'mounted\\' lifecycle event is only called on elements with id. As elements are updated in place, it is hard to define when a normal element is mounted.');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction diffAttributes(element, props) {\r\n\tif (props !== undefined) {\r\n\t\tObject.getOwnPropertyNames(props).map(function applyPropertyToElement(attribute) {\r\n\t\t\tapplyAttribute(element, attribute, props[attribute])\r\n\t\t});\r\n\t\tcleanupAttributes(element, props);\r\n\t}\r\n}\r\n\r\nfunction applyAttribute(element, attribute, value) {\r\n\tif (attribute === 'class' || attribute === 'className') {\r\n\t\telement.className = value || '';\r\n\t// we leave the possibility to define styles as strings\r\n\t// but we allow styles to be defined as an object\r\n\t} else if (attribute === 'style' && typeof value !== \"string\" ) {\r\n\t\tObject.assign(element.style, value);\r\n\t// other propertys are just added as is to the DOM\r\n\t} else {\r\n\t\t// also remove attributes on null to allow better handling of streams\r\n\t\t// streams don't emit on undefined\r\n\t\tif (value === null) {\r\n\t\t\telement[attribute] = undefined;\r\n\t\t} else {\r\n\t\t\t// element.setAttribute(attribute, value);\r\n\t\t\telement[attribute] = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// remove attributes that are not in props anymore\r\nfunction cleanupAttributes(element, props) {\r\n\tif (element.props !== undefined) {\r\n\t\tfor(let attribute in element.props) {\r\n\t\t\tif (props[attribute] === undefined) {\r\n\t\t\t\telement.removeAttribute(attribute);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction diffChildren(element, newChildren, oldChildren, cacheContainer) {\r\n\tif (newChildren.length === 0 && oldChildren.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet oldChildNodes = element.childNodes;\r\n\tlet unifiedNewChildren = unifyChildren(newChildren);\r\n\tlet unifiedOldChildren = unifyChildren(oldChildren);\r\n\r\n\tupdateExistingNodes(element, unifiedNewChildren, unifiedOldChildren, cacheContainer);\r\n\tremoveNotNeededNodes(element, unifiedNewChildren, oldChildren);\r\n\taddNewNodes(element, unifiedNewChildren, cacheContainer);\r\n}\r\n\r\n\r\n/* HELPERS */\r\n\r\n/*\r\n* jsx has children mixed as vdom-elements and numbers or strings\r\n* to consistently treat these children similar in the code we transform those numbers and strings\r\n* into vdom-elements with the tag #text that have one child with their value\r\n*/\r\nfunction unifyChildren(children) {\r\n\treturn children.map(child => {\r\n\t\t// if there is no tag we assume it's a number or a string\r\n\t\tif (!isStream(child) && child.tag === undefined) {\r\n\t\t\treturn {\r\n\t\t\t\ttag: TEXT_NODE,\r\n\t\t\t\tchildren: [child],\r\n\t\t\t\tversion: 0\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn child;\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// create text_nodes from numbers or strings\r\n// create domNodes from regular vdom descriptions\r\nexport function createNode(tag, children) {\r\n\tif (tag === TEXT_NODE) {\r\n\t\treturn document.createTextNode(children[0]);\r\n\t} else {\r\n\t\treturn document.createElement(tag);\r\n\t}\r\n}\r\n\r\n// to not mutate the representation of our children from the last iteration we clone them\r\n// we copy the cycle functions for each element, as JSON parse/stringify does not work for functions\r\nfunction copyChildren(oldChildren) {\r\n\tif (oldChildren === undefined) return [];\r\n\r\n\tlet newChildren = JSON.parse(JSON.stringify(oldChildren));\r\n\tnewChildren.forEach((child, index) => {\r\n\t\tlet oldChild = oldChildren[index];\r\n\t\tif (oldChild.props && oldChild.props.cycle) {\r\n\t\t\tchild.cycle = oldChild.props.cycle;\r\n\t\t}\r\n\t\t\r\n\t\tif (typeof oldChildren[index] === 'object') {\r\n\t\t\tchild.children = copyChildren(oldChild.children);\r\n\t\t}\r\n\t});\r\n\treturn newChildren;\r\n}\r\n\r\n// shorthand to call a cycle event for an element if existing\r\nfunction triggerLifecycle(element, props, event) {\r\n\tif(props && props.cycle && props.cycle[event]) {\r\n\t\tprops.cycle[event](element);\r\n\t}\r\n}\r\n\r\nfunction nodeTypeDiffers(element, tag) {\r\n\treturn element.nodeName.toLowerCase() !== tag;\r\n}\r\n\r\nfunction isTextNode(element) {\r\n\treturn element instanceof window.Text\r\n}\r\n\r\nfunction updateTextNode(element, value) {\r\n\tif (element.nodeValue !== value) {\r\n\t\telement.nodeValue = value;\r\n\t}\r\n}\r\n\r\n// we want to recycle elements to save time on creating and inserting nodes into the dom\r\n// we don't want to manipulate elements that go into the cache, because they would mutate in the cache as well\r\nfunction shouldRecycleElement(oldElement, props, tag) {\r\n\treturn !isTextNode(oldElement)\r\n\t\t&& oldElement.id === \"\"\r\n\t\t&& !nodeTypeDiffers(oldElement, tag);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy-dom.js","import {diff, createNode, render} from '../../src'\r\n\r\nexport function testRender(vdom$, schedule, done) {\r\n    let container = document.createElement('div');\r\n    return test$(render(vdom$, container, 0), schedule, done);\r\n}\r\n\r\nexport function test$(stream, schedule, done) {\r\n    return stream.reduce(function(iteration, value) {\r\n        if (schedule[iteration] === undefined) {\r\n            throw new Error('Unexpected Update!');\r\n        }\r\n\r\n        testSchedule(schedule, iteration, value, done);\r\n        \r\n        if (schedule.length === iteration + 1 && done) {\r\n            done();\r\n        }\r\n\r\n        return iteration + 1;\r\n    }, 0);\r\n}\r\n\r\nfunction testSchedule(schedule, iteration, value, done) {\r\n    // tests produce async behaviour often syncronous\r\n    // this can cause race effects on stream declarations\r\n    // here the iterations are made asynchronous to prevent this\r\n    setTimeout(function() {\r\n        try {\r\n            schedule[iteration](value);\r\n        } catch (error) {\r\n            done.fail(error);\r\n        }\r\n    })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./test/helpers/test-component.js","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/deep-equal/index.js","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/deep-equal/lib/is_arguments.js","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/deep-equal/lib/keys.js","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n// WEBPACK FOOTER //\n// ./~/process/browser.js","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\n\n\n// WEBPACK FOOTER //\n// ./~/setimmediate/setImmediate.js","var apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\nexports.setImmediate = setImmediate;\nexports.clearImmediate = clearImmediate;\n\n\n\n// WEBPACK FOOTER //\n// ./~/timers-browserify/main.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","import {stream, if$, merge$, flatten} from './';\r\n\r\nfunction interceptLinks(routerState$) {\r\n    // intercepts clicks on links\r\n    // if the link is local '/...' we change the location hash instead\r\n\tfunction interceptClickEvent(e) {\r\n        let target = e.target || e.srcElement;\r\n        if (target.tagName === 'A') {\r\n            let href = target.getAttribute('href');\r\n            let isLocal = href != null && href.startsWith('/');\r\n            let isAnchor = href != null && href.startsWith('#');\r\n\r\n            if (isLocal || isAnchor) {\r\n                let {anchor, route, query} = parseLink(href);\r\n                if (route === undefined) {\r\n                    route = routerState$.value.route;\r\n                }\r\n                goTo(routerState$, anchor, route, query);\r\n                //tell the browser not to respond to the link click\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    // react to HTML5 go back and forward events\r\n    window.onpopstate = function(event) {\r\n        if (event.state) {\r\n            let {route, query} = event.state;\r\n            dispatchRouteChange(routerState$, route, query);\r\n        }\r\n    };\r\n\r\n    // listen for link click events at the document level\r\n    document.addEventListener('click', interceptClickEvent);\r\n\r\n    // react to initial routing info\r\n    if (location.pathname !== '/' || location.search !== \"\") {\r\n        // construct initial routing link\r\n        let href = location.pathname + location.search + location.hash;\r\n        let {route, query} = parseLink(location.pathname + location.search + location.hash);\r\n        dispatchRouteChange(routerState$, route, query);\r\n    }\r\n}\r\n\r\n\r\n// TODO refactor\r\nfunction getUrlParams(hash, search) {\r\n    // match query params in urls like:\r\n    // http://localhost:8080/?code=e4a4f94f008a92f12221&code2=abc#/location?code=e4a4f94f008a92f12221&code2=abc\r\n    // the query could be set internaly; then it would be behind the #\r\n    // the query could be set at start; then it would be before the #\r\n    let urlRegex = /(#\\/\\w*)?(\\?(\\w+=\\w*)(&\\w+=\\w*)*)+(#\\w+)?/g;\r\n    let regExResultHash = RegExp(urlRegex).exec(hash);\r\n    let regExResultSearch = RegExp(urlRegex).exec(search);\r\n\r\n    // merge all query params before and after the hash\r\n    let vars = regExResultHash && regExResultHash[3] != null ? regExResultHash[3].split('&') : [];\r\n    vars = regExResultSearch && regExResultSearch[3] != null ? vars.concat(regExResultSearch[3].split('&')) : vars;\r\n\r\n    let params = {};\r\n    for (var i=0;i<vars.length;i++) {\r\n        var pair = vars[i].split(\"=\");\r\n            // If first entry with this name\r\n        if (typeof params[pair[0]] === \"undefined\") {\r\n            params[pair[0]] = decodeURIComponent(pair[1]);\r\n            // If second entry with this name\r\n        } else if (typeof params[pair[0]] === \"string\") {\r\n            var arr = [ params[pair[0]],decodeURIComponent(pair[1]) ];\r\n            params[pair[0]] = arr;\r\n            // If third or later entry with this name\r\n        } else {\r\n            params[pair[0]].push(decodeURIComponent(pair[1]));\r\n        }\r\n    }\r\n    return params;\r\n}\r\n\r\n// this is an element that shows it's content only if the expected route is met\r\nexport function Router({router$, route}, children$) {\r\n    if (router$ == null) {\r\n        console.log('The Router component needs the routerState$ as attribute.')\r\n        return null;\r\n    }\r\n    if (route == null) {\r\n        console.log('The Router component needs the route as attribute.')\r\n        return null;\r\n    }\r\n    // Register the route\r\n    // this is necessary to decide on a default route\r\n    router$.$('routes')\r\n    // routes can be attached async so we check if the route exists and if not add it\r\n    .map((routes) => routes.indexOf(route) === -1 && router$.patch({ routes: routes.concat(route) }));\r\n\r\n    // check if no registered route was hit and set default if so\r\n    let sanitizedRoute$ = router$\r\n        .map(({route, routes}) => {\r\n            if (routes.indexOf(route) === -1) {\r\n                return '/';\r\n            }\r\n            return route;\r\n        });\r\n\r\n    let routeWasHit$ = sanitizedRoute$.is(route).distinct();\r\n    return merge$([routeWasHit$, children$]).map(([wasHit, children]) => {\r\n        return wasHit ? children : []\r\n    });\r\n}\r\n\r\nexport function initRouter() {\r\n    let routerState$ = stream({\r\n        route: '',\r\n        params: {},\r\n        routes: ['/']\r\n    });\r\n\r\n    interceptLinks(routerState$);\r\n\r\n    return routerState$;\r\n}\r\n\r\n// matching links in the form of /route/subroute?param1=a&param2=b#anchor\r\nfunction parseLink(link) {\r\n    let regexp = /((\\/\\w*)*)?(\\?((\\w+=\\w*)(&(\\w+=\\w*)+)*))?(#(\\w+))?/;\r\n    let matchArr = regexp.exec(link);\r\n    return {\r\n        anchor: matchArr[9],\r\n        route: matchArr[1],\r\n        query: matchArr[4]\r\n    }\r\n}\r\n\r\n// callback for HTML5 navigation events\r\n// save the routing info in the routerState\r\nfunction dispatchRouteChange(routerState$, route, query) {\r\n    // remove hash\r\n    let href = location.hash.substr(1);\r\n    routerState$.patch({\r\n        route: route || '',\r\n        params: getUrlParams(href, location.search)\r\n    });\r\n}\r\n\r\nfunction goTo(routerState$, anchor, route, query) {\r\n    history.pushState({anchor, route, query}, '', `/${route ? route.substr(1) : ''}${query ? '?' + query : ''}`);\r\n    if (anchor) {\r\n       location.hash = '#' + anchor;\r\n    }\r\n    dispatchRouteChange(routerState$, route, query);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/router.js","import { stream, merge$ } from './';\r\n\r\n// wrapper around promises to provide an indicator if the promise is running\r\nexport const promise$ = (promise) => {\r\n\tlet output$ = stream({\r\n\t\tloading: true,\r\n\t\terror: null,\r\n\t\tdata: null\r\n\t});\r\n\r\n\tpromise.then(result => {\r\n\t\toutput$.patch({\r\n\t\t\tloading: false,\r\n\t\t\tdata: result\r\n\t\t});\r\n\t}, error => {\r\n\t\toutput$.patch({\r\n\t\t\tloading: false,\r\n\t\t\terror\r\n\t\t});\r\n\t});\r\n\r\n\treturn output$;\r\n}\r\n\r\n// provide easy switched on boolean streams\r\n// example use case: <button onclick={()=>open$(!open$())}>{if$(open$, 'Close', 'Open')}</button>\r\nexport function if$(boolean$, onTrue, onFalse) {\r\n\tif (boolean$ === undefined || typeof boolean$ === 'boolean') {\r\n\t\treturn stream(boolean$ ? (onTrue||null) : (onFalse||null));\r\n\t}\r\n    return boolean$.map(x=>x?(onTrue||null):(onFalse||null));\r\n}\r\n\r\n// join a mixed array of strings and streams of strings\r\n// example use case: <div class={join$('container', if$(open$, 'open', 'closed'))} />\r\nexport function join$(...arr) {\r\n    let $arr = arr.map(item => {\r\n        if (item === null || item === undefined) {\r\n            return stream('');\r\n        }\r\n        if (item.IS_STREAM) {\r\n            return item;\r\n        }\r\n        return stream(item);\r\n    });\r\n    return merge$($arr).map(arr => arr.join(' '));\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy-helpers.js","import {stream, merge$, isStream} from './streamy';\r\nimport {createElement, REMOVED, ADDED} from './streamy-dom';\r\n\r\n/*\r\n* wrap hyperscript elements in reactive streams dependent on their children streams\r\n*/\r\nexport const h = (tag, props, ...children) => {\r\n\tlet component;\r\n\tlet version = -1;\r\n\r\n\tlet mergedChildren$ = mergeChildren$(flatten(children));\r\n\t// jsx usually resolves known tags as strings and unknown tags as functions\r\n\t// if it is a function it is treated as a componen and will resolve it\r\n\t// props are not automatically resolved\r\n\tif (typeof tag === 'function') {\r\n\t\treturn tag(\r\n\t\t\tprops || {},\r\n\t\t\tmergedChildren$\r\n\t\t);\r\n\t}\r\n\treturn merge$([\r\n\t\twrapProps$(props),\r\n\t\tmergedChildren$.map(flatten)\r\n\t]).map(([props, children]) => {\r\n\t\treturn {\r\n\t\t\ttag,\r\n\t\t\tprops,\r\n\t\t\tchildren,\r\n\t\t\tversion: ++version\r\n\t}});\r\n};\r\n\r\n// input has format [stream]\r\nfunction mergeChildren$(children) {\r\n\tif (!Array.isArray(children)) {\r\n\t\tchildren = [children];\r\n\t}\r\n\tchildren = flatten(children)\r\n\t.filter(_ => _ !== null);\r\n\tlet childrenVdom$arr = children.map(child => {\r\n\t\tif (isStream(child)) {\r\n\t\t\treturn child\r\n\t\t\t.flatMap(mergeChildren$);\r\n\t\t}\r\n\t\treturn child;\r\n\t})\r\n\r\n\treturn merge$(childrenVdom$arr);\r\n}\r\n\r\n/*\r\n* wrap all children in streams and merge those\r\n* we make sure that all children streams are flat arrays to make processing uniform\r\n* output: stream([stream([])])\r\n*/\r\nfunction getChildrenVdom$arr(childrenArr) {\r\n\t// flatten children arr\r\n\t// needed to make react style hyperscript (children as arguments) working parallel to preact style hyperscript (children as array)\r\n\tchildrenArr = [].concat(...childrenArr);\r\n\t// only handle vdom for now\r\n\tlet children$Arr = childrenArr.map(component => {\r\n\t\t// if there is no stream it is a string or number\r\n\t\tif (!isStream(component)) {\r\n\t\t\treturn stream(component);\r\n\t\t}\r\n\t\treturn component\r\n\t});\r\n\r\n\treturn children$Arr\r\n\t\t// make sure children are arrays and not nest\r\n\t\t.map(_ => makeArray(_)\r\n\t\t\t.map(flatten))\r\n\t\t// so we can easily merge them\r\n\t\t.map(vdom$ => vdom$.flatMap(vdomArr =>\r\n\t\t\t\tmerge$(vdomArr)));\r\n}\r\n\r\n// make sure all children are handled as streams\r\n// so we can later easily merge them\r\nfunction makeStreams(childrenArr) {\r\n\treturn childrenArr.map(child => {\r\n\t\tif (child === null || !isStream(child)) {\r\n\t\t\treturn stream(child);\r\n\t\t}\r\n\t\treturn child;\r\n\t});\r\n}\r\n\r\n// converts an input into an array\r\nfunction makeArray(stream) {\r\n\treturn stream.map(value => {\r\n\t\tif (value == null) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tif (!Array.isArray(value)) {\r\n\t\t\treturn [value];\r\n\t\t}\r\n\t\treturn value;\r\n\t})\r\n}\r\n\r\n// flattens an array\r\nexport function flatten(array, mutable) {\r\n    var toString = Object.prototype.toString;\r\n    var arrayTypeStr = '[object Array]';\r\n    \r\n    var result = [];\r\n    var nodes = (mutable && array) || array.slice();\r\n    var node;\r\n\r\n    if (!array.length) {\r\n        return result;\r\n    }\r\n\r\n    node = nodes.pop();\r\n    \r\n    do {\r\n        if (toString.call(node) === arrayTypeStr) {\r\n            nodes.push.apply(nodes, node);\r\n        } else {\r\n            result.push(node);\r\n        }\r\n    } while (nodes.length && (node = nodes.pop()) !== undefined);\r\n\r\n    result.reverse(); // we reverse result to restore the original order\r\n    return result;\r\n}\r\n\r\n/*\r\n* Wrap props into one stream\r\n*/\r\nfunction wrapProps$(props) {\r\n\tif (props === null) return stream({});\r\n\tif (isStream(props)) {\r\n\t\treturn props;\r\n\t}\r\n\r\n\tlet nestedStreams = extractNestedStreams(props);\r\n\tlet updateStreams = nestedStreams.map(function makeNestedStreamUpdateProps({parent, key, stream}) {\r\n\t\treturn stream\r\n\t\t.distinct()\r\n\t\t// here we produce a sideeffect on the props object -> low GC\r\n\t\t// to trigger the merge we also need to return sth (as undefined does not trigger listeners)\r\n\t\t.map(value => {\r\n\t\t\tparent[key] = value;\r\n\t\t\treturn value; \r\n\t\t})\r\n\t});\r\n\treturn merge$(updateStreams).map(_ => props);\r\n}\r\n\r\n// to react to nested streams in an object, we extract the streams and a reference to their position\r\n// returns [{parentObject, propertyName, stream}]\r\nfunction extractNestedStreams(obj) {\r\n\treturn flatten(Object.keys(obj).map(key => {\r\n\t\tif (obj[key] === null) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tif (typeof obj[key] === 'object') {\r\n\t\t\treturn extractNestedStreams(obj[key]);\r\n\t\t}\r\n\t\tif (isStream(obj[key])) {\r\n\t\t\treturn [{\r\n\t\t\t\tparent: obj,\r\n\t\t\t\tkey,\r\n\t\t\t\tstream: obj[key]\r\n\t\t\t}];\r\n\t\t}\r\n\t\treturn [];\r\n\t}))\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy-hyperscript.js"],"sourceRoot":""}