{"version":3,"sources":["webpack:///webpack/bootstrap 02975071b9a905bca249","webpack:///./src/utils/streamy.js","webpack:///./src/utils/index.js","webpack:///./src/index.js","webpack:///./src/utils/streamy-dom.js","webpack:///./test/helpers/test-component.js","webpack:///./~/deep-equal/index.js","webpack:///./~/deep-equal/lib/is_arguments.js","webpack:///./~/deep-equal/lib/keys.js","webpack:///./src/utils/streamy-helpers.js","webpack:///./src/utils/streamy-hyperscript.js"],"names":["merge$","isStream","stream","init_value","s","value","undefined","update","IS_STREAM","listeners","map","fn","is","cur","flatMap","filter","deepSelect","distinct","$","selectorArr","query","until","stopEmit$","patch","partialChange","reduce","startValue","debounce","timer","log","prefix","valuesChanged","oldValue","newValue","parent$","notifyListeners","forEach","notifyListener","listener","fork$","mapFunction","initValue","newStream","push","mapValue","console","result$","updateOuterStream","result","attachToResult$","mapFn","parentValue","getChildStreamValue","flatMapValue","removeItem","filterValue","select","parent","selectors","length","selector","splice","split","deepSelectValue","selectorsArr","Array","isArray","a","b","Object","assign","stopEmitValues$","subscribeTo","stopEmitValues","aggregate","reduceValue","curTimer","debounceValue","window","clearTimeout","setTimeout","updateChildStream","potentialStreamsArr","values","indexOf","potentialStream","index","updateMergedStream","arr","item","render","diff","createNode","TEXT_NODE","vdom","parentElement","globals","vdom$","renderUpdate","oldElement","element","oldVersion","version","oldChildren","children","keyContainer","tag","props","appendChild","newElement","triggerLifecycle","copyChildren","newChild","oldChild","cacheContainer","isCaching","id","diffCachedElement","diffElement","oldProps","gotCreated","gotUpdated","document","createElement","elementCache","diffAttributes","diffChildren","replaceChild","newChildren","newVersion","initialRender","isTextNode","updateTextNode","shouldRecycleElement","isolated","removeNotNeededNodes","parentElements","remaining","childNodes","warn","childToRemove","removeChild","cycle","updateExistingNodes","nodes","i","addNewNodes","mounted","error","keys","applyPropertyToElement","attribute","applyAttribute","removeNotNeededAttributes","oldAttribute","removeAttribute","className","cssText","key","join","style","oldChildNodes","unifiedNewChildren","unifyChildren","unifiedOldChildren","child","createTextNode","JSON","parse","stringify","event","nodeTypeDiffers","nodeName","toLowerCase","Text","nodeValue","testRender","test$","schedule","done","options","attach","container","body","expect","outerHTML","toBe","iteration","fail","testIteration","toEqual","pSlice","prototype","slice","objectKeys","require","isArguments","deepEqual","module","exports","actual","expected","opts","Date","getTime","strict","objEquiv","isUndefinedOrNull","isBuffer","x","copy","call","ka","kb","e","sort","supportsArgumentsClass","toString","arguments","supported","unsupported","object","hasOwnProperty","propertyIsEnumerable","shim","obj","if$","join$","promise$","promise","output$","loading","data","then","boolean$","onTrue","onFalse","$arr","flatten","h","elementConstructor","component","constructedChildren","resolveChildren","mergedChildren$","mergeChildren$","wrapProps$","IS_ELEMENT_CONSTRUCTOR","_","childrenVdom$arr","array","mutable","arrayTypeStr","node","pop","apply","reverse","nestedStreams","extractNestedStreams","updateStreams","makeNestedStreamUpdateProps","concat","resolvedChilden","resolveChild"],"mappings":"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","file":"zliq.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 02975071b9a905bca249","import deepEqual from 'deep-equal';\r\n\r\n/*\r\n* stream constructor\r\n* constructor returns a stream\r\n* get the current value of stream like: stream.value\r\n*/\r\nexport const stream = function(init_value) {\r\n\tlet s = function(value) {\r\n\t\tif (value === undefined) {\r\n\t\t\treturn s.value;\r\n\t\t}\r\n\t\tupdate(s, value);\r\n\t\treturn s;\r\n\t}\r\n\r\n\ts.IS_STREAM = true;\r\n\ts.value = init_value;\r\n\ts.listeners = [];\r\n\r\n\ts.map = (fn) => map(s, fn);\r\n\ts.is = (value) => map(s, (cur) => cur === value);\r\n\ts.flatMap = (fn) => flatMap(s, fn);\r\n\ts.filter = (fn) => filter(s, fn);\r\n\ts.deepSelect = (fn) => deepSelect(s, fn);\r\n\ts.distinct = (fn) => distinct(s, fn);\r\n\ts.$ = (selectorArr) => query(s, selectorArr);\r\n\ts.until = (stopEmit$) => until(s, stopEmit$);\r\n\ts.patch = (partialChange) => patch(s, partialChange);\r\n\ts.reduce = (fn, startValue) => reduce(s, fn, startValue);\r\n\ts.debounce = (timer) => debounce(s, timer);\r\n\ts.log = (prefix = 'Stream:') => log(s, prefix);\r\n\r\n\treturn s;\r\n};\r\n\r\n/*\r\n* wrapper for the diffing of stream values\r\n*/\r\nfunction valuesChanged(oldValue, newValue) {\r\n\treturn !deepEqual(oldValue, newValue);\r\n}\r\n\r\n/*\r\n* update the stream value and notify listeners on the stream\r\n*/\r\nfunction update(parent$, newValue) {\r\n\tparent$.value = newValue;\r\n\tnotifyListeners(parent$.listeners, newValue);\r\n}\r\n\r\n/*\r\n* provide a new value to all listeners registered for a stream\r\n*/\r\nfunction notifyListeners(listeners, value) {\r\n\tlisteners.forEach(function notifyListener(listener) {\r\n\t\tlistener(value);\r\n\t});\r\n}\r\n\r\n/*\r\n* Do not pipe the value undefined. This allows to wait for an external initialization.\r\n* It also saves you from checking for an initial null on every map function.\r\n*/\r\nfunction fork$(parent$, mapFunction) {\r\n\tlet initValue = parent$.value !== undefined ? mapFunction(parent$.value) : undefined\r\n\treturn stream(initValue);\r\n}\r\n\r\n/*\r\n* provides a new stream applying a transformation function to the value of a parent stream\r\n*/\r\nfunction map(parent$, fn) {\r\n\tlet newStream = fork$(parent$, fn);\r\n\tparent$.listeners.push(function mapValue(value) {\r\n\t\tnewStream(fn(value));\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/* \r\n* helper function to debug, calls console.log on every value returnin the parent stream \r\n*/ \r\nfunction log (parent$, prefix) {  \r\n  map(parent$, value => console.log(prefix, value)) \r\n  return parent$ \r\n} \r\n\r\n/*\r\n* provides a new stream applying a transformation function to the value of a parent stream\r\n*/\r\nfunction flatMap(parent$, fn) {\r\n\tlet result$;\r\n\tlet listener = function updateOuterStream(result) {\r\n\t\tnewStream(result);\r\n\t};\r\n\tfunction attachToResult$(mapFn, parentValue, listener) {\r\n\t\tlet result$ = mapFn(parentValue);\r\n\t\tresult$.listeners.push(listener);\r\n\t\treturn result$;\r\n\t}\r\n\tlet newStream = fork$(parent$, function getChildStreamValue(value) {\r\n\t\tresult$ = attachToResult$(fn, value, listener);\r\n\t\treturn result$.value;\r\n\t});\r\n\tparent$.listeners.push(function flatMapValue(value) {\r\n\t\t// clean up listeners or they will stack on child streams\r\n\t\tif (result$) {\r\n\t\t\tremoveItem(result$.listeners, listener);\r\n\t\t}\r\n\r\n\t\tresult$ = attachToResult$(fn, value, listener);\r\n\t\tnewStream(result$.value);\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* provides a new stream that only serves the values that a filter function returns true for\r\n* still a stream ALWAYS has a value -> so it starts at least with NULL\r\n*/\r\nfunction filter(parent$, fn) {\r\n\tlet newStream = fork$(parent$, (value) => fn(value) ? value : undefined);\r\n\tparent$.listeners.push(function filterValue(value) {\r\n\t\tif (fn(value)) {\r\n\t\t\tnewStream(value);\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n\r\n/*\r\n* recursivly return the nested property of an object defined by an array of selectors\r\n* parent: {foo: {bar:1}}, selectors: ['foo','bar'] returns 1\r\n*/\r\nfunction select(parent, selectors) {\r\n\tif (parent === null || parent === undefined) {\r\n\t\treturn null\r\n\t}\r\n\tif (selectors.length === 0) {\r\n\t\treturn parent\r\n\t}\r\n\tlet selector = selectors[0]\r\n\treturn select(parent[selector], selectors.splice(1, selectors.length - 1));\r\n}\r\n/*\r\n* provides a new stream that has a selected sub property of the object value of the parent stream\r\n* the selector has the format [{propertyName}.]*\r\n*/\r\nfunction deepSelect(parent$, selector) {\r\n\tlet selectors = selector.split('.');\r\n\r\n\tlet newStream = fork$(parent$, (value) => select(value, selectors));\r\n\tparent$.listeners.push(function deepSelectValue(newValue) {\r\n\t\tnewStream(select(newValue, selectors));\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\nfunction query(parent$, selectorsArr) {\r\n\tif(!Array.isArray(selectorsArr)) {\r\n\t\treturn parent$.map(value => select(value, selectorsArr.split('.')))\r\n\t}\r\n\treturn parent$.map(value => selectorsArr.map(selectors => select(value, selectors.split('.'))))\r\n}\r\n\r\n// TODO: maybe refactor with filter\r\n/*\r\n* provide a new stream that only notifys its children if the containing value actualy changes\r\n*/\r\nfunction distinct(parent$, fn = (a, b) => valuesChanged(a, b)) {\r\n\tlet newStream = fork$(parent$, (value) => value);\r\n\tparent$.listeners.push(function deepSelectValue(value) {\r\n\t\tif (fn(newStream.value, value)) {\r\n\t\t\tnewStream(value);\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* update only the properties of an object passed\r\n* i.e. {name: 'Fabian', lastname: 'Weber} patched with {name: 'Fabo'} produces {name: 'Fabo', lastname: 'Weber}\r\n*/\r\nfunction patch(parent$, partialChange) {\r\n  if (partialChange === null || typeof partialChange !== 'object' || typeof parent$.value !== 'object') { \r\n    parent$(partialChange); \r\n  } else { \r\n    parent$(Object.assign({}, parent$.value, partialChange)); \r\n  } \r\n  return parent$ \r\n}\r\n\r\nfunction until(parent$, stopEmitValues$) {\r\n\tlet newStream = stream();\r\n\tlet subscribeTo = (stream, listener) => {\r\n\t\tlistener(parent$.value);\r\n\t\tstream.listeners.push(listener);\r\n\t}\r\n\tif (stopEmitValues$.value === undefined) {\r\n\t\tsubscribeTo(parent$, newStream)\r\n\t}\r\n\tstopEmitValues$.map(stopEmitValues => {\r\n\t\tif(stopEmitValues) {\r\n\t\t\tremoveItem(parent$.listeners, newStream);\r\n\t\t} else {\r\n\t\t\tsubscribeTo(parent$, newStream);\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* reduce a stream over time\r\n* this will pass the last output value to the calculation function\r\n* reads like the array reduce function\r\n*/\r\nfunction reduce(parent$, fn, startValue) {\r\n\tlet aggregate = startValue;\r\n\tlet newStream = stream();\r\n\tfunction reduceValue(value) {\r\n\t\taggregate = fn(aggregate, parent$.value);\r\n\t\tnewStream(aggregate);\r\n\t}\r\n\tif (parent$.value !== undefined) {\r\n\t\treduceValue(parent$.value);\r\n\t}\r\n\tparent$.listeners.push(reduceValue);\r\n\treturn newStream;\r\n}\r\n\r\nfunction debounce(parent$, timer) {\r\n\tlet curTimer;\r\n\tfunction debounceValue(value) {\r\n\t\tif (curTimer) {\r\n\t\t\twindow.clearTimeout(curTimer);\r\n\t\t}\r\n\t\tcurTimer = setTimeout(function updateChildStream() {\r\n\t\t\tnewStream(value);\r\n\t\t\tcurTimer = null;\r\n\t\t}, timer);\r\n\t}\r\n\tlet newStream = stream();\r\n\tif (parent$.value !== undefined) {\r\n\t\tdebounceValue(parent$.value);\r\n\t}\r\n\tparent$.listeners.push(debounceValue);\r\n\treturn newStream;\r\n}\r\n\r\n/*\r\n* merge several streams into one stream providing the values of all streams as an array\r\n* accepts also non stream elements, those are just copied to the output\r\n* the merge will only have a value if every stream for the merge has a value\r\n*/\r\nexport function merge$(potentialStreamsArr) {\r\n\tlet values = potentialStreamsArr.map(parent$ => parent$ && parent$.IS_STREAM ? parent$.value : parent$);\r\n\tlet newStream = stream(values.indexOf(undefined) === -1 ? values : undefined);\r\n\r\n\tpotentialStreamsArr.forEach((potentialStream, index) => {\r\n\t\tif (potentialStream.IS_STREAM) {\r\n\t\t\tpotentialStream.listeners.push(function updateMergedStream(value) {\r\n\t\t\t\tvalues[index] = value;\r\n\t\t\t\tnewStream(values.indexOf(undefined) === -1 ? values : undefined);\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\treturn newStream;\r\n}\r\n\r\nexport function isStream(parent$) {\r\n\treturn parent$ != null && !!parent$.IS_STREAM;\r\n}\r\n\r\nfunction removeItem(arr, item) {\r\n\tvar index = arr.indexOf(item);\r\n\tif (index !== -1) {\r\n\t\tarr.splice(index, 1);\r\n\t}\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy.js","export * from './streamy';\r\nexport * from './streamy-dom';\r\nexport * from './streamy-hyperscript';\r\nexport * from './streamy-helpers';\n\n\n// WEBPACK FOOTER //\n// ./src/utils/index.js","export * from './utils';\r\nexport * from '../test/helpers/test-component';\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import {isStream} from './streamy';\r\n\r\nconst TEXT_NODE = '#text';\r\n\r\nexport function render(vdom, parentElement, globals = {}, debounce = 10) {\r\n\tlet vdom$ = vdom(globals)\r\n\treturn vdom$.debounce(debounce).reduce(\r\n\t\tfunction renderUpdate({\r\n\t\t\t\telement:oldElement,\r\n\t\t\t\tversion:oldVersion,\r\n\t\t\t\tchildren:oldChildren,\r\n\t\t\t\tkeyContainer\r\n\t\t\t}, {tag, props, children, version}) {\r\n\t\t\t\tif (oldElement === null) {\r\n\t\t\t\t\toldElement = createNode(tag, children);\r\n\t\t\t\t\tif (parentElement) {\r\n\t\t\t\t\t\tparentElement.appendChild(oldElement);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet newElement = diff(\r\n\t\t\t\t\toldElement,\r\n\t\t\t\t\t{tag, props, children, version},\r\n\t\t\t\t\t{children:oldChildren, version:oldVersion},\r\n\t\t\t\t\tkeyContainer\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// signalise mount of root element on initial render\r\n\t\t\t\tif (parentElement && version === 0) {\r\n\t\t\t\t\ttriggerLifecycle(oldElement, props, 'mounted');\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\telement: newElement,\r\n\t\t\t\t\tversion,\r\n\t\t\t\t\tchildren: copyChildren(children),\r\n\t\t\t\t\tkeyContainer\r\n\t\t\t\t}\r\n\t\t}, {\r\n\t\t\telement: null,\r\n\t\t\tversion: -1,\r\n\t\t\tchildren: [],\r\n\t\t\tkeyContainer: {}\r\n\t\t})\r\n}\r\n\r\nexport function diff(oldElement,\r\n\t\tnewChild,\r\n\t\toldChild,\r\n\t\tcacheContainer\r\n) {\r\n\tlet newElement = oldElement;\r\n\tlet isCaching = newChild.props && newChild.props.id;\r\n\t// for keyed elements, we recall unchanged elements\r\n\tif (isCaching) {\r\n\t\tnewElement = diffCachedElement(oldElement, newChild, oldChild, cacheContainer);\r\n\t} else {\r\n\t\tnewElement = diffElement(oldElement, newChild, oldChild, cacheContainer);\r\n\t}\r\n\r\n\treturn newElement;\r\n}\r\n\r\nfunction diffCachedElement(oldElement, {tag, props, children, version}, {props:oldProps}, cacheContainer) {\r\n\tlet id = props.id;\r\n\tlet gotCreated = false;\r\n\tlet gotUpdated = false;\r\n\r\n\t// if there is no cache, create one\r\n\tif (cacheContainer[id] === undefined) {\r\n\t\tcacheContainer[id] = {\r\n\t\t\telement: document.createElement(tag),\r\n\t\t\tvdom: {\r\n\t\t\t\ttag,\r\n\t\t\t\tprops: {},\r\n\t\t\t\tchildren: []\r\n\t\t\t}\r\n\t\t}\r\n\t\tgotCreated = true;\r\n\t}\r\n\r\n\tlet elementCache = cacheContainer[id];\r\n\r\n\t// ignore update if version equals cache\r\n\tif (version !== elementCache.version) {\r\n\t\tdiffAttributes(elementCache.element, props, oldProps);\r\n\t\tdiffChildren(elementCache.element, children, elementCache.vdom.children, cacheContainer);\r\n\t\t\r\n\t\telementCache.version = version;\r\n\t\telementCache.vdom.props = props;\r\n\t\telementCache.vdom.children = children;\r\n\r\n\t\tgotUpdated = true;\r\n\t}\r\n\r\n\tif (gotCreated) {\r\n\t\ttriggerLifecycle(elementCache.element, props, 'created');\r\n\t} else if (gotUpdated) {\r\n\t\ttriggerLifecycle(elementCache.element, props, 'updated');\r\n\t}\r\n\r\n\t// elements are updated in place, so only insert cached element if it's not already there\r\n\tif (oldElement !== elementCache.element) {\r\n\t\toldElement.parentElement.replaceChild(elementCache.element, oldElement);\r\n\t\ttriggerLifecycle(elementCache.element, props, 'mounted');\r\n\t}\r\n\r\n\treturn elementCache.element;\r\n}\r\n\r\nfunction diffElement(element,\r\n\t{tag, props, children:newChildren, version:newVersion},\r\n\t{props:oldProps, children:oldChildren, version:oldVersion},\r\n\tcacheContainer\r\n) {\r\n\tlet initialRender = oldVersion === -1 || oldVersion === undefined\r\n\r\n\t// text nodes behave differently then normal dom elements\r\n\tif (isTextNode(element) && tag === TEXT_NODE ) {\r\n\t\tupdateTextNode(element, newChildren[0]);\r\n\t\treturn element;\r\n\t}\r\n\r\n\t// if the node types do not differ, we reuse the old node\r\n\t// we reuse the existing node to save time rerendering it\r\n\t// we do not reuse/mutate cached (id) elements as this will mutate the cache\r\n\tif (shouldRecycleElement(element, props, tag) === false) {\r\n\t\tlet newElement = createNode(tag, newChildren);\r\n\t\telement.parentElement.replaceChild(newElement, element);\r\n\t\telement = newElement;\r\n\t\t// there are no children anymore on the newly created node\r\n\t\toldChildren = [];\r\n\t}\r\n\r\n\tdiffAttributes(element, props, oldProps);\r\n\r\n\t// sometimes you might want to skip updates to children on renderer elements i.e. if externals handle this component\r\n\tlet isolated = props && props.isolated !== undefined\r\n\r\n\t// text nodes we don't want to handle children like with other elements\r\n\t// and for isolated components we want to skip all updates after the first render\r\n\tif (tag !== TEXT_NODE && (!isolated || initialRender)) {\r\n\t\tdiffChildren(element, newChildren, oldChildren, cacheContainer);\r\n\t}\r\n\t\r\n\tif (initialRender) {\r\n\t\ttriggerLifecycle(element, props, 'created');\r\n\t}\r\n\r\n\tif (newVersion > 0) {\r\n\t\ttriggerLifecycle(element, props, 'updated');\r\n\t}\r\n\r\n\treturn element;\r\n}\r\n\r\n// this removes nodes at the end of the children, that are not needed anymore in the current state for recycling\r\nfunction removeNotNeededNodes(parentElements, newChildren, oldChildren) {\r\n\tlet remaining = parentElements.childNodes.length;\r\n\tif (oldChildren.length !== remaining) {\r\n\t\tconsole.warn(\"ZLIQ: Something other then ZLIQ has manipulated the children of the element\", parentElements, \". This can lead to sideffects. Consider using the 'isolated' attribute for this element to prevent updates.\");\r\n\t}\r\n\r\n\tfor(; remaining > newChildren.length; remaining--) {\r\n\t\tlet childToRemove = parentElements.childNodes[remaining - 1];\r\n\t\tparentElements.removeChild(childToRemove);\r\n\r\n\t\tif (oldChildren.length < remaining) {\r\n\t\t\tcontinue;\r\n\t\t} else {\r\n\t\t\tlet {cycle} = oldChildren[remaining - 1];\r\n\r\n\t\t\ttriggerLifecycle(childToRemove, {cycle}, 'removed');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction updateExistingNodes(parentElement, newChildren, oldChildren, cacheContainer) {\r\n\tlet nodes = parentElement.childNodes;\r\n\tfor(let i = 0; i < nodes.length && i < newChildren.length; i++) {\r\n\t\tdiff(nodes[i], newChildren[i], oldChildren[i], cacheContainer);\r\n\t}\r\n}\r\n\r\nfunction addNewNodes(parentElement, newChildren, cacheContainer) {\r\n\tfor(let i = parentElement.childNodes.length; i < newChildren.length; i++) {\r\n\t\tlet {tag, props, children, version} = newChildren[i];\r\n\t\tlet newElement = createNode(tag, children);\r\n\r\n\t\tparentElement.appendChild(newElement);\r\n\r\n\t\tdiff(newElement, newChildren[i], {}, cacheContainer);\r\n\r\n\t\tif (props && props.cycle && props.cycle.mounted && !props.id) {\r\n\t\t\tconsole.error('The \\'mounted\\' lifecycle event is only called on elements with id. As elements are updated in place, it is hard to define when a normal element is mounted.');\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction diffAttributes(element, props, oldProps = {}) {\r\n\tif (props !== undefined) {\r\n\t\tObject.keys(props).map(function applyPropertyToElement(attribute) {\r\n\t\t\tapplyAttribute(element, attribute, props[attribute])\r\n\t\t});\r\n\t\tObject.keys(oldProps).map(function removeNotNeededAttributes(oldAttribute) {\r\n\t\t\tif (props[oldAttribute] === undefined) {\r\n\t\t\t\telement.removeAttribute(oldAttribute);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction applyAttribute(element, attribute, value) {\r\n\tif (attribute === 'class' || attribute === 'className') {\r\n\t\telement.className = value || '';\r\n\t// we leave the possibility to define styles as strings\r\n\t// but we allow styles to be defined as an object\r\n\t} else if (attribute === 'style' && typeof value !== \"string\" ) {\r\n\t\tconst cssText = value ? Object.keys(value).map(key => key + ':' + value[key] + ';').join(' ') : '';\r\n\t\telement.style.cssText = cssText;\r\n\t// other propertys are just added as is to the DOM\r\n\t} else {\r\n\t\t// also remove attributes on null to allow better handling of streams\r\n\t\t// streams don't emit on undefined\r\n\t\tif (value === null) {\r\n\t\t\telement[attribute] = undefined;\r\n\t\t} else {\r\n\t\t\t// element.setAttribute(attribute, value);\r\n\t\t\telement[attribute] = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction diffChildren(element, newChildren, oldChildren = [], cacheContainer) {\r\n\tif (newChildren.length === 0 && oldChildren.length === 0) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tlet oldChildNodes = element.childNodes;\r\n\tlet unifiedNewChildren = unifyChildren(newChildren);\r\n\tlet unifiedOldChildren = unifyChildren(oldChildren);\r\n\r\n\tupdateExistingNodes(element, unifiedNewChildren, unifiedOldChildren, cacheContainer);\r\n\tremoveNotNeededNodes(element, unifiedNewChildren, oldChildren);\r\n\taddNewNodes(element, unifiedNewChildren, cacheContainer);\r\n}\r\n\r\n\r\n/* HELPERS */\r\n\r\n/*\r\n* jsx has children mixed as vdom-elements and numbers or strings\r\n* to consistently treat these children similar in the code we transform those numbers and strings\r\n* into vdom-elements with the tag #text that have one child with their value\r\n*/\r\nfunction unifyChildren(children) {\r\n\treturn children.map(child => {\r\n\t\t// if there is no tag we assume it's a number or a string\r\n\t\tif (!isStream(child) && child.tag === undefined) {\r\n\t\t\treturn {\r\n\t\t\t\ttag: TEXT_NODE,\r\n\t\t\t\tchildren: [child],\r\n\t\t\t\tversion: 0\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn child;\r\n\t\t}\r\n\t})\r\n}\r\n\r\n// create text_nodes from numbers or strings\r\n// create domNodes from regular vdom descriptions\r\nexport function createNode(tag, children) {\r\n\tif (tag === TEXT_NODE) {\r\n\t\treturn document.createTextNode(children[0]);\r\n\t} else {\r\n\t\treturn document.createElement(tag);\r\n\t}\r\n}\r\n\r\n// to not mutate the representation of our children from the last iteration we clone them\r\n// we copy the cycle functions for each element, as JSON parse/stringify does not work for functions\r\nfunction copyChildren(oldChildren) {\r\n\tlet newChildren = JSON.parse(JSON.stringify(oldChildren));\r\n\tnewChildren.forEach((child, index) => {\r\n\t\tlet oldChild = oldChildren[index];\r\n\t\tif (oldChild.props && oldChild.props.cycle) {\r\n\t\t\tchild.cycle = oldChild.props.cycle;\r\n\t\t}\r\n\t\t\r\n\t\tif (typeof oldChildren[index] === 'object') {\r\n\t\t\tchild.children = copyChildren(oldChild.children);\r\n\t\t}\r\n\t});\r\n\treturn newChildren;\r\n}\r\n\r\n// shorthand to call a cycle event for an element if existing\r\nfunction triggerLifecycle(element, {cycle} = {}, event) {\r\n\tif(cycle && cycle[event]) {\r\n\t\tcycle[event](element);\r\n\t}\r\n}\r\n\r\nfunction nodeTypeDiffers(element, tag) {\r\n\treturn element.nodeName.toLowerCase() !== tag;\r\n}\r\n\r\nfunction isTextNode(element) {\r\n\treturn element instanceof window.Text\r\n}\r\n\r\nfunction updateTextNode(element, value) {\r\n\tif (element.nodeValue !== value) {\r\n\t\telement.nodeValue = value;\r\n\t}\r\n}\r\n\r\n// we want to recycle elements to save time on creating and inserting nodes into the dom\r\n// we don't want to manipulate elements that go into the cache, because they would mutate in the cache as well\r\nfunction shouldRecycleElement(oldElement, props, tag) {\r\n\treturn !isTextNode(oldElement)\r\n\t\t&& oldElement.id === \"\"\r\n\t\t&& !nodeTypeDiffers(oldElement, tag);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy-dom.js","import {diff, createNode, render} from '../../src'\r\n\r\nexport function testRender(\r\n    vdom$,\r\n    schedule,\r\n    done,\r\n    options = {\r\n        attach: false,\r\n        debounce: 0,\r\n        globals: {}\r\n    }\r\n) {\r\n    let container = document.createElement('div');\r\n    if (options.attach) {\r\n        document.body.appendChild(container)\r\n    }\r\n    // enable to just define the expected html in the render schedule\r\n    schedule = schedule.map(fn => {\r\n        if (typeof fn === 'string') {\r\n            return ({element}) => expect(element.outerHTML).toBe(fn)\r\n        }\r\n        return fn\r\n    })\r\n    return test$(render(vdom$, container, options.globals, options.debounce), schedule, done);\r\n}\r\n\r\nexport function test$(stream, schedule, done) {\r\n    return stream.reduce(function(iteration, value) {\r\n        if (schedule[iteration] === undefined) {\r\n            done.fail('Unexpected Update!');\r\n        }\r\n\r\n        testIteration(schedule, iteration, value, done);\r\n\r\n        return iteration + 1;\r\n    }, 0);\r\n}\r\n\r\nfunction testIteration(schedule, iteration, value, done) {\r\n    // tests produce async behaviour often syncronous\r\n    // this can cause race effects on stream declarations\r\n    // here the iterations are made asynchronous to prevent this\r\n    setTimeout(function() {\r\n        try {\r\n            if (typeof schedule[iteration] === 'function') {\r\n                schedule[iteration](value)\r\n            } else {\r\n                expect(value).toEqual(schedule[iteration])\r\n            }\r\n        } catch (error) {\r\n            done.fail(error);\r\n        }\r\n        \r\n        if (schedule.length === iteration + 1 && done) {\r\n            done();\r\n        }\r\n    })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./test/helpers/test-component.js","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/deep-equal/index.js","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./~/deep-equal/lib/is_arguments.js","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./~/deep-equal/lib/keys.js","import { stream, merge$, isStream } from './';\r\n\r\n// wrapper around promises to provide an indicator if the promise is running\r\nexport const promise$ = (promise) => {\r\n\tlet output$ = stream({\r\n\t\tloading: true,\r\n\t\terror: null,\r\n\t\tdata: null\r\n\t});\r\n\r\n\tpromise.then(result => {\r\n\t\toutput$.patch({\r\n\t\t\tloading: false,\r\n\t\t\tdata: result\r\n\t\t});\r\n\t}, error => {\r\n\t\toutput$.patch({\r\n\t\t\tloading: false,\r\n\t\t\terror\r\n\t\t});\r\n\t});\r\n\r\n\treturn output$;\r\n}\r\n\r\n// provide easy switched on boolean streams\r\n// example use case: <button onclick={()=>open$(!open$())}>{if$(open$, 'Close', 'Open')}</button>\r\nexport function if$(boolean$, onTrue = null, onFalse = null) {\r\n\tif (boolean$ === undefined || !isStream(boolean$)) {\r\n\t\treturn stream(boolean$ ? onTrue : onFalse);\r\n\t}\r\n\treturn boolean$.map(x=>x ? onTrue : onFalse);\r\n}\r\n\r\n// join a mixed array of strings and streams of strings\r\n// example use case: <div class={join$('container', if$(open$, 'open', 'closed'))} />\r\nexport function join$(...$arr) {\r\n    return merge$($arr).map(arr => arr.join(' '));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy-helpers.js","import {stream, merge$, isStream} from './streamy';\r\nimport {createElement, REMOVED, ADDED} from './streamy-dom';\r\n\r\n/*\r\n* wrap hyperscript elements in reactive streams dependent on their children streams\r\n* the hyperscript function returns a constructor so we can pass down globals from the renderer to the components\r\n*/\r\nexport const h = (tag, props, ...children) => {\r\n\tlet elementConstructor = (globals) => {\r\n\t\tlet component;\r\n\t\tlet version = -1;\r\n\r\n\t\tlet constructedChildren = resolveChildren(children, globals)\r\n\t\tlet mergedChildren$ = mergeChildren$(constructedChildren);\r\n\t\t// jsx usually resolves known tags as strings and unknown tags as functions\r\n\t\t// if it is a function it is treated as a componen and will resolve it\r\n\t\t// props are not automatically resolved\r\n\t\tif (typeof tag === 'function') {\r\n\t\t\treturn tag(\r\n\t\t\t\tprops || {},\r\n\t\t\t\tmergedChildren$,\r\n\t\t\t\tglobals\r\n\t\t\t)(globals);\r\n\t\t}\r\n\t\treturn merge$([\r\n\t\t\twrapProps$(props),\r\n\t\t\tmergedChildren$.map(flatten)\r\n\t\t]).map(([props, children]) => {\r\n\t\t\treturn {\r\n\t\t\t\ttag,\r\n\t\t\t\tprops,\r\n\t\t\t\tchildren,\r\n\t\t\t\tversion: ++version\r\n\t\t}});\r\n\t}\r\n\telementConstructor.IS_ELEMENT_CONSTRUCTOR = true\r\n\r\n\treturn elementConstructor\r\n};\r\n\r\n/*\r\n* wrap all children in streams and merge those\r\n* we make sure that all children streams are flat arrays to make processing uniform\r\n* input: [stream]\r\n* output: stream([])\r\n*/\r\nfunction mergeChildren$(children) {\r\n\tif (!Array.isArray(children)) {\r\n\t\tchildren = [children];\r\n\t}\r\n\tchildren = flatten(children)\r\n\t.filter(_ => _ !== null);\r\n\tlet childrenVdom$arr = children.map(child => {\r\n\t\tif (isStream(child)) {\r\n\t\t\treturn child\r\n\t\t\t.flatMap(mergeChildren$);\r\n\t\t}\r\n\t\treturn child;\r\n\t})\r\n\r\n\treturn merge$(childrenVdom$arr);\r\n}\r\n\r\n// flattens an array\r\nexport function flatten(array, mutable) {\r\n    var toString = Object.prototype.toString;\r\n    var arrayTypeStr = '[object Array]';\r\n    \r\n    var result = [];\r\n    var nodes = (mutable && array) || array.slice();\r\n    var node;\r\n\r\n    if (!array.length) {\r\n        return result;\r\n    }\r\n\r\n    node = nodes.pop();\r\n    \r\n    do {\r\n        if (toString.call(node) === arrayTypeStr) {\r\n            nodes.push.apply(nodes, node);\r\n        } else {\r\n            result.push(node);\r\n        }\r\n    } while (nodes.length && (node = nodes.pop()) !== undefined);\r\n\r\n    result.reverse(); // we reverse result to restore the original order\r\n    return result;\r\n}\r\n\r\n/*\r\n* Wrap props into one stream\r\n* input: {{}}\r\n* output: stream({})\r\n*/\r\nfunction wrapProps$(props) {\r\n\tif (props === null) return stream({});\r\n\r\n\tlet nestedStreams = extractNestedStreams(props);\r\n\tlet updateStreams = nestedStreams.map(function makeNestedStreamUpdateProps({parent, key, stream}) {\r\n\t\treturn stream\r\n\t\t.distinct()\r\n\t\t// here we produce a sideeffect on the props object -> low GC\r\n\t\t// to trigger the merge we also need to return sth (as undefined does not trigger listeners)\r\n\t\t.map(value => {\r\n\t\t\tparent[key] = value;\r\n\t\t\treturn value; \r\n\t\t})\r\n\t});\r\n\treturn merge$(updateStreams).map(_ => props);\r\n}\r\n\r\n// to react to nested streams in an object, we extract the streams and a reference to their position\r\n// returns [{parentObject, propertyName, stream}]\r\nfunction extractNestedStreams(obj) {\r\n\treturn flatten(Object.keys(obj).map(key => {\r\n\t\t// DEPRECATED I can't think of a usecase\r\n\t\t// if (typeof obj[key] === 'object') {\r\n\t\t// \treturn extractNestedStreams(obj[key]);\r\n\t\t// }\r\n\t\tif (obj[key] === null || obj[key] === undefined) {\r\n\t\t\treturn []\r\n\t\t}\r\n\t\tif (isStream(obj[key])) {\r\n\t\t\treturn [{\r\n\t\t\t\tparent: obj,\r\n\t\t\t\tkey,\r\n\t\t\t\tstream: obj[key]\r\n\t\t\t}];\r\n\t\t}\r\n\t\tif (typeof obj[key] === 'object') {\r\n\t\t\treturn extractNestedStreams(obj[key])\r\n\t\t}\r\n\t\treturn [];\r\n\t}))\r\n}\r\n\r\n/*\r\n* children can be nested arrays, nested streams and element contstructors\r\n* this function unifies them into the format [string|number|vdom|stream<string|number|vdom>]\r\n*/\r\nfunction resolveChildren (children, globals) {\r\n\tif (!Array.isArray(children)) {\r\n\t\tchildren = [].concat(children)\r\n\t}\r\n\tlet resolvedChilden = children.map(child => {\r\n\t\tif (Array.isArray(child)) {\r\n\t\t\treturn resolveChildren(child, globals)\r\n\t\t}\r\n\t\treturn resolveChild(child, globals)\r\n\t})\r\n\treturn flatten(resolvedChilden)\r\n}\r\n\r\n/*\r\n* resolve the element constructor, also for elements nested in streams\r\n* returns the format string|number|vdom|stream<string|number|vdom>\r\n*/\r\nfunction resolveChild(child, globals) {\r\n\tif (typeof child !== 'function') {\r\n\t\treturn child\r\n\t}\r\n\tif (child.IS_ELEMENT_CONSTRUCTOR) {\r\n\t\treturn child(globals)\r\n\t}\r\n\tif (isStream(child)) {\r\n\t\treturn child.map(x => resolveChildren(x, globals))\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/utils/streamy-hyperscript.js"],"sourceRoot":""}