!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.zliq=n():e.zliq=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=2)}([function(e,n,t){"use strict";function r(e,n){return!(0,E.default)(e,n)}function o(e,n){e.value=n,u(e.listeners,n)}function u(e,n){e.forEach(function(e){e(n)})}function i(e,n){var t=void 0===e.value?void 0:n(e.value);return M(t)}function c(e,n){var t=i(e,n);return e.listeners.push(function(e){t(n(e))}),t}function f(e){return c(e,function(e){return console.log("Stream:",e)}),e}function l(e,n){function t(e,n,t){var r=e(n);return r.listeners.push(t),r}var r,o=function(e){u(e)},u=i(e,function(e){return r=t(n,e,o),r.value});return e.listeners.push(function(e){r&&S(r.listeners,o),r=t(n,e,o),u(r.value)}),u}function a(e,n){var t=i(e,function(e){return n(e)?e:void 0});return e.listeners.push(function(e){n(e)&&t(e)}),t}function s(e,n){return null===e||void 0===e?null:0===n.length?e:s(e[n[0]],n.splice(1,n.length-1))}function d(e,n){var t=n.split("."),r=i(e,function(e){return s(e,t)});return e.listeners.push(function(e){r(s(e,t))}),r}function p(e,n){return Array.isArray(n)?e.map(function(e){return n.map(function(n){return s(e,n.split("."))})}):e.map(function(e){return s(e,n.split("."))})}function v(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e,n){return r(e,n)},t=i(e,function(e){return e});return e.listeners.push(function(e){n(t.value,e)&&t(e)}),t}function y(e,n){return new Promise(function(t){e(null===n||"object"!==(void 0===n?"undefined":O(n))||"object"!==O(e.value)?n:Object.assign({},e.value,n)),t(e)})}function m(e,n){var t=M(),r=function(n,t){t(e.value),n.listeners.push(t)};return void 0===n.value&&r(e,t),n.map(function(n){n?S(e.listeners,t):r(e,t)}),t}function h(e,n,t){function r(){o=n(o,e.value),u(o)}var o=t,u=M();return void 0!==e.value&&r(e.value),e.listeners.push(r),u}function b(e,n){function t(e){r&&window.clearTimeout(r),r=setTimeout(function(){o(e),r=null},n)}var r,o=M();return void 0!==e.value&&t(e.value),e.listeners.push(t),o}function g(e){var n=e.map(function(e){return e&&e.IS_STREAM?e.value:e}),t=M(-1===n.indexOf(void 0)?n:void 0);return e.forEach(function(e,r){e.IS_STREAM&&e.listeners.push(function(e){n[r]=e,t(-1===n.indexOf(void 0)?n:void 0)})}),t}function j(e){return null!=e&&!!e.IS_STREAM}function S(e,n){var t=e.indexOf(n);-1!==t&&e.splice(t,1)}var O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.stream=void 0,n.merge$=g,n.isStream=j;var _=t(5),E=function(e){return e&&e.__esModule?e:{default:e}}(_),M=n.stream=function(e){var n=function(e){return void 0===e?n.value:(o(n,e),n)};return n.IS_STREAM=!0,n.value=e,n.listeners=[],n.map=function(e){return c(n,e)},n.is=function(e){return c(n,function(n){return n===e})},n.flatMap=function(e){return l(n,e)},n.filter=function(e){return a(n,e)},n.deepSelect=function(e){return d(n,e)},n.distinct=function(e){return v(n,e)},n.$=function(e){return p(n,e)},n.until=function(e){return m(n,e)},n.patch=function(e){return y(n,e)},n.reduce=function(e,t){return h(n,e,t)},n.debounce=function(e){return b(n,e)},n.log=function(){return f(n)},n}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=t(3);Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var u=t(9);Object.keys(u).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var i=t(8);Object.keys(i).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(1);Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=t(4);Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,n,t){"use strict";function r(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10;return e(t).debounce(r).reduce(function(e,t){var r=e.element,u=e.version,i=e.children,c=e.keyContainer,f=t.tag,l=t.props,a=t.children,s=t.version;null===r&&(r=v(f,a),n&&n.appendChild(r));var d=o(r,{tag:f,props:l,children:a,version:s},{children:i,version:u},c);return n&&0===s&&m(r,l,"mounted"),{element:d,version:s,children:y(a),keyContainer:c}},{element:null,version:-1,children:[],keyContainer:{}})}function o(e,n,t,r){return n.props&&n.props.id?u(e,n,t,r):i(e,n,t,r)}function u(e,n,t,r){var o=n.tag,u=n.props,i=n.children,c=n.version,f=t.props,l=u.id,s=!1,p=!1;void 0===r[l]&&(r[l]={element:document.createElement(o),vdom:{tag:o,props:{},children:[]}},s=!0);var v=r[l];return c!==v.version&&(a(v.element,u,f),d(v.element,i,v.vdom.children,r),v.version=c,v.vdom.props=u,v.vdom.children=i,p=!0),s?m(v.element,u,"created"):p&&m(v.element,u,"updated"),e!==v.element&&(e.parentElement.replaceChild(v.element,e),m(v.element,u,"mounted")),v.element}function i(e,n,t,r){var o=n.tag,u=n.props,i=n.children,c=n.version,f=t.props,l=t.children;t.version;if(b(e)&&o===_)return g(e,i[0]),e;if(!1===j(e,u,o)){var s=v(o,i);e.parentElement.replaceChild(s,e),e=s,l=[]}return a(e,u,f),o!==_&&d(e,i,l,r),0===c&&m(e,u,"created"),0<c&&m(e,u,"updated"),e}function c(e,n,t){var r=e.childNodes.length;for(t.length!==r&&console.warn("ZLIQ: Something other then ZLIQ has manipulated the children of the element",e,". This can lead to sideffects. Please check your code.");r>n.length;r--){var o=e.childNodes[r-1];if(e.removeChild(o),!(t.length<r)){m(o,t[r-1].props,"removed")}}}function f(e,n,t,r){for(var u=e.childNodes,i=0;i<u.length&&i<n.length;i++)o(u[i],n[i],t[i],r)}function l(e,n,t){for(var r=e.childNodes.length;r<n.length;r++){var u=n[r],i=u.tag,c=u.props,f=u.children,l=(u.version,v(i,f));e.appendChild(l),o(l,n[r],{},t),c&&c.cycle&&c.cycle.mounted&&console.error("The 'mounted' lifecycle event is only called on elements with id. As elements are updated in place, it is hard to define when a normal element is mounted.")}}function a(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};void 0!==n&&(Object.keys(n).map(function(t){s(e,t,n[t])}),Object.keys(t).map(function(t){void 0===n[t]&&e.removeAttribute(t)}))}function s(e,n,t){if("class"===n||"className"===n)e.className=t||"";else if("style"===n&&"string"!=typeof t){var r=t?Object.keys(t).map(function(e){return e+":"+t[e]+";"}).join(" "):"";e.style.cssText=r}else e[n]=null===t?void 0:t}function d(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=arguments[3];if(0!==n.length||0!==t.length){var o=(e.childNodes,p(n));f(e,o,p(t),r),c(e,o,t),l(e,o,r)}}function p(e){return e.map(function(e){return(0,O.isStream)(e)||void 0!==e.tag?e:{tag:_,children:[e],version:0}})}function v(e,n){return e===_?document.createTextNode(n[0]):document.createElement(e)}function y(e){var n=JSON.parse(JSON.stringify(e));return n.forEach(function(n,t){var r=e[t];r.props&&r.props.cycle&&(n.cycle=r.props.cycle),"object"===S(e[t])&&(n.children=y(r.children))}),n}function m(e,n,t){n&&n.cycle&&n.cycle[t]&&n.cycle[t](e)}function h(e,n){return e.nodeName.toLowerCase()!==n}function b(e){return e instanceof window.Text}function g(e,n){e.nodeValue!==n&&(e.nodeValue=n)}function j(e,n,t){return!b(e)&&""===e.id&&!h(e,t)}var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(n,"__esModule",{value:!0}),n.render=r,n.diff=o,n.createNode=v;var O=t(0),_="#text"},function(e,n,t){"use strict";function r(e,n,t){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{attach:!1,debounce:0,globals:{}},u=document.createElement("div");return r.attach&&document.body.appendChild(u),n=n.map(function(e){return"string"==typeof e?function(n){var t=n.element;return expect(t.outerHTML).toBe(e)}:e}),o((0,i.render)(e,u,r.globals,r.debounce),n,t)}function o(e,n,t){return e.reduce(function(e,r){return void 0===n[e]&&t.fail("Unexpected Update!"),u(n,e,r,t),e+1},0)}function u(e,n,t,r){setTimeout(function(){try{"function"==typeof e[n]?e[n](t):expect(t).toEqual(e[n])}catch(e){r.fail(e)}e.length===n+1&&r&&r()})}Object.defineProperty(n,"__esModule",{value:!0}),n.testRender=r,n.test$=o;var i=t(2)},function(e,n,t){"use strict";function r(e){return null===e||void 0===e}function o(e){return e&&"object"===(void 0===e?"undefined":i(e))&&"number"==typeof e.length&&"function"==typeof e.copy&&"function"==typeof e.slice&&!(0<e.length&&"number"!=typeof e[0])}function u(e,n,t){var u,s;if(r(e)||r(n))return!1;if(e.prototype!==n.prototype)return!1;if(l(e))return!!l(n)&&(e=c.call(e),n=c.call(n),a(e,n,t));if(o(e)){if(!o(n))return!1;if(e.length!==n.length)return!1;for(u=0;u<e.length;u++)if(e[u]!==n[u])return!1;return!0}try{var d=f(e),p=f(n)}catch(e){return!1}if(d.length!=p.length)return!1;for(d.sort(),p.sort(),u=d.length-1;0<=u;u--)if(d[u]!=p[u])return!1;for(u=d.length-1;0<=u;u--)if(s=d[u],!a(e[s],n[s],t))return!1;return(void 0===e?"undefined":i(e))===(void 0===n?"undefined":i(n))}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=Array.prototype.slice,f=t(7),l=t(6),a=e.exports=function(e,n,t){return t||(t={}),e===n||(e instanceof Date&&n instanceof Date?e.getTime()===n.getTime():e&&n&&("object"==(void 0===e?"undefined":i(e))||"object"==(void 0===n?"undefined":i(n)))?u(e,n,t):t.strict?e===n:e==n)}},function(e,n,t){"use strict";function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==(void 0===e?"undefined":u(e))&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();n=e.exports=i?r:o,n.supported=r,n.unsupported=o},function(e,n,t){"use strict";function r(e){var n=[];for(var t in e)n.push(t);return n}n=e.exports="function"==typeof Object.keys?Object.keys:r,n.shim=r},function(e,n,t){"use strict";function r(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return void 0!==e&&(0,u.isStream)(e)?e.map(function(e){return e?n:t}):(0,u.stream)(e?n:t)}function o(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,u.merge$)(n).map(function(e){return e.join(" ")})}Object.defineProperty(n,"__esModule",{value:!0}),n.promise$=void 0,n.if$=r,n.join$=o;var u=t(1);n.promise$=function(e){var n=(0,u.stream)({loading:!0,error:null,data:null});return e.then(function(e){n.patch({loading:!1,data:e})},function(e){n.patch({loading:!1,error:e})}),n}},function(e,n,t){"use strict";function r(e){Array.isArray(e)||(e=[e]),e=o(e).filter(function(e){return null!==e});var n=e.map(function(e){return(0,a.isStream)(e)?e.flatMap(r):e});return(0,a.merge$)(n)}function o(e,n){var t,r=Object.prototype.toString,o=[],u=n&&e||e.slice();if(!e.length)return o;t=u.pop();do{"[object Array]"===r.call(t)?u.push.apply(u,t):o.push(t)}while(u.length&&void 0!==(t=u.pop()));return o.reverse(),o}function u(e){if(null===e)return(0,a.stream)({});var n=i(e),t=n.map(function(e){var n=e.parent,t=e.key;return e.stream.distinct().map(function(e){return n[t]=e,e})});return(0,a.merge$)(t).map(function(){return e})}function i(e){return o(Object.keys(e).map(function(n){return e[n]&&(0,a.isStream)(e[n])?[{parent:e,key:n,stream:e[n]}]:[]}))}function c(e,n){return Array.isArray(e)||(e=[].concat(e)),o(e.map(function(e){return Array.isArray(e)?c(e,n):f(e,n)}))}function f(e,n){return"function"==typeof e?e.IS_ELEMENT_CONSTRUCTOR?e(n):(0,a.isStream)(e)?e.map(function(e){return c(e,n)}):void 0:e}var l=function(){function e(e,n){var t=[],r=!0,o=!1,u=void 0;try{for(var i,c=e[Symbol.iterator]();!((r=(i=c.next()).done)||(t.push(i.value),n&&t.length===n));r=!0);}catch(e){o=!0,u=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw u}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(n,"__esModule",{value:!0}),n.h=void 0,n.flatten=o;var a=t(0);t(3),n.h=function(e,n){for(var t=arguments.length,i=Array(2<t?t-2:0),f=2;f<t;f++)i[f-2]=arguments[f];var s=function(t){var f=-1,s=c(i,t),d=r(s);return"function"==typeof e?e(n||{},d,t)(t):(0,a.merge$)([u(n),d.map(o)]).map(function(n){var t=l(n,2),r=t[0],o=t[1];return{tag:e,props:r,children:o,version:++f}})};return s.IS_ELEMENT_CONSTRUCTOR=!0,s}}])});