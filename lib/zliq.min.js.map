{"version":3,"sources":["webpack://zliq/webpack/universalModuleDefinition","webpack://zliq/webpack/bootstrap","webpack://zliq/./src/utils/streamy.js","webpack://zliq/(webpack)/buildin/global.js","webpack://zliq/./node_modules/deep-equal/index.js","webpack://zliq/./node_modules/timers-browserify/main.js","webpack://zliq/./node_modules/setimmediate/setImmediate.js","webpack://zliq/./node_modules/process/browser.js","webpack://zliq/./node_modules/deep-equal/lib/keys.js","webpack://zliq/./node_modules/deep-equal/lib/is_arguments.js","webpack://zliq/./src/utils/streamy-helpers.js","webpack://zliq/./src/utils/streamy-vdom.js","webpack://zliq/./src/utils/vdom-diff.js","webpack://zliq/./src/utils/render.js","webpack://zliq/./src/utils/hyperx.js","webpack://zliq/./src/utils/index.js","webpack://zliq/./test/helpers/test-component.js","webpack://zliq/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","stream","init_value","parent$","newValue","listeners","forEach","listener","notifyListeners","update","IS_STREAM","toString","map","fn","is","cur","flatMap","result$","result","newStream","attachToResult$","mapFn","parentValue","push","fork$","removeItem","filter","undefined","deepSelect","selector","selectors","split","select","distinct","arguments","length","a","b","oldValue","deepEqual","valuesChanged","query","selectorArr","$","until","stopEmit$","patch","partialChange","setImmediate","_typeof","assign","reduce","startValue","debounce","timer","schedule","scheduleItems","onDone","iteration","executeScheduleItem","_asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","t0","t1","sent","stop","this","resolve","promise","Promise","_resolve","subscribeTo","then","log","prefix","console","mapFunction","initValue","parent","splice","selectorsArr","Array","isArray","stopEmitValues$","stopEmitValues","aggregate","reduceValue","curTimer","debounceValue","clearTimeout","setTimeout","Error","item","merge$","potentialStreamsArr","values","indexOf","potentialStream","index","isStream","arr","g","Function","eval","e","pSlice","slice","objectKeys","require","isArguments","actual","expected","opts","Date","getTime","strict","isUndefinedOrNull","isBuffer","ka","kb","sort","objEquiv","x","copy","global","scope","self","apply","Timeout","id","clearFn","_id","_clearFn","setInterval","clearInterval","timeout","close","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","clearImmediate","process","registerImmediate","nextHandle","tasksByHandle","currentlyRunningATask","doc","document","attachTo","getPrototypeOf","handle","nextTick","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","messagePrefix","Math","random","onGlobalMessage","event","source","data","addEventListener","attachEvent","installPostMessageImplementation","MessageChannel","channel","port1","port2","installMessageChannelImplementation","createElement","html","documentElement","script","onreadystatechange","removeChild","appendChild","installReadyStateChangeImplementation","callback","args","task","run","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","len","marker","runClearTimeout","Item","array","noop","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","shim","obj","keys","supportsArgumentsClass","supported","unsupported","propertyIsEnumerable","if$","boolean$","onTrue","onFalse","join$","_len","$arr","_key","join","resolve$","updateStreams","extractNestedStreams","flatten","_ref","_","mutable","node","nodes","pop","reverse","Component","constructorFn","_classCallCheck","build","h","tag","props","children","globals","mergedChildren$","mergeChildren$","resolveChildren","output","resolveChild","_ref2","_slicedToArray","_ref3","_ref4","childrenVdom$arr","child","TEXT_NODE","diff","parentElement","oldElement","newChild","oldChild","cacheContainer","createNode","newElement","isCaching","oldProps","gotCreated","gotUpdated","element","vdom","elementCache","diffAttributes","diffChildren","triggerLifecycle","replaceChild","diffCachedElement","newChildren","newVersion","oldChildren","oldVersion","initialRender","isTextNode","nodeValue","updateTextNode","nodeName","toLowerCase","nodeTypeDiffers","shouldRecycleElement","isolated","diffElement","err","style","error","attribute","startsWith","setAttribute","substr","className","cssText","applyAttribute","oldAttribute","removeAttribute","childNodes","unifiedNewChildren","unifyChildren","updateExistingNodes","parentElements","remaining","warn","childToRemove","cycle","removeNotNeededNodes","_newChildren$i","mounted","addNewNodes","createTextNode","Text","render","resolveInputToStream","input","vdom$","resolved","keyContainer","copyChildren","JSON","parse","stringify","render_typeof","VAR","TEXT","OPEN","CLOSE","ATTR","ATTR_KEY","ATTR_KEY_WHITESPACE","ATTR_VALUE_WHITESPACE","ATTR_VALUE","ATTR_VALUE_SINGLEQUOTE","ATTR_VALUE_DOUBLEQUOTE","ATTR_EQ","ATTR_BREAK","COMMENT","quot","state","closeRE","RegExp","selfClosing","test","escape","arg","replace","zx","String","attrToProp","transform","class","for","http-equiv","tagName","attrs","attr","attributeToProperty","strings","component","token","valuesLength","parts","parsedTokens","xstate","tree","stack","tokenType","ix","copyKey","hyperx_typeof","j","strfn","shift","str","res","curChar","charAt","handleTemplateLiteral","hyperx","testRender","done","options","attach","container","body","expect","trimWhitespaces","outerHTML","toBe","test$","testIteration","catch","fail","abrupt","_x","reject","toEqual","__webpack_exports__","streamy","streamy_vdom_h"],"mappings":"CAAA,SAAAA,EAAAC,GACA,iBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,IACA,mBAAAG,eAAAC,IACAD,UAAAH,GACA,iBAAAC,QACAA,QAAA,KAAAD,IAEAD,EAAA,KAAAC,IARA,CASCK,OAAA,WACD,mBCTA,IAAAC,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAP,QAGA,IAAAC,EAAAI,EAAAE,IACAC,EAAAD,EACAE,GAAA,EACAT,YAUA,OANAU,EAAAH,GAAAI,KAAAV,EAAAD,QAAAC,IAAAD,QAAAM,GAGAL,EAAAQ,GAAA,EAGAR,EAAAD,QA0DA,OArDAM,EAAAM,EAAAF,EAGAJ,EAAAO,EAAAR,EAGAC,EAAAQ,EAAA,SAAAd,EAAAe,EAAAC,GACAV,EAAAW,EAAAjB,EAAAe,IACAG,OAAAC,eAAAnB,EAAAe,GAA0CK,YAAA,EAAAC,IAAAL,KAK1CV,EAAAgB,EAAA,SAAAtB,GACA,oBAAAuB,eAAAC,aACAN,OAAAC,eAAAnB,EAAAuB,OAAAC,aAAwDC,MAAA,WAExDP,OAAAC,eAAAnB,EAAA,cAAiDyB,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAQ,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAAhC,GACA,IAAAe,EAAAf,KAAA2B,WACA,WAA2B,OAAA3B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAK,EAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD7B,EAAAgC,EAAA,GAIAhC,IAAAiC,EAAA,igBC3EO,IAAMC,EAAS,SAASC,GAC7B,IAAIF,EAAI,SAAJA,EAAad,GAEf,OAuCJ,SAAgBiB,EAASC,GACvBD,EAAQjB,MAAQkB,EAOlB,SAAyBC,EAAWnB,GAClCmB,EAAUC,QAAQ,SAAwBC,GACxCA,EAASrB,KARXsB,CAAgBL,EAAQE,UAAWD,GA1CjCK,CAAOT,EAAGd,GACHc,GA0BT,OAvBAA,EAAEU,WAAY,EACdV,EAAEd,MAAQgB,EACVF,EAAEK,aAGFL,EAAEW,SAAW,iBAAM,UAAYX,EAAEd,MAAQ,KAEzCc,EAAEY,IAAM,SAAAC,GAAE,OAAID,EAAIZ,EAAGa,IACrBb,EAAEc,GAAK,SAAA5B,GAAK,OAAI0B,EAAIZ,EAAG,SAAAe,GAAG,OAAIA,IAAQ7B,KACtCc,EAAEgB,QAAU,SAAAH,GAAE,OAyEhB,SAAiBV,EAASU,GACxB,IAAII,EACAV,EAAW,SAA2BW,GACxCC,EAAUD,IAEZ,SAASE,EAAgBC,EAAOC,EAAaf,GAC3C,IAAIU,EAAUI,EAAMC,GAEpB,OADAL,EAAQZ,UAAUkB,KAAKhB,GAChBU,EAET,IAAIE,EAAYK,EAAMrB,EAAS,SAA6BjB,GAE1D,OADA+B,EAAUG,EAAgBP,EAAI3B,EAAOqB,IACtBrB,QAWjB,OATAiB,EAAQE,UAAUkB,KAAK,SAAsBrC,GAEvC+B,GACFQ,EAAWR,EAAQZ,UAAWE,GAGhCU,EAAUG,EAAgBP,EAAI3B,EAAOqB,GACrCY,EAAUF,EAAQ/B,SAEbiC,EAhGWH,CAAQhB,EAAGa,IAC7Bb,EAAE0B,OAAS,SAAAb,GAAE,OAsGf,SAAgBV,EAASU,GACvB,IAAIM,EAAYK,EAAMrB,EAAS,SAAAjB,GAAK,OAAK2B,EAAG3B,GAASA,OAAQyC,IAM7D,OALAxB,EAAQE,UAAUkB,KAAK,SAAqBrC,GACtC2B,EAAG3B,IACLiC,EAAUjC,KAGPiC,EA7GUO,CAAO1B,EAAGa,IAC3Bb,EAAE4B,WAAa,SAAAf,GAAE,OAiInB,SAAoBV,EAAS0B,GAC3B,IAAIC,EAAYD,EAASE,MAAM,KAE3BZ,EAAYK,EAAMrB,EAAS,SAAAjB,GAAK,OAAI8C,EAAO9C,EAAO4C,KAItD,OAHA3B,EAAQE,UAAUkB,KAAK,SAAyBnB,GAC9Ce,EAAUa,EAAO5B,EAAU0B,MAEtBX,EAxIcS,CAAW5B,EAAGa,IACnCb,EAAEiC,SAAW,SAAApB,GAAE,OAuJjB,SAAkBV,GAA6C,IAApCU,EAAoCqB,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,GAA/B,SAACE,EAAGC,GAAJ,OAtIhC,SAAuBC,EAAUlC,GAC/B,OAAQmC,IAAUD,EAAUlC,GAqIYoC,CAAcJ,EAAGC,IACrDlB,EAAYK,EAAMrB,EAAS,SAAAjB,GAAK,OAAIA,IAMxC,OALAiB,EAAQE,UAAUkB,KAAK,SAAyBrC,GAC1C2B,EAAGM,EAAUjC,MAAOA,IACtBiC,EAAUjC,KAGPiC,EA9JYc,CAASjC,EAAGa,IAC/Bb,EAAEyC,MAAQ,SAAAC,GAAW,OAAID,EAAMzC,EAAG0C,IAClC1C,EAAE2C,EAAI,SAAAD,GAAW,OAAID,EAAMzC,EAAG0C,GAAaT,YAC3CjC,EAAE4C,MAAQ,SAAAC,GAAS,OAAID,EAAM5C,EAAG6C,IAChC7C,EAAE8C,MAAQ,SAAAC,GAAa,OAiKzB,SAAe5C,EAAS4C,GAYtB,OAXAC,EAAa,WAES,OAAlBD,GACyB,WAAzBE,EAAOF,IACkB,WAAzBE,EAAO9C,EAAQjB,OAEfiB,EAAQ4C,GAER5C,EAAQxB,OAAOuE,UAAW/C,EAAQjB,MAAO6D,MAGtC5C,EA7KoB2C,CAAM9C,EAAG+C,IACpC/C,EAAEmD,OAAS,SAACtC,EAAIuC,GAAL,OAAoBD,EAAOnD,EAAGa,EAAIuC,IAC7CpD,EAAEqD,SAAW,SAAAC,GAAK,OAAID,EAASrD,EAAGsD,IAClCtD,EAAEuD,SAAW,SAACC,EAAeC,GAAhB,OAyPf,SAAkBtD,EAASoD,GAA6B,IAAnBE,EAAmBvB,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,GAAV,aACxCwB,EAAY,EACZvC,EAAYK,EAAMrB,EAAS,SAAAjB,GAAK,OAClCyE,EAAoBJ,EAAUG,IAAaxE,KAEzCqE,EAASpB,SAAWuB,GAAWD,IASnC,OAPAtD,EAAQE,UAAUkB,KAAK,SAAuBrC,GAE5C8D,iMAAYY,CAAAC,mBAAAC,KAAC,SAAAC,IAAA,OAAAF,mBAAAG,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAG,GACXjD,EADW8C,EAAAE,KAAA,EACKR,EAAoBJ,EAAUG,IAAaxE,GADhD,OAAA+E,EAAAI,GAAAJ,EAAAK,MAAA,EAAAL,EAAAG,IAAAH,EAAAI,IAEPX,IAAcH,EAASpB,QAAQsB,IAFxB,wBAAAQ,EAAAM,SAAAR,EAAAS,YAKRrD,EAvQiCoC,CAASvD,EAAGwD,EAAeC,IACnEzD,EAAEmE,KAAO,kBA6QX,SAAchE,GACZ,IAAIsE,EACEC,EAAU,IAAIC,QAAQ,SAAAC,GAC1BH,EAAUG,IAIZ,OAFAC,YAAY1E,EAASsE,GACrBC,EAAQI,KAAK,kBAAMrD,EAAWtB,EAAQE,UAAWoE,KAC1CC,EApRQP,CAAKnE,IACpBA,EAAE+E,IAAM,eAACC,EAAD9C,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,GAAU,UAAV,OAqDV,SAAa/B,EAAS6E,GAEpB,OADApE,EAAIT,EAAS,SAAAjB,GAAK,OAAI+F,QAAQF,IAAIC,EAAQ9F,KACnCiB,EAvDyB4E,CAAI/E,EAAGgF,IAEhChF,GA+BT,SAASwB,EAAMrB,EAAS+E,GACtB,IAAIC,OACgBxD,IAAlBxB,EAAQjB,MAAsBgG,EAAY/E,EAAQjB,YAASyC,EAC7D,OAAO1B,EAAOkF,GAMhB,SAASvE,EAAIT,EAASU,GACpB,IAAIM,EAAYK,EAAMrB,EAASU,GAI/B,OAHAV,EAAQE,UAAUkB,KAAK,SAAkBrC,GACvCiC,EAAUN,EAAG3B,MAERiC,EA0DT,SAASa,EAAOoD,EAAQtD,GACtB,OAAe,OAAXsD,QAA8BzD,IAAXyD,EACd,KAEgB,IAArBtD,EAAUK,OACLiD,EAGFpD,EAAOoD,EADCtD,EAAU,IACOA,EAAUuD,OAAO,EAAGvD,EAAUK,OAAS,IAgBzE,SAASM,EAAMtC,EAASmF,GACtB,OAAKC,MAAMC,QAAQF,GAGZnF,EAAQS,IAAI,SAAA1B,GAAK,OACtBoG,EAAa1E,IAAI,SAAAkB,GAAS,OAAIE,EAAO9C,EAAO4C,EAAUC,MAAM,UAHrD5B,EAAQS,IAAI,SAAA1B,GAAK,OAAI8C,EAAO9C,EAAOoG,EAAavD,MAAM,QAwCjE,SAASa,EAAMzC,EAASsF,GACtB,IAAItE,EAAYlB,IACZ4E,EAAc,SAAC5E,EAAQM,GACzBA,EAASJ,EAAQjB,OACjBe,EAAOI,UAAUkB,KAAKhB,IAYxB,YAV8BoB,IAA1B8D,EAAgBvG,OAClB2F,EAAY1E,EAASgB,GAEvBsE,EAAgB7E,IAAI,SAAA8E,GACdA,EACFjE,EAAWtB,EAAQE,UAAWc,GAE9B0D,EAAY1E,EAASgB,KAGlBA,EAQT,SAASgC,EAAOhD,EAASU,EAAIuC,GAC3B,IAAIuC,EAAYvC,EACZjC,EAAYlB,IAChB,SAAS2F,EAAY1G,GACnByG,EAAY9E,EAAG8E,EAAWxF,EAAQjB,OAClCiC,EAAUwE,GAMZ,YAJsBhE,IAAlBxB,EAAQjB,OACV0G,EAAYzF,EAAQjB,OAEtBiB,EAAQE,UAAUkB,KAAKqE,GAChBzE,EAGT,SAASkC,EAASlD,EAASmD,GACzB,IAAIuC,EACJ,SAASC,EAAc5G,GACjB2G,GACFhI,OAAOkI,aAAaF,GAEtBA,EAAWG,WAAW,WACpB7E,EAAUjC,GACV2G,EAAW,MACVvC,GAEL,IAAInC,EAAYlB,IAKhB,YAJsB0B,IAAlBxB,EAAQjB,OACV4G,EAAc3F,EAAQjB,OAExBiB,EAAQE,UAAUkB,KAAKuE,GAChB3E,EAMT,SAASwC,EAAoBJ,EAAUG,EAAWxE,GAChD,GAAIqE,EAASpB,OAASuB,EAAY,EAChC,MAAMuC,MAAM,gCAAkCvC,EAAY,gBAE5D,IAAIwC,EAAO3C,EAASG,GACpB,MAAoB,mBAATwC,EACFA,EAAKhH,GAELgH,EA4CJ,SAASC,EAAOC,GACrB,IAAIC,EAASD,EAAoBxF,IAC/B,SAAAT,GAAO,OAAKA,GAAWA,EAAQO,UAAYP,EAAQjB,MAAQiB,IAEzDgB,EAAYlB,GAAsC,IAA/BoG,EAAOC,aAAQ3E,GAAoB0E,OAAS1E,GAUnE,OARAyE,EAAoB9F,QAAQ,SAACiG,EAAiBC,GACxCD,EAAgB7F,WAClB6F,EAAgBlG,UAAUkB,KAAK,SAA4BrC,GACzDmH,EAAOG,GAAStH,EAChBiC,GAAyC,IAA/BkF,EAAOC,aAAQ3E,GAAoB0E,OAAS1E,OAIrDR,EAGF,SAASsF,EAAStG,GACvB,OAAkB,MAAXA,KAAqBA,EAAQO,UAGtC,SAASe,EAAWiF,EAAKR,GACvB,IAAIM,EAAQE,EAAIJ,QAAQJ,IACT,IAAXM,GACFE,EAAIrB,OAAOmB,EAAO,kDCrVtB,IAAIG,EAGJA,EAAK,WACJ,OAAOnC,KADH,GAIL,IAECmC,EAAIA,GAAKC,SAAS,cAATA,KAA6B,EAAIC,MAAM,QAC/C,MAAOC,GAEc,iBAAXjJ,SAAqB8I,EAAI9I,QAOrCH,EAAOD,QAAUkJ,mBCnBjB,IAAII,EAASxB,MAAM1F,UAAUmH,MACzBC,EAAaC,EAAQ,GACrBC,EAAcD,EAAQ,GAEtB3E,EAAY7E,EAAOD,QAAU,SAAU2J,EAAQC,EAAUC,GAG3D,OAFKA,IAAMA,MAEPF,IAAWC,IAGJD,aAAkBG,MAAQF,aAAoBE,KAChDH,EAAOI,YAAcH,EAASG,WAI3BJ,IAAWC,GAA6B,iBAAVD,GAAyC,iBAAZC,EAC9DC,EAAKG,OAASL,IAAWC,EAAWD,GAAUC,EA0BzD,SAAkBjF,EAAGC,EAAGiF,GACtB,IAAIrJ,EAAGuB,EACP,GAAIkI,EAAkBtF,IAAMsF,EAAkBrF,GAC5C,OAAO,EAET,GAAID,EAAEvC,YAAcwC,EAAExC,UAAW,OAAO,EAGxC,GAAIsH,EAAY/E,GACd,QAAK+E,EAAY9E,KAGjBD,EAAI2E,EAAO3I,KAAKgE,GAChBC,EAAI0E,EAAO3I,KAAKiE,GACTE,EAAUH,EAAGC,EAAGiF,IAEzB,GAAIK,EAASvF,GAAI,CACf,IAAKuF,EAAStF,GACZ,OAAO,EAET,GAAID,EAAED,SAAWE,EAAEF,OAAQ,OAAO,EAClC,IAAKlE,EAAI,EAAGA,EAAImE,EAAED,OAAQlE,IACxB,GAAImE,EAAEnE,KAAOoE,EAAEpE,GAAI,OAAO,EAE5B,OAAO,EAET,IACE,IAAI2J,EAAKX,EAAW7E,GAChByF,EAAKZ,EAAW5E,GACpB,MAAOyE,GACP,OAAO,EAIT,GAAIc,EAAGzF,QAAU0F,EAAG1F,OAClB,OAAO,EAKT,IAHAyF,EAAGE,OACHD,EAAGC,OAEE7J,EAAI2J,EAAGzF,OAAS,EAAGlE,GAAK,EAAGA,IAC9B,GAAI2J,EAAG3J,IAAM4J,EAAG5J,GACd,OAAO,EAIX,IAAKA,EAAI2J,EAAGzF,OAAS,EAAGlE,GAAK,EAAGA,IAE9B,GADAuB,EAAMoI,EAAG3J,IACJsE,EAAUH,EAAE5C,GAAM6C,EAAE7C,GAAM8H,GAAO,OAAO,EAE/C,cAAclF,UAAaC,EAnElB0F,CAASX,EAAQC,EAAUC,KAItC,SAASI,EAAkBxI,GACzB,OAAiB,OAAVA,QAA4ByC,IAAVzC,EAG3B,SAASyI,EAAUK,GACjB,SAAKA,GAAkB,iBAANA,GAAsC,iBAAbA,EAAE7F,UACtB,mBAAX6F,EAAEC,MAA0C,mBAAZD,EAAEhB,SAGzCgB,EAAE7F,OAAS,GAAqB,iBAAT6F,EAAE,wBCtC/B,SAAAE,GAAA,IAAIC,OAA2B,IAAXD,GAA0BA,GACjB,oBAATE,MAAwBA,MAChCvK,OACRwK,EAAQzB,SAAS/G,UAAUwI,MAiB/B,SAASC,EAAQC,EAAIC,GACnBhE,KAAKiE,IAAMF,EACX/D,KAAKkE,SAAWF,EAflB/K,EAAQuI,WAAa,WACnB,OAAO,IAAIsC,EAAQD,EAAMjK,KAAK4H,WAAYmC,EAAOjG,WAAY6D,eAE/DtI,EAAQkL,YAAc,WACpB,OAAO,IAAIL,EAAQD,EAAMjK,KAAKuK,YAAaR,EAAOjG,WAAY0G,gBAEhEnL,EAAQsI,aACRtI,EAAQmL,cAAgB,SAASC,GAC3BA,GACFA,EAAQC,SAQZR,EAAQzI,UAAUkJ,MAAQT,EAAQzI,UAAUmJ,IAAM,aAClDV,EAAQzI,UAAUiJ,MAAQ,WACxBtE,KAAKkE,SAAStK,KAAK+J,EAAO3D,KAAKiE,MAIjChL,EAAQwL,OAAS,SAAS/C,EAAMgD,GAC9BnD,aAAaG,EAAKiD,gBAClBjD,EAAKkD,aAAeF,GAGtBzL,EAAQ4L,SAAW,SAASnD,GAC1BH,aAAaG,EAAKiD,gBAClBjD,EAAKkD,cAAgB,GAGvB3L,EAAQ6L,aAAe7L,EAAQ8L,OAAS,SAASrD,GAC/CH,aAAaG,EAAKiD,gBAElB,IAAID,EAAQhD,EAAKkD,aACbF,GAAS,IACXhD,EAAKiD,eAAiBnD,WAAW,WAC3BE,EAAKsD,YACPtD,EAAKsD,cACNN,KAKPhC,EAAQ,GAIRzJ,EAAQuF,aAAgC,oBAAToF,MAAwBA,KAAKpF,mBAClB,IAAXkF,GAA0BA,EAAOlF,cACxCwB,MAAQA,KAAKxB,aACrCvF,EAAQgM,eAAkC,oBAATrB,MAAwBA,KAAKqB,qBAClB,IAAXvB,GAA0BA,EAAOuB,gBACxCjF,MAAQA,KAAKiF,mDC9DtC,SAAAvB,EAAAwB,IAAA,SAAUxB,EAAQvG,GACf,aAEA,IAAIuG,EAAOlF,aAAX,CAIA,IAII2G,EAJAC,EAAa,EACbC,KACAC,GAAwB,EACxBC,EAAM7B,EAAO8B,SAoJbC,EAAWtL,OAAOuL,gBAAkBvL,OAAOuL,eAAehC,GAC9D+B,EAAWA,GAAYA,EAASjE,WAAaiE,EAAW/B,EAGf,wBAAlCvH,SAASvC,KAAK8J,EAAOwB,SApFxBC,EAAoB,SAASQ,GACzBT,EAAQU,SAAS,WAAcC,EAAaF,MAIpD,WAGI,GAAIjC,EAAOoC,cAAgBpC,EAAOqC,cAAe,CAC7C,IAAIC,GAA4B,EAC5BC,EAAevC,EAAOwC,UAM1B,OALAxC,EAAOwC,UAAY,WACfF,GAA4B,GAEhCtC,EAAOoC,YAAY,GAAI,KACvBpC,EAAOwC,UAAYD,EACZD,GAwEJG,GApEX,WAKI,IAAIC,EAAgB,gBAAkBC,KAAKC,SAAW,IAClDC,EAAkB,SAASC,GACvBA,EAAMC,SAAW/C,GACK,iBAAf8C,EAAME,MACyB,IAAtCF,EAAME,KAAK5E,QAAQsE,IACnBP,GAAcW,EAAME,KAAKlE,MAAM4D,EAAczI,UAIjD+F,EAAOiD,iBACPjD,EAAOiD,iBAAiB,UAAWJ,GAAiB,GAEpD7C,EAAOkD,YAAY,YAAaL,GAGpCpB,EAAoB,SAASQ,GACzBjC,EAAOoC,YAAYM,EAAgBT,EAAQ,MAiD/CkB,GAEOnD,EAAOoD,eA/ClB,WACI,IAAIC,EAAU,IAAID,eAClBC,EAAQC,MAAMd,UAAY,SAASM,GAE/BX,EADaW,EAAME,OAIvBvB,EAAoB,SAASQ,GACzBoB,EAAQE,MAAMnB,YAAYH,IAyC9BuB,GAEO3B,GAAO,uBAAwBA,EAAI4B,cAAc,UAvC5D,WACI,IAAIC,EAAO7B,EAAI8B,gBACflC,EAAoB,SAASQ,GAGzB,IAAI2B,EAAS/B,EAAI4B,cAAc,UAC/BG,EAAOC,mBAAqB,WACxB1B,EAAaF,GACb2B,EAAOC,mBAAqB,KAC5BH,EAAKI,YAAYF,GACjBA,EAAS,MAEbF,EAAKK,YAAYH,IA6BrBI,GAxBAvC,EAAoB,SAASQ,GACzBnE,WAAWqE,EAAc,EAAGF,IA8BpCF,EAASjH,aA1KT,SAAsBmJ,GAEI,mBAAbA,IACTA,EAAW,IAAIvF,SAAS,GAAKuF,IAI/B,IADA,IAAIC,EAAO,IAAI7G,MAAMrD,UAAUC,OAAS,GAC/BlE,EAAI,EAAGA,EAAImO,EAAKjK,OAAQlE,IAC7BmO,EAAKnO,GAAKiE,UAAUjE,EAAI,GAG5B,IAAIoO,GAASF,SAAUA,EAAUC,KAAMA,GAGvC,OAFAvC,EAAcD,GAAcyC,EAC5B1C,EAAkBC,GACXA,KA6JTK,EAASR,eAAiBA,EA1J1B,SAASA,EAAeU,UACbN,EAAcM,GAyBzB,SAASE,EAAaF,GAGlB,GAAIL,EAGA9D,WAAWqE,EAAc,EAAGF,OACzB,CACH,IAAIkC,EAAOxC,EAAcM,GACzB,GAAIkC,EAAM,CACNvC,GAAwB,EACxB,KAjCZ,SAAauC,GACT,IAAIF,EAAWE,EAAKF,SAChBC,EAAOC,EAAKD,KAChB,OAAQA,EAAKjK,QACb,KAAK,EACDgK,IACA,MACJ,KAAK,EACDA,EAASC,EAAK,IACd,MACJ,KAAK,EACDD,EAASC,EAAK,GAAIA,EAAK,IACvB,MACJ,KAAK,EACDD,EAASC,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAChC,MACJ,QACID,EAAS9D,MAAM1G,EAAWyK,IAiBlBE,CAAID,GADR,QAGI5C,EAAeU,GACfL,GAAwB,MAvE3C,CAyLiB,oBAAT1B,UAAyC,IAAXF,EAAyB1D,KAAO0D,EAASE,4CCxLhF,IAOImE,EACAC,EARA9C,EAAUhM,EAAOD,WAUrB,SAASgP,IACL,MAAM,IAAIxG,MAAM,mCAEpB,SAASyG,IACL,MAAM,IAAIzG,MAAM,qCAsBpB,SAAS0G,EAAWC,GAChB,GAAIL,IAAqBvG,WAErB,OAAOA,WAAW4G,EAAK,GAG3B,IAAKL,IAAqBE,IAAqBF,IAAqBvG,WAEhE,OADAuG,EAAmBvG,WACZA,WAAW4G,EAAK,GAE3B,IAEI,OAAOL,EAAiBK,EAAK,GAC/B,MAAM9F,GACJ,IAEI,OAAOyF,EAAiBnO,KAAK,KAAMwO,EAAK,GAC1C,MAAM9F,GAEJ,OAAOyF,EAAiBnO,KAAKoG,KAAMoI,EAAK,MAvCnD,WACG,IAEQL,EADsB,mBAAfvG,WACYA,WAEAyG,EAEzB,MAAO3F,GACLyF,EAAmBE,EAEvB,IAEQD,EADwB,mBAAjBzG,aACcA,aAEA2G,EAE3B,MAAO5F,GACL0F,EAAqBE,GAjB5B,GAwED,IAEIG,EAFAC,KACAC,GAAW,EAEXC,GAAc,EAElB,SAASC,IACAF,GAAaF,IAGlBE,GAAW,EACPF,EAAa1K,OACb2K,EAAQD,EAAaK,OAAOJ,GAE5BE,GAAc,EAEdF,EAAM3K,QACNgL,KAIR,SAASA,IACL,IAAIJ,EAAJ,CAGA,IAAIlE,EAAU8D,EAAWM,GACzBF,GAAW,EAGX,IADA,IAAIK,EAAMN,EAAM3K,OACViL,GAAK,CAGP,IAFAP,EAAeC,EACfA,OACSE,EAAaI,GACdP,GACAA,EAAaG,GAAYV,MAGjCU,GAAc,EACdI,EAAMN,EAAM3K,OAEhB0K,EAAe,KACfE,GAAW,EAnEf,SAAyBM,GACrB,GAAIb,IAAuBzG,aAEvB,OAAOA,aAAasH,GAGxB,IAAKb,IAAuBE,IAAwBF,IAAuBzG,aAEvE,OADAyG,EAAqBzG,aACdA,aAAasH,GAExB,IAEWb,EAAmBa,GAC5B,MAAOvG,GACL,IAEI,OAAO0F,EAAmBpO,KAAK,KAAMiP,GACvC,MAAOvG,GAGL,OAAO0F,EAAmBpO,KAAKoG,KAAM6I,KAgD7CC,CAAgBzE,IAiBpB,SAAS0E,EAAKX,EAAKY,GACfhJ,KAAKoI,IAAMA,EACXpI,KAAKgJ,MAAQA,EAYjB,SAASC,KA5BT/D,EAAQU,SAAW,SAAUwC,GACzB,IAAIR,EAAO,IAAI7G,MAAMrD,UAAUC,OAAS,GACxC,GAAID,UAAUC,OAAS,EACnB,IAAK,IAAIlE,EAAI,EAAGA,EAAIiE,UAAUC,OAAQlE,IAClCmO,EAAKnO,EAAI,GAAKiE,UAAUjE,GAGhC6O,EAAMvL,KAAK,IAAIgM,EAAKX,EAAKR,IACJ,IAAjBU,EAAM3K,QAAiB4K,GACvBJ,EAAWQ,IASnBI,EAAK1N,UAAUyM,IAAM,WACjB9H,KAAKoI,IAAIvE,MAAM,KAAM7D,KAAKgJ,QAE9B9D,EAAQgE,MAAQ,UAChBhE,EAAQiE,SAAU,EAClBjE,EAAQkE,OACRlE,EAAQmE,QACRnE,EAAQoE,QAAU,GAClBpE,EAAQqE,YAIRrE,EAAQsE,GAAKP,EACb/D,EAAQuE,YAAcR,EACtB/D,EAAQwE,KAAOT,EACf/D,EAAQyE,IAAMV,EACd/D,EAAQ0E,eAAiBX,EACzB/D,EAAQ2E,mBAAqBZ,EAC7B/D,EAAQ4E,KAAOb,EACf/D,EAAQ6E,gBAAkBd,EAC1B/D,EAAQ8E,oBAAsBf,EAE9B/D,EAAQrJ,UAAY,SAAU7B,GAAQ,UAEtCkL,EAAQ+E,QAAU,SAAUjQ,GACxB,MAAM,IAAIyH,MAAM,qCAGpByD,EAAQgF,IAAM,WAAc,MAAO,KACnChF,EAAQiF,MAAQ,SAAUC,GACtB,MAAM,IAAI3I,MAAM,mCAEpByD,EAAQmF,MAAQ,WAAa,OAAO,kBCnLpC,SAASC,EAAMC,GACb,IAAIC,KACJ,IAAK,IAAIxP,KAAOuP,EAAKC,EAAKzN,KAAK/B,GAC/B,OAAOwP,GAPCtR,EAAOD,QAAiC,mBAAhBkB,OAAOqQ,KACrCrQ,OAAOqQ,KAAOF,GAEVA,KAAOA,iBCHf,IAAIG,EAEI,sBAFsB,WAC5B,OAAOtQ,OAAOkB,UAAUc,SAASvC,KAAK8D,WADV,GAO9B,SAASgN,EAAUvP,GACjB,MAAiD,sBAA1ChB,OAAOkB,UAAUc,SAASvC,KAAKuB,GAIxC,SAASwP,EAAYxP,GACnB,OAAOA,GACY,iBAAVA,GACiB,iBAAjBA,EAAOwC,QACdxD,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQ,YAC5ChB,OAAOkB,UAAUuP,qBAAqBhR,KAAKuB,EAAQ,YACpD,GAdJlC,EAAUC,EAAOD,QAAUwR,EAAyBC,EAAYC,GAExDD,UAAYA,EAKpBzR,EAAQ0R,YAAcA,uRCPf,SAASE,EAAIC,GAAyC,IAA/BC,EAA+BrN,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,GAAtB,KAAMsN,EAAgBtN,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,GAAN,KACrD,YAAiBP,IAAb2N,GAA2B7I,YAAS6I,GAGjCA,EAAS1O,IAAI,SAAAoH,GAAC,OAAKA,EAAIuH,EAASC,IAF9BvP,YAAOqP,EAAWC,EAASC,GAO/B,SAASC,IAAe,QAAAC,EAAAxN,UAAAC,OAANwN,EAAM,IAAApK,MAAAmK,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAND,EAAMC,GAAA1N,UAAA0N,GAC7B,OAAOzJ,YAAOwJ,GAAM/O,IAAI,SAAA8F,GAAG,OAAIA,EAAImJ,KAAK,OAQnC,SAASC,EAASf,GACvB,GAAY,OAARA,EAAc,OAAO9O,gBAEzB,IACI8P,EAqBN,SAASC,EAAqBjB,GAC5B,OAAOkB,EACLtR,OAAOqQ,KAAKD,GAAKnO,IAAI,SAAApB,GAKnB,OAAiB,OAAbuP,EAAIvP,SAA8BmC,IAAboN,EAAIvP,MAGzBiH,YAASsI,EAAIvP,MAGX4F,OAAQ2J,EACRvP,MACAS,OAAQ8O,EAAIvP,KAIM,WAApByD,EAAO8L,EAAIvP,IACNwQ,EAAqBjB,EAAIvP,UA1ClBwQ,CAAqBjB,GACPnO,IAAI,SAAAsP,GAInC,IAHD9K,EAGC8K,EAHD9K,OACA5F,EAEC0Q,EAFD1Q,IAGA,OADC0Q,EADDjQ,OAIKgC,WAGArB,IAAI,SAAA1B,GAEH,OADAkG,EAAO5F,GAAON,EACPA,MAIf,OAAOiH,YAAO4J,GAAenP,IAAI,SAAAuP,GAAC,OAAIpB,IAiCjC,SAASkB,EAAQzC,EAAO4C,GAC7B,IAKIC,EALA1P,EAAWhC,OAAOkB,UAAUc,SAG5BO,KACAoP,EAASF,GAAW5C,GAAUA,EAAMxG,QAGxC,IAAKwG,EAAMrL,OACT,OAAOjB,EAGTmP,EAAOC,EAAMC,MAEb,GAZmB,mBAab5P,EAASvC,KAAKiS,GAChBC,EAAM/O,KAAK8G,MAAMiI,EAAOD,GAExBnP,EAAOK,KAAK8O,SAEPC,EAAMnO,aAAmCR,KAAxB0O,EAAOC,EAAMC,QAGvC,OADArP,EAAOsP,UACAtP,oZC/FF,IAAMuP,EACX,SAAAA,EAAYC,gGAAeC,CAAAnM,KAAAiM,GACzBjM,KAAKoM,MAAQF,GAQJG,EAAI,SAACC,EAAKC,GAAuB,QAAArB,EAAAxN,UAAAC,OAAb6O,EAAa,IAAAzL,MAAAmK,EAAA,EAAAA,EAAA,KAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAboB,EAAapB,EAAA,GAAA1N,UAAA0N,GAG5C,OAFAmB,EAAQA,MAED,IAAIN,EAAU,SAAAQ,GACnB,IAAInD,GAAW,EAGXoD,EAAkBC,EADIC,EAAgBJ,EAAUC,IAKpD,GAAmB,mBAARH,EAAoB,CAE7B,IAAIO,EAASP,EAAIC,EAAOG,EAAiBD,GAEzC,OAAI1L,MAAMC,QAAQ6L,GACTD,EAAgBC,EAAQJ,GAE7BI,aAAkBZ,GAAahK,YAAS4K,GACnCC,EAAaD,EAAQJ,GAIvB9K,aAAQ2J,EAASiB,GAAQG,EAAgBtQ,IAAIqP,KACjDrP,IAAI,SAAAsP,GAAA,IAAAqB,EAAAC,EAAAtB,EAAA,GAAEa,EAAFQ,EAAA,GAASP,EAATO,EAAA,UAAuBF,EAAON,EAAOC,EAAUC,KACnDrQ,IAAI,SAAAoQ,GAAQ,OAAII,EAAgBJ,EAAUC,KAG/C,OAAO9K,aAAQ2J,EAASiB,GAAQG,EAAgBtQ,IAAIqP,KAAWrP,IAC7D,SAAA6Q,GAAuB,IAAAC,EAAAF,EAAAC,EAAA,GAArBV,EAAqBW,EAAA,GAAdV,EAAcU,EAAA,GACrB,OACEZ,MACAC,QACAC,WACAlD,UAAWA,QAarB,SAASqD,EAAeH,GACjBzL,MAAMC,QAAQwL,KACjBA,GAAYA,IAGd,IAAIW,GADJX,EAAWf,EAAQe,GAAUtP,OAAO,SAAAyO,GAAC,OAAU,OAANA,KACTvP,IAAI,SAAAgR,GAClC,OAAInL,YAASmL,GACJA,EAAM5Q,QAAQmQ,GAEhBS,IAGT,OAAOzL,YAAOwL,GAOT,SAASP,EAAgBJ,EAAUC,GAUxC,OATK1L,MAAMC,QAAQwL,KACjBA,KAAc9D,OAAO8D,IAQhBf,EANee,EAASpQ,IAAI,SAAAgR,GACjC,OAAIrM,MAAMC,QAAQoM,GACTR,EAAgBQ,EAAOX,GAEzBK,EAAaM,EAAOX,MASxB,SAASK,EAAaM,EAAOX,GAClC,OAAIW,aAAiBnB,EACZW,EAAgBQ,EAAMhB,MAAMK,GAAUA,GAE3CxK,YAASmL,GACJA,EAAMhR,IAAI,SAAAoH,GAAC,OAAIoJ,EAAgBpJ,EAAGiJ,KAEpCW,ECrGF,IAAMC,EAAY,QAElB,SAASC,EACdC,EACAC,EACAC,EACAC,EACAC,GAImB,OAAfH,IACFA,EAAaI,EAAWH,EAASnB,IAAKmB,EAASjB,UAC3Ce,GACFA,EAAc9F,YAAY+F,IAI9B,IAAIK,EAAaL,EACbM,EAAYL,EAASlB,OAASkB,EAASlB,MAAMxI,GAEjD,IAGI8J,EADEC,EAyBR,SACEN,EADF9B,EAAAqB,EAIEY,GACA,IAHErB,EAGFZ,EAHEY,IAAKC,EAGPb,EAHOa,MAAOC,EAGdd,EAHcc,SAAUlD,EAGxBoC,EAHwBpC,QACfyE,EAEThB,EAFER,MAGExI,EAAKwI,EAAMxI,GACXiK,GAAa,EACbC,GAAa,OAGU9Q,IAAvBwQ,EAAe5J,KACjB4J,EAAe5J,IACbmK,QAAS1I,SAAS2B,cAAcmF,GAChC6B,MACE7B,MACAC,SACAC,cAGJwB,GAAa,GAGf,IAAII,EAAeT,EAAe5J,GAG9BuF,IAAY8E,EAAa9E,UAC3B+E,EAAeD,EAAaF,QAAS3B,EAAOwB,GAC5CO,EACEF,EAAaF,QACb1B,EACA4B,EAAaD,KAAK3B,SAClBmB,GAGFS,EAAa9E,QAAUA,EACvB8E,EAAaD,KAAK5B,MAAQA,EAC1B6B,EAAaD,KAAK3B,SAAWA,EAE7ByB,GAAa,GAGXD,EACFO,EAAiBH,EAAaF,QAAS3B,EAAO,WACrC0B,GACTM,EAAiBH,EAAaF,QAAS3B,EAAO,WAI5CiB,IAAeY,EAAaF,UAC9BV,EAAWD,cAAciB,aAAaJ,EAAaF,QAASV,GAC5De,EAAiBH,EAAaF,QAAS3B,EAAO,YAGhD,OAAO6B,EAAaF,QA9EHO,CACXjB,EACAC,EACAC,EACAC,GA6ER,SACEO,EADFjB,EAAAC,EAIES,GACA,IAHErB,EAGFW,EAHEX,IAAKC,EAGPU,EAHOV,MAAiBmC,EAGxBzB,EAHcT,SAAgCmC,EAG9C1B,EAHqC3D,QAC5ByE,EAETb,EAFEX,MAA2BqC,EAE7B1B,EAFmBV,SAAgCqC,EAEnD3B,EAF0C5D,QAGtCwF,GAAgC,IAAhBD,QAAoC1R,IAAf0R,EAGzC,GAAIE,EAAWb,IAAY5B,IAAQe,EAEjC,OA0NJ,SAAwBa,EAASxT,GAC3BwT,EAAQc,YAActU,IACxBwT,EAAQc,UAAYtU,GA7NpBuU,CAAef,EAASQ,EAAY,IAC7BR,EAMT,IAAkD,IA4NpD,SAA8BV,EAAYjB,EAAOD,GAC/C,OACGyC,EAAWvB,IACM,KAAlBA,EAAWzJ,KAnBf,SAAyBmK,EAAS5B,GAChC,OAAO4B,EAAQgB,SAASC,gBAAkB7C,EAmBvC8C,CAAgB5B,EAAYlB,GAhO3B+C,CAAqBnB,EAAS3B,EAAOD,GAAgB,CACvD,IAAIuB,EAAaD,EAAWtB,EAAKoC,GACjCR,EAAQX,cAAciB,aAAaX,EAAYK,GAC/CA,EAAUL,EAEVe,KAGFP,EAAeH,EAAS3B,EAAOwB,GAG/B,IAAIuB,EAAW/C,QAA4BpP,IAAnBoP,EAAM+C,SAI1BhD,IAAQe,GAAeiC,IAAYR,GACrCR,EAAaJ,EAASQ,EAAaE,EAAajB,GAG9CmB,GACFP,EAAiBL,EAAS3B,EAAO,WAG/BoC,EAAa,GACfJ,EAAiBL,EAAS3B,EAAO,WAGnC,OAAO2B,EAtHUqB,CAAY/B,EAAYC,EAAUC,EAAUC,GAE3D,MAAO6B,GAEP3B,GACEvB,IAAK,MACLC,OACEkD,MAAO,sCAETjD,UAAW,mBAEb/L,QAAQiP,MAAM,0CAA2CF,GAG3D,OAAO3B,EAuKT,SAASQ,EAAeH,EAAS3B,GAAsB,IAAfwB,EAAerQ,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,WACvCP,IAAVoP,IACFpS,OAAOqQ,KAAK+B,GAAOnQ,IAAI,SAAgCuT,IAW3D,SAAwBzB,EAASyB,EAAWjV,GAE1C,GAAIiV,EAAUC,WAAW,KAEvB,YADA1B,EAAQ2B,aAAaF,EAAUG,OAAO,GAAIpV,GAI5C,GAAkB,UAAdiV,EACFzB,EAAQ6B,UAAYrV,GAAS,QAGxB,GAAkB,UAAdiV,GAA0C,iBAAVjV,EAAoB,CAC7D,IAAMsV,EAAUtV,EACZP,OAAOqQ,KAAK9P,GACT0B,IAAI,SAAApB,GAAG,OAAIA,EAAM,IAAMN,EAAMM,GAAO,MACpCqQ,KAAK,KACR,GACJ6C,EAAQuB,MAAMO,QAAUA,YAGG7S,IAAvB+Q,EAAQyB,KAERzB,EAAQyB,GADI,OAAVjV,OACmByC,EAEAzC,GAMvBwT,EAAQyB,GADI,OAAVjV,OACmByC,EAEAzC,EA1CrBuV,CAAe/B,EAASyB,EAAWpD,EAAMoD,MAE3CxV,OAAOqQ,KAAKuD,GAAU3R,IAAI,SAAmC8T,QAC/B/S,IAAxBoP,EAAM2D,IACRhC,EAAQiC,gBAAgBD,MA2ChC,SAAS5B,EACPJ,GAIA,IAHAQ,EAGAhR,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,MAFAkR,EAEAlR,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,MADAiQ,EACAjQ,UAAAC,OAAA,EAAAD,UAAA,QAAAP,EACA,GAA2B,IAAvBuR,EAAY/Q,QAAuC,IAAvBiR,EAAYjR,OAA5C,CAIoBuQ,EAAQkC,WAA5B,IACIC,EAAqBC,EAAc5B,IAhGzC,SACEnB,EACAmB,EACAE,EACAjB,GAGA,IADA,IAAI7B,EAAQyB,EAAc6C,WACjB3W,EAAI,EAAGA,EAAIqS,EAAMnO,QAAUlE,EAAIiV,EAAY/Q,OAAQlE,IAC1D6T,EACEC,EACAzB,EAAMrS,GACNiV,EAAYjV,GACZmV,EAAYnV,OACZkU,GAsFJ4C,CACErC,EACAmC,EAJuBC,EAAc1B,GAMrCjB,GA/HJ,SAA8B6C,EAAgB9B,EAAaE,GACzD,IAAI6B,EAAYD,EAAeJ,WAAWzS,OAS1C,IARIiR,EAAYjR,SAAW8S,GACzBhQ,QAAQiQ,KACN,8EACAF,EACA,+GAIGC,EAAY/B,EAAY/Q,OAAQ8S,IAAa,CAClD,IAAIE,EAAgBH,EAAeJ,WAAWK,EAAY,GAC1DD,EAAehJ,YAAYmJ,GAEvB/B,EAAYjR,OAAS8S,GAKvBlC,EAAiBoC,GAAiBC,MAFlBhC,EAAY6B,EAAY,GAAlCG,OAEqC,YA8G/CC,CAAqB3C,EAASmC,EAAoBzB,GAvFpD,SAAqBrB,EAAemB,EAAaf,GAC/C,IAAK,IAAIlU,EAAI8T,EAAc6C,WAAWzS,OAAQlE,EAAIiV,EAAY/Q,OAAQlE,IAAK,KAAAqX,EACjCpC,EAAYjV,GAA9C6S,EADmEwE,EACnExE,IAAKC,EAD8DuE,EAC9DvE,MAAOC,EADuDsE,EACvDtE,SACdqB,GAFqEiD,EAC7CxH,QACXsE,EAAWtB,EAAKE,IAEjCe,EAAc9F,YAAYoG,GAE1BP,EAAKC,EAAeM,EAAYa,EAAYjV,MAAQkU,GAEhDpB,GAASA,EAAMqE,OAASrE,EAAMqE,MAAMG,UAAYxE,EAAMxI,IACxDtD,QAAQiP,MACN,+JA6ENsB,CAAY9C,EAASmC,EAAoB1C,IAU3C,SAAS2C,EAAc9D,GACrB,OAAOA,EAASpQ,IAAI,SAAAgR,GAElB,OAAKnL,YAASmL,SAAwBjQ,IAAdiQ,EAAMd,IAOrBc,GALLd,IAAKe,EACLb,UAAWY,GACX9D,QAAS,KAUV,SAASsE,EAAWtB,EAAKE,GAC9B,OAAIF,IAAQe,EACH7H,SAASyL,eAAezE,EAAS,IAEjChH,SAAS2B,cAAcmF,GAM3B,SAASiC,EAAiBL,GAAgC,IAArB0C,GAAqBlT,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,OAArBkT,MAAcpK,EAAO9I,UAAAC,OAAA,EAAAD,UAAA,QAAAP,EAC3DyT,GAASA,EAAMpK,IACjBoK,EAAMpK,GAAO0H,GAQjB,SAASa,EAAWb,GAClB,OAAOA,aAAmB7U,OAAO6X,0OCzU5B,SAASC,EAAOhD,EAAMZ,GAA4C,IAA7Bd,EAA6B/O,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,MAAfmB,EAAenB,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,GAAJ,GASnE,OA+CF,SAAS0T,EAAqBC,EAAO5E,GACnC,IAAI6E,EACJ,GAAIrP,YAASoP,GA2BX,OAzBAC,EAAQD,EACL7U,QAAQ,SAAA6U,GACP,IAAIE,EAAWzE,EAAauE,EAAO5E,GASnC,OALI1L,MAAMC,QAAQuQ,KAChBA,EAAWA,EAAS,IAIjBtP,YAASsP,GAIPA,EAHE9V,YAAO8V,KAOjBnV,IAAI,SAAAoH,GAIH,OAHIzC,MAAMC,QAAQwC,KAChBA,EAAIA,EAAE,IAEDA,IAKb,GAAI6N,aAAiBpF,EAGnB,OAFAqF,EAAQD,EAAMjF,MAAMK,GACpB6E,EAAQF,EAAqBE,EAAO7E,GAEV,mBAAV4E,IAEhBC,EAAQD,QAAc5E,IAInBxK,YAASqP,KAAQA,EAAQF,EAAqBE,EAAO7E,IAE1D,OAAO6E,EAnGOF,CAAqBjD,EAAM1B,GAStC5N,SAASA,GACTF,OAGL,SACE4O,EADF7B,EAAAqB,GAWE,IAPWS,EAOX9B,EAPEwC,QACSW,EAMXnD,EANEpC,QACUsF,EAKZlD,EALEc,SACAgF,EAIF9F,EAJE8F,aAGAlF,EACFS,EADET,IAAKC,EACPQ,EADOR,MAAOC,EACdO,EADcP,SAAUlD,EACxByD,EADwBzD,QAExB,IACE,IAAIuE,EAAaP,EACfC,EACAC,GACElB,MAAKC,QAAOC,WAAUlD,YACtBkD,SAAUoC,EAAatF,QAASuF,GAClC2C,GAQF,OAJIjE,GAA6B,IAAZjE,GACnBiF,EAAiBf,EAAYjB,EAAO,YAIpC2B,QAASL,EACTvE,UACAkD,SA8DN,SAASiF,IAA+B,IAAlB7C,EAAkBlR,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,MACtC,IAAIgR,EAAcgD,KAAKC,MAAMD,KAAKE,UAAUhD,IAC5CF,EAAY5S,QAAQ,SAACsR,EAAOpL,GAC1B,IAAI0L,EAAWkB,EAAY5M,GACvB0L,EAASnB,OAASmB,EAASnB,MAAMqE,QACnCxD,EAAMwD,MAAQlD,EAASnB,MAAMqE,OAGG,WAA9BiB,EAAOjD,EAAY5M,MACrBoL,EAAMZ,SAAWiF,EAAa/D,EAASlB,aAG3C,OAAOkC,EA1EO+C,CAAajF,GACvBgF,gBAEF,MAAOhC,GACP/O,QAAQiP,MAAM,2BAA4BF,KApCrBvU,KAAK,KAAMsS,IARhCW,QAAS,KACT5E,SAAU,EACVkD,YACAgF,uPCNJ,IAAIM,EAAM,EACRC,EAAO,EACPC,EAAO,EACPC,EAAQ,EACRC,EAAO,EACLC,EAAW,EACbC,EAAsB,EACpBC,EAAwB,EAC1BC,EAAa,EACXC,EAAyB,EAC3BC,EAAyB,GACvBC,EAAU,GACZC,EAAa,GACXC,EAAU,GA6Td,SAASC,EAAKC,GACZ,OAAOA,IAAUN,GAA0BM,IAAUL,EAGvD,IAAIM,EAAUC,OACZ,MAEI,OACA,OACA,WACA,UACA,KACA,MACA,UACA,QACA,QACA,KACA,MACA,QACA,UACA,SACA,OACA,OACA,QACA,SACA,QACA,MACA,MAEA,UACA,mBACA,SACA,SACA,OACA,UACA,UACA,gBACA,cACA,mBACA,oBACA,oBACA,iBACA,UACA,UACA,UACA,UACA,UACA,iBACA,UACA,cACA,eACA,WACA,eACA,qBACA,cACA,SACA,eACA,mBACA,iBACA,gBACA,QACA,WACA,QACA,QACA,OACA,gBACA,QACA,OACA,UACA,WACA,OACA,MACA,OACA,OACA,MACA,OACA,SACA1H,KAAK,KACP,iCAEJ,SAAS2H,EAAY1G,GACnB,OAAOwG,EAAQG,KAAK3G,GAuBf,IAAM4G,EAAS,SAAAC,GACpB,MAAmB,iBAARA,EAAyBA,EAC7BA,EACJC,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,SCpbNC,EDYE,SAAgBhH,EAAGvJ,GAC3BA,IAAMA,MACX,IAAI4F,EACF5F,EAAK4F,QACL,SAAS9K,EAAGC,GACV,OAAOyV,OAAO1V,GAAK0V,OAAOzV,IAM9B,OAJwB,IAApBiF,EAAKyQ,aACPlH,EAwYJ,SAA6BA,GAC3B,IAAImH,GACFC,MAAO,YACPC,IAAK,UACLC,aAAc,aAGhB,OAAO,SAASC,GAAoC,IAA3BC,EAA2BnW,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,MAAf8O,EAAe9O,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,MAClD,IAAK,IAAIoW,KAAQD,EACXC,KAAQN,IACVK,EAAML,EAAUM,IAASD,EAAMC,UACxBD,EAAMC,IAGjB,OAAOzH,EAAEuH,EAASC,EAAOrH,IAtZrBuH,CAAoB1H,IAGnB,SAAC2H,GAAuB,QAAA9I,EAAAxN,UAAAC,OAAXkE,EAAW,IAAAd,MAAAmK,EAAA,EAAAA,EAAA,KAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAXvJ,EAAWuJ,EAAA,GAAA1N,UAAA0N,GAC7B,OAAO,IAAIa,EAAU,SAAAQ,GACnB,IAAIwH,EAiBR,SAA+BxH,EAASuH,EAASnS,GAM/C,IALA,IAAIgR,EAAQd,EACVmC,EAAQ,GACNC,EAAetS,EAAOlE,OACtByW,KAEK3a,EAAI,EAAGA,EAAIua,EAAQrW,OAAQlE,IAClC,GAAIA,EAAI0a,EAAc,CACpB,IAAIzZ,EAAQwY,EAAOrR,EAAOpI,IACtB4a,EAAe1C,EAAMqC,EAAQva,IAC7B6a,EAASzB,EACTyB,IAAW9B,IAAwB8B,EAAShC,GAC5CgC,IAAW/B,IAAwB+B,EAAShC,GAC5CgC,IAAWjC,IAAuBiC,EAAShC,GAC3CgC,IAAWpC,IAAMoC,EAASnC,GAC1BmC,IAAWtC,EACC,MAAVkC,GACFG,EAAatX,MAAMiV,EAAM,IAAKtX,IAC9BwZ,EAAQ,IAERG,EAAatX,MAAMiV,EAAMtX,IAK3B2Z,EAAatX,MAAM+U,EAAKwC,EAAQ5Z,IAElC0Z,EAAMrX,KAAK8G,MAAMuQ,EAAOC,QACnBD,EAAMrX,KAAK8G,MAAMuQ,EAAOzC,EAAMqC,EAAQva,KAK/C,IAFA,IAAI8a,GAAQ,YACRC,IAAUD,GAAO,IACZ9a,EAAI,EAAGA,EAAI2a,EAAMzW,OAAQlE,IAAK,CACrC,IAAI8C,EAAMiY,EAAMA,EAAM7W,OAAS,GAAG,GAC9BpC,EAAI6Y,EAAM3a,GACZgb,EAAYlZ,EAAE,GAChB,GAAIkZ,IAAczC,GAAQ,MAAMiB,KAAK1X,EAAE,IAAK,CAC1C,IAAImZ,EAAKF,EAAMA,EAAM7W,OAAS,GAAG,GAC7B6W,EAAM7W,OAAS,IACjB6W,EAAMzI,MACNyI,EAAMA,EAAM7W,OAAS,GAAG,GAAG,GAAG+W,GAAMrI,EAClC9P,EAAI,GACJA,EAAI,GACJA,EAAI,GAAGoB,OAASpB,EAAI,QAAKY,SAGxB,GAAIsX,IAAczC,EAAM,CAC7B,IAAIlY,GAAKyB,EAAE,UACXgB,EAAI,GAAGQ,KAAKjD,GACZ0a,EAAMzX,MAAMjD,EAAGyC,EAAI,GAAGoB,OAAS,SAC1B,GACL8W,IAActC,GACbsC,IAAc3C,GAAOvW,EAAE,KAAO4W,EAC/B,CAGA,IAFA,IAAInX,EAAM,GACN2Z,OAAO,EACJlb,EAAI2a,EAAMzW,OAAQlE,IACvB,GAAI2a,EAAM3a,GAAG,KAAO0Y,EAClBnX,EAAM0N,EAAO1N,EAAKoZ,EAAM3a,GAAG,QACtB,IAAI2a,EAAM3a,GAAG,KAAOqY,GAAOsC,EAAM3a,GAAG,KAAO0Y,EAU3C,MATL,GAA2B,WAAvByC,EAAOR,EAAM3a,GAAG,KAAoBuB,EAOtCA,EAAM0N,EAAO1N,EAAKoZ,EAAM3a,GAAG,SAN3B,IAAKkb,KAAWP,EAAM3a,GAAG,GACnB2a,EAAM3a,GAAG,GAAG6B,eAAeqZ,KAAapY,EAAI,GAAGoY,KACjDpY,EAAI,GAAGoY,GAAWP,EAAM3a,GAAG,GAAGkb,IAQpCP,EAAM3a,GAAG,KAAOgZ,GAAShZ,IAE7B,IADA,IAAIob,EAAIpb,EACDA,EAAI2a,EAAMzW,OAAQlE,IACvB,GAAI2a,EAAM3a,GAAG,KAAO6Y,GAAc8B,EAAM3a,GAAG,KAAO0Y,EAC3C5V,EAAI,GAAGvB,GAEM,KAAhBoZ,EAAM3a,GAAG,KACN8C,EAAI,GAAGvB,GAAO0N,EAAOnM,EAAI,GAAGvB,GAAMoZ,EAAM3a,GAAG,KAH9B8C,EAAI,GAAGvB,GAAO8Z,EAAMV,EAAM3a,GAAG,QAI1C,IACL2a,EAAM3a,GAAG,KAAOqY,GACfsC,EAAM3a,GAAG,KAAO6Y,GAAc8B,EAAM3a,GAAG,KAAO0Y,EAM1C,EAEHnX,EAAI2C,QACHpB,EAAI,GAAGvB,IACRvB,IAAMob,GACLT,EAAM3a,GAAG,KAAOwY,GAASmC,EAAM3a,GAAG,KAAOiZ,IAI1CnW,EAAI,GAAGvB,GAAOA,EAAImU,eAEhBiF,EAAM3a,GAAG,KAAOwY,GAClBxY,IAEF,MAlBK8C,EAAI,GAAGvB,GAEM,KAAhBoZ,EAAM3a,GAAG,KACN8C,EAAI,GAAGvB,GAAO0N,EAAOnM,EAAI,GAAGvB,GAAMoZ,EAAM3a,GAAG,KAH9B8C,EAAI,GAAGvB,GAAO8Z,EAAMV,EAAM3a,GAAG,UAqB9C,GAAIgb,IAActC,EACvB5V,EAAI,GAAGhB,EAAE,KAAM,OACV,GAAIkZ,IAAc3C,GAAOvW,EAAE,KAAO4W,EACvC5V,EAAI,GAAGhB,EAAE,KAAM,OACV,GAAIkZ,IAAcxC,GACvB,GAAIe,EAAYzW,EAAI,KAAOiY,EAAM7W,OAAQ,CACvC,IAAI+W,EAAKF,EAAMA,EAAM7W,OAAS,GAAG,GACjC6W,EAAMzI,MACNyI,EAAMA,EAAM7W,OAAS,GAAG,GAAG,GAAG+W,GAAMrI,EAClC9P,EAAI,GACJA,EAAI,GACJA,EAAI,GAAGoB,OAASpB,EAAI,QAAKY,SAGxB,GAAIsX,IAAc3C,GAAOvW,EAAE,KAAOwW,OAC1B5U,IAAT5B,EAAE,IAA6B,OAATA,EAAE,GAAaA,EAAE,GAAK,GACtCA,EAAE,KAAIA,EAAE,GAAKmN,EAAO,GAAInN,EAAE,KAChCwF,MAAMC,QAAQzF,EAAE,GAAG,IACrBgB,EAAI,GAAGQ,KAAK8G,MAAMtH,EAAI,GAAIhB,EAAE,IAE5BgB,EAAI,GAAGQ,KAAKxB,EAAE,SAEX,GAAIkZ,IAAc1C,EACvBxV,EAAI,GAAGQ,KAAKxB,EAAE,SACT,GAAIkZ,IAAchC,GAAWgC,IAAc/B,EAGhD,MAAM,IAAIjR,MAAM,cAAgBgT,GAUpC,OAJIF,EAAK,GAAG5W,OAAS,GAAK,QAAQsV,KAAKsB,EAAK,GAAG,KAC7CA,EAAK,GAAGQ,QAGNR,EAAK,GAAG5W,OAAS,GAAyB,IAAnB4W,EAAK,GAAG5W,QAAgB,KAAKsV,KAAKsB,EAAK,GAAG,IAC5DA,EAAK,IAGZxT,MAAMC,QAAQuT,EAAK,GAAG,KACG,iBAAlBA,EAAK,GAAG,GAAG,IAClBxT,MAAMC,QAAQuT,EAAK,GAAG,GAAG,MAEzBA,EAAK,GAAG,GAAKlI,EAAEkI,EAAK,GAAG,GAAG,GAAIA,EAAK,GAAG,GAAG,GAAIA,EAAK,GAAG,GAAG,KAEnDA,EAAK,GAAG,IAEf,SAAS5C,EAAMqD,GACb,IAAIC,KACApC,IAAUR,IAAuBQ,EAAQX,GAC7C,IAAK,IAAIzY,EAAI,EAAGA,EAAIub,EAAIrX,OAAQlE,IAAK,CACnC,IAAIyb,EAAUF,EAAIG,OAAO1b,GAErBoZ,IAAUd,GAAoB,MAAZmD,GAEhBhB,EAAMvW,QAAQsX,EAAIlY,MAAMgV,EAAMmC,IAClCA,EAAQ,GACRrB,EAAQb,GAEa,MAAZkD,GAAoBtC,EAAKC,IAAUA,IAAUF,EAe7CE,IAAUF,GAAW,KAAKM,KAAKiB,IAAsB,MAAZgB,GAClDhB,EAAQ,GACRrB,EAAQd,GACCc,IAAUb,GAAQ,QAAQiB,KAAKiB,IACxCA,EAAQgB,EACRrC,EAAQF,GACCE,IAAUd,GAAQc,IAAUF,EACrCuB,GAASgB,EACArC,IAAUb,GAAoB,MAAZkD,GAAmBhB,EAAMvW,SAE3CkV,IAAUb,GAAQ,KAAKiB,KAAKiC,IACjChB,EAAMvW,QACRsX,EAAIlY,MAAMiV,EAAMkC,IAElBA,EAAQ,GACRrB,EAAQX,GACCW,IAAUb,EACnBkC,GAASgB,EACArC,IAAUX,GAAQ,YAAYe,KAAKiC,IAC5CrC,EAAQV,EACR+B,EAAQgB,GACCrC,IAAUX,GAAQ,KAAKe,KAAKiC,IACjChB,EAAMvW,QAAQsX,EAAIlY,MAAMoV,EAAU+B,IACtCe,EAAIlY,MAAM2V,KACDG,IAAUV,GAAY,KAAKc,KAAKiC,IACzCD,EAAIlY,MAAMoV,EAAU+B,IACpBA,EAAQ,GACRrB,EAAQT,GACCS,IAAUV,GAAwB,MAAZ+C,GAC/BD,EAAIlY,MAAMoV,EAAU+B,IAASzB,IAC7ByB,EAAQ,GACRrB,EAAQR,GACCQ,IAAUV,EACnB+B,GAASgB,EAERrC,IAAUT,GAAuBS,IAAUX,GAChC,MAAZgD,EAKCrC,IAAUT,GAAuBS,IAAUX,GAC3C,KAAKe,KAAKiC,GAOFrC,IAAUR,GAAqC,MAAZ6C,EAC5CrC,EAAQL,EACCK,IAAUR,GAAqC,MAAZ6C,EAC5CrC,EAAQN,EACCM,IAAUL,GAAsC,MAAZ0C,GAC7CD,EAAIlY,MAAMuV,EAAY4B,IAASxB,IAC/BwB,EAAQ,GACRrB,EAAQX,GACCW,IAAUN,GAAsC,MAAZ2C,GAC7CD,EAAIlY,MAAMuV,EAAY4B,IAASxB,IAC/BwB,EAAQ,GACRrB,EAAQX,GACCW,IAAUR,GAA0B,KAAKY,KAAKiC,GAG9CrC,IAAUP,GAAc,KAAKW,KAAKiC,IAC3CD,EAAIlY,MAAMuV,EAAY4B,IAASxB,IAC/BwB,EAAQ,GACRrB,EAAQX,GAERW,IAAUP,GACVO,IAAUN,GACVM,IAAUL,IAEV0B,GAASgB,IAXTrC,EAAQP,EACR7Y,MAnBAwb,EAAIlY,MAAM2V,IACN,QAAQO,KAAKiC,IACfhB,GAASgB,EACTrC,EAAQV,GACHU,EAAQX,IAVf+C,EAAIlY,MAAM0V,IACVI,EAAQR,KApDJQ,IAAUb,GAAQkC,EAAMvW,OAC1BsX,EAAIlY,MAAMiV,EAAMkC,IAEPrB,IAAUV,EACnB8C,EAAIlY,MAAMoV,EAAU+B,IAGbrB,IAAUP,GAAc4B,EAAMvW,QACrCsX,EAAIlY,MAAMuV,EAAY4B,IAExBe,EAAIlY,MAAMkV,IACViC,EAAQ,GACRrB,EAAQd,GA6FZ,OAhBIc,IAAUd,GAAQmC,EAAMvW,QAC1BsX,EAAIlY,MAAMgV,EAAMmC,IAChBA,EAAQ,IACCrB,IAAUP,GAAc4B,EAAMvW,QACvCsX,EAAIlY,MAAMuV,EAAY4B,IACtBA,EAAQ,IACCrB,IAAUL,GAA0B0B,EAAMvW,QACnDsX,EAAIlY,MAAMuV,EAAY4B,IACtBA,EAAQ,IACCrB,IAAUN,GAA0B2B,EAAMvW,QACnDsX,EAAIlY,MAAMuV,EAAY4B,IACtBA,EAAQ,IACCrB,IAAUV,IACnB8C,EAAIlY,MAAMoV,EAAU+B,IACpBA,EAAQ,IAEHe,GAlSSG,CAAsB3I,EAASuH,EAASnS,GACxD,GAAId,MAAMC,QAAQiT,GAChB,OAAOrH,EAAgBqH,EAAWxH,GAMpC,IADA,IAAII,EAASoH,EACNpH,aAAkBZ,GACvBY,EAASA,EAAOT,MAAMK,GAExB,OAAOI,KA2RX,SAASiI,EAAMtR,GACb,MAAiB,mBAANA,EAAyBA,EACd,iBAANA,EAAuBA,EAC9BA,GAAkB,WAAboR,EAAOpR,GAAuBA,EAChCkF,EAAO,GAAIlF,ICnUT6R,CAAOhJ,4HCLlB,SAASiJ,EACdhE,EACAvS,EACAwW,GAMA,IALAC,EAKA9X,UAAAC,OAAA,QAAAR,IAAAO,UAAA,GAAAA,UAAA,IAJE+X,QAAQ,EACR5W,SAAU,EACV4N,YAGEiJ,EAAYlQ,SAAS2B,cAAc,OAevC,OAdIqO,EAAQC,QACVjQ,SAASmQ,KAAKlO,YAAYiO,GAG5B3W,EAAWA,EAAS3C,IAAI,SAAAyG,GACtB,MAAwB,iBAAbA,EACF,SAAA6I,GAAA,IAAGwC,EAAHxC,EAAGwC,QAAH,OAEL0H,OAAOC,EAAgB3H,EAAQ4H,YAAYC,KACzCF,EAAgBhT,KAGfA,IAEFmT,EACL7E,EAAOG,EAAOoE,EAAWF,EAAQ/I,QAAS+I,EAAQ3W,UAClDE,EACAwW,GAKJ,SAASM,EAAgBzO,GAEvB,OADcA,EAAKgM,QAAQ,sBAAuB,QAI7C,SAAS4C,EAAMva,EAAQsD,EAAUwW,GACtC,OAAO9Z,EAAOsD,SACZA,EAAS3C,IAAI,SAAA8C,GAAS,sBAAA6N,iMAAA3N,CAAAC,mBAAAC,KAAI,SAAAC,EAAM7E,GAAN,OAAA2E,mBAAAG,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAClBsW,EAAc/W,EAAWxE,GAAOwb,MAAMX,EAAKY,MADzB,cAAA1W,EAAA2W,OAAA,SAEjB1b,GAFiB,wBAAA+E,EAAAM,SAAAR,EAAAS,SAAJ,gBAAAqW,GAAA,OAAAtJ,EAAAlJ,MAAA7D,KAAAtC,YAAA,KAItB6X,GAIJ,SAASU,EAAc/W,EAAWxE,GAChC,OAAO,IAAIyF,QAAQ,SAACF,EAASqW,GAI3B9U,WAAW,WACT,IAC2B,mBAAdtC,EACTA,EAAUxE,GAEVkb,OAAOlb,GAAO6b,QAAQrX,GAExBe,IACA,MAAOyP,GACP4G,EAAO5G,QChEfnW,EAAAQ,EAAAyc,EAAA,uBAAAnD,IAAA9Z,EAAAQ,EAAAyc,EAAA,2BAAAC,EAAA,IAAAld,EAAAQ,EAAAyc,EAAA,2BAAAC,EAAA,IAAAld,EAAAQ,EAAAyc,EAAA,6BAAAC,EAAA,IAAAld,EAAAQ,EAAAyc,EAAA,2BAAArF,IAAA5X,EAAAQ,EAAAyc,EAAA,8BAAAvK,IAAA1S,EAAAQ,EAAAyc,EAAA,sBAAAE,IAAAnd,EAAAQ,EAAAyc,EAAA,oCAAA5J,IAAArT,EAAAQ,EAAAyc,EAAA,iCAAA1J,IAAAvT,EAAAQ,EAAAyc,EAAA,wBAAA3L,IAAAtR,EAAAQ,EAAAyc,EAAA,0BAAAvL,IAAA1R,EAAAQ,EAAAyc,EAAA,6BAAAlL,IAAA/R,EAAAQ,EAAAyc,EAAA,4BAAA/K,IAAAlS,EAAAQ,EAAAyc,EAAA,+BAAAlB,IAAA/b,EAAAQ,EAAAyc,EAAA,0BAAAR","file":"zliq.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"zliq\"] = factory();\n\telse\n\t\troot[\"zliq\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","import deepEqual from \"deep-equal\";\n\n/*\n* stream constructor\n* constructor returns a stream\n* get the current value of stream like: stream.value\n*/\nexport const stream = function(init_value) {\n  let s = function(value) {\n    update(s, value);\n    return s;\n  };\n\n  s.IS_STREAM = true;\n  s.value = init_value;\n  s.listeners = [];\n\n  // better debugging output for streams\n  s.toString = () => \"Stream(\" + s.value + \")\";\n\n  s.map = fn => map(s, fn);\n  s.is = value => map(s, cur => cur === value);\n  s.flatMap = fn => flatMap(s, fn);\n  s.filter = fn => filter(s, fn);\n  s.deepSelect = fn => deepSelect(s, fn);\n  s.distinct = fn => distinct(s, fn);\n  s.query = selectorArr => query(s, selectorArr);\n  s.$ = selectorArr => query(s, selectorArr).distinct();\n  s.until = stopEmit$ => until(s, stopEmit$);\n  s.patch = partialChange => patch(s, partialChange);\n  s.reduce = (fn, startValue) => reduce(s, fn, startValue);\n  s.debounce = timer => debounce(s, timer);\n  s.schedule = (scheduleItems, onDone) => schedule(s, scheduleItems, onDone);\n  s.next = () => next(s);\n  s.log = (prefix = \"Stream:\") => log(s, prefix);\n\n  return s;\n};\n\n/*\n* wrapper for the diffing of stream values\n*/\nfunction valuesChanged(oldValue, newValue) {\n  return !deepEqual(oldValue, newValue);\n}\n\n/*\n* update the stream value and notify listeners on the stream\n*/\nfunction update(parent$, newValue) {\n  parent$.value = newValue;\n  notifyListeners(parent$.listeners, newValue);\n}\n\n/*\n* provide a new value to all listeners registered for a stream\n*/\nfunction notifyListeners(listeners, value) {\n  listeners.forEach(function notifyListener(listener) {\n    listener(value);\n  });\n}\n\n/*\n* Do not pipe the value undefined. This allows to wait for an external initialization.\n* It also saves you from checking for an initial null on every map function.\n*/\nfunction fork$(parent$, mapFunction) {\n  let initValue =\n    parent$.value !== undefined ? mapFunction(parent$.value) : undefined;\n  return stream(initValue);\n}\n\n/*\n* provides a new stream applying a transformation function to the value of a parent stream\n*/\nfunction map(parent$, fn) {\n  let newStream = fork$(parent$, fn);\n  parent$.listeners.push(function mapValue(value) {\n    newStream(fn(value));\n  });\n  return newStream;\n}\n\n/* \n* helper function to debug, calls console.log on every value returnin the parent stream \n*/\nfunction log(parent$, prefix) {\n  map(parent$, value => console.log(prefix, value));\n  return parent$;\n}\n\n/*\n* provides a new stream applying a transformation function to the value of a parent stream\n*/\nfunction flatMap(parent$, fn) {\n  let result$;\n  let listener = function updateOuterStream(result) {\n    newStream(result);\n  };\n  function attachToResult$(mapFn, parentValue, listener) {\n    let result$ = mapFn(parentValue);\n    result$.listeners.push(listener);\n    return result$;\n  }\n  let newStream = fork$(parent$, function getChildStreamValue(value) {\n    result$ = attachToResult$(fn, value, listener);\n    return result$.value;\n  });\n  parent$.listeners.push(function flatMapValue(value) {\n    // clean up listeners or they will stack on child streams\n    if (result$) {\n      removeItem(result$.listeners, listener);\n    }\n\n    result$ = attachToResult$(fn, value, listener);\n    newStream(result$.value);\n  });\n  return newStream;\n}\n\n/*\n* provides a new stream that only serves the values that a filter function returns true for\n* still a stream ALWAYS has a value -> so it starts at least with NULL\n*/\nfunction filter(parent$, fn) {\n  let newStream = fork$(parent$, value => (fn(value) ? value : undefined));\n  parent$.listeners.push(function filterValue(value) {\n    if (fn(value)) {\n      newStream(value);\n    }\n  });\n  return newStream;\n}\n\n/*\n* recursivly return the nested property of an object defined by an array of selectors\n* parent: {foo: {bar:1}}, selectors: ['foo','bar'] returns 1\n*/\nfunction select(parent, selectors) {\n  if (parent === null || parent === undefined) {\n    return null;\n  }\n  if (selectors.length === 0) {\n    return parent;\n  }\n  let selector = selectors[0];\n  return select(parent[selector], selectors.splice(1, selectors.length - 1));\n}\n/*\n* provides a new stream that has a selected sub property of the object value of the parent stream\n* the selector has the format [{propertyName}.]*\n*/\nfunction deepSelect(parent$, selector) {\n  let selectors = selector.split(\".\");\n\n  let newStream = fork$(parent$, value => select(value, selectors));\n  parent$.listeners.push(function deepSelectValue(newValue) {\n    newStream(select(newValue, selectors));\n  });\n  return newStream;\n}\n\nfunction query(parent$, selectorsArr) {\n  if (!Array.isArray(selectorsArr)) {\n    return parent$.map(value => select(value, selectorsArr.split(\".\")));\n  }\n  return parent$.map(value =>\n    selectorsArr.map(selectors => select(value, selectors.split(\".\")))\n  );\n}\n\n// TODO: maybe refactor with filter\n/*\n* provide a new stream that only notifys its children if the containing value actualy changes\n*/\nfunction distinct(parent$, fn = (a, b) => valuesChanged(a, b)) {\n  let newStream = fork$(parent$, value => value);\n  parent$.listeners.push(function deepSelectValue(value) {\n    if (fn(newStream.value, value)) {\n      newStream(value);\n    }\n  });\n  return newStream;\n}\n\n/*\n* update only the properties of an object passed\n* i.e. {name: 'Fabian', lastname: 'Weber} patched with {name: 'Fabo'} produces {name: 'Fabo', lastname: 'Weber}\n*/\nfunction patch(parent$, partialChange) {\n  setImmediate(() => {\n    if (\n      partialChange === null ||\n      typeof partialChange !== \"object\" ||\n      typeof parent$.value !== \"object\"\n    ) {\n      parent$(partialChange);\n    } else {\n      parent$(Object.assign({}, parent$.value, partialChange));\n    }\n  });\n  return parent$;\n}\n\nfunction until(parent$, stopEmitValues$) {\n  let newStream = stream();\n  let subscribeTo = (stream, listener) => {\n    listener(parent$.value);\n    stream.listeners.push(listener);\n  };\n  if (stopEmitValues$.value === undefined) {\n    subscribeTo(parent$, newStream);\n  }\n  stopEmitValues$.map(stopEmitValues => {\n    if (stopEmitValues) {\n      removeItem(parent$.listeners, newStream);\n    } else {\n      subscribeTo(parent$, newStream);\n    }\n  });\n  return newStream;\n}\n\n/*\n* reduce a stream over time\n* this will pass the last output value to the calculation function\n* reads like the array reduce function\n*/\nfunction reduce(parent$, fn, startValue) {\n  let aggregate = startValue;\n  let newStream = stream();\n  function reduceValue(value) {\n    aggregate = fn(aggregate, parent$.value);\n    newStream(aggregate);\n  }\n  if (parent$.value !== undefined) {\n    reduceValue(parent$.value);\n  }\n  parent$.listeners.push(reduceValue);\n  return newStream;\n}\n\nfunction debounce(parent$, timer) {\n  let curTimer;\n  function debounceValue(value) {\n    if (curTimer) {\n      window.clearTimeout(curTimer);\n    }\n    curTimer = setTimeout(function updateChildStream() {\n      newStream(value);\n      curTimer = null;\n    }, timer);\n  }\n  let newStream = stream();\n  if (parent$.value !== undefined) {\n    debounceValue(parent$.value);\n  }\n  parent$.listeners.push(debounceValue);\n  return newStream;\n}\n\n/*\n* Execute the scheduled function or return the scheduled value for a stream iteration\n*/\nfunction executeScheduleItem(schedule, iteration, value) {\n  if (schedule.length < iteration + 1) {\n    throw Error(\"ZLIQ: schedule for iteration \" + iteration + \" not defined\");\n  }\n  let item = schedule[iteration];\n  if (typeof item === \"function\") {\n    return item(value);\n  } else {\n    return item;\n  }\n}\n\n/*\n* Especially in tests you want to define a reaction to a certain iteration of a stream\n* The iteration can be a function or a value\n*/\nfunction schedule(parent$, schedule, onDone = () => {}) {\n  let iteration = 0;\n  let newStream = fork$(parent$, value =>\n    executeScheduleItem(schedule, iteration++, value)\n  );\n  if (schedule.length === iteration) onDone();\n\n  parent$.listeners.push(function checkSchedule(value) {\n    // do immediate to prevent schedule items to update parent streams before child streams ran\n    setImmediate(async () => {\n      newStream(await executeScheduleItem(schedule, iteration++, value));\n      if (iteration === schedule.length) onDone();\n    });\n  });\n  return newStream;\n}\n\n/*\n*  allow to use a stream in an async await cycle\n* i.e: const value = await myStream.next()\n*/\nfunction next(parent$) {\n  let resolve;\n  const promise = new Promise(_resolve => {\n    resolve = _resolve;\n  });\n  subscribeTo(parent$, resolve);\n  promise.then(() => removeItem(parent$.listeners, resolve));\n  return promise;\n}\n\n/*\n* merge several streams into one stream providing the values of all streams as an array\n* accepts also non stream elements, those are just copied to the output\n* the merge will only have a value if every stream for the merge has a value\n*/\nexport function merge$(potentialStreamsArr) {\n  let values = potentialStreamsArr.map(\n    parent$ => (parent$ && parent$.IS_STREAM ? parent$.value : parent$)\n  );\n  let newStream = stream(values.indexOf(undefined) === -1 ? values : undefined);\n\n  potentialStreamsArr.forEach((potentialStream, index) => {\n    if (potentialStream.IS_STREAM) {\n      potentialStream.listeners.push(function updateMergedStream(value) {\n        values[index] = value;\n        newStream(values.indexOf(undefined) === -1 ? values : undefined);\n      });\n    }\n  });\n  return newStream;\n}\n\nexport function isStream(parent$) {\n  return parent$ != null && !!parent$.IS_STREAM;\n}\n\nfunction removeItem(arr, item) {\n  var index = arr.indexOf(item);\n  if (index !== -1) {\n    arr.splice(index, 1);\n  }\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var pSlice = Array.prototype.slice;\nvar objectKeys = require('./lib/keys.js');\nvar isArguments = require('./lib/is_arguments.js');\n\nvar deepEqual = module.exports = function (actual, expected, opts) {\n  if (!opts) opts = {};\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (!actual || !expected || typeof actual != 'object' && typeof expected != 'object') {\n    return opts.strict ? actual === expected : actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected, opts);\n  }\n}\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isBuffer (x) {\n  if (!x || typeof x !== 'object' || typeof x.length !== 'number') return false;\n  if (typeof x.copy !== 'function' || typeof x.slice !== 'function') {\n    return false;\n  }\n  if (x.length > 0 && typeof x[0] !== 'number') return false;\n  return true;\n}\n\nfunction objEquiv(a, b, opts) {\n  var i, key;\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b, opts);\n  }\n  if (isBuffer(a)) {\n    if (!isBuffer(b)) {\n      return false;\n    }\n    if (a.length !== b.length) return false;\n    for (i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n  try {\n    var ka = objectKeys(a),\n        kb = objectKeys(b);\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key], opts)) return false;\n  }\n  return typeof a === typeof b;\n}\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","exports = module.exports = typeof Object.keys === 'function'\n  ? Object.keys : shim;\n\nexports.shim = shim;\nfunction shim (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n}\n","var supportsArgumentsClass = (function(){\n  return Object.prototype.toString.call(arguments)\n})() == '[object Arguments]';\n\nexports = module.exports = supportsArgumentsClass ? supported : unsupported;\n\nexports.supported = supported;\nfunction supported(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n};\n\nexports.unsupported = unsupported;\nfunction unsupported(object){\n  return object &&\n    typeof object == 'object' &&\n    typeof object.length == 'number' &&\n    Object.prototype.hasOwnProperty.call(object, 'callee') &&\n    !Object.prototype.propertyIsEnumerable.call(object, 'callee') ||\n    false;\n};\n","import { stream, merge$, isStream } from \"./\";\n\n// provide easy switched on boolean streams\n// example use case: <button onclick={()=>open$(!open$())}>{if$(open$, 'Close', 'Open')}</button>\nexport function if$(boolean$, onTrue = null, onFalse = null) {\n  if (boolean$ === undefined || !isStream(boolean$)) {\n    return stream(boolean$ ? onTrue : onFalse);\n  }\n  return boolean$.map(x => (x ? onTrue : onFalse));\n}\n\n// join a mixed array of strings and streams of strings\n// example use case: <div class={join$('container', if$(open$, 'open', 'closed'))} />\nexport function join$(...$arr) {\n  return merge$($arr).map(arr => arr.join(\" \"));\n}\n\n/*\n* Resolve all nested streams in an object\n* input: {a:{}, b:stream:{}}\n* output: stream({a:{}, b:{}})\n*/\nexport function resolve$(obj) {\n  if (obj === null) return stream({});\n\n  let nestedStreams = extractNestedStreams(obj);\n  let updateStreams = nestedStreams.map(function makeNestedStreamUpdateObject({\n    parent,\n    key,\n    stream\n  }) {\n    return (\n      stream\n        .distinct()\n        // here we produce a sideeffect on the object -> low GC\n        // to trigger the merge we also need to return sth (as undefined does not trigger listeners)\n        .map(value => {\n          parent[key] = value;\n          return value;\n        })\n    );\n  });\n  return merge$(updateStreams).map(_ => obj);\n}\n\n// to react to nested streams in an object, we extract the streams and a reference to their position\n// returns [{parentObject, propertyName, stream}]\nfunction extractNestedStreams(obj) {\n  return flatten(\n    Object.keys(obj).map(key => {\n      // DEPRECATED I can't think of a usecase\n      // if (typeof obj[key] === 'object') {\n      // \treturn extractNestedStreams(obj[key]);\n      // }\n      if (obj[key] === null || obj[key] === undefined) {\n        return [];\n      }\n      if (isStream(obj[key])) {\n        return [\n          {\n            parent: obj,\n            key,\n            stream: obj[key]\n          }\n        ];\n      }\n      if (typeof obj[key] === \"object\") {\n        return extractNestedStreams(obj[key]);\n      }\n      return [];\n    })\n  );\n}\n\n// flattens an array\nexport function flatten(array, mutable) {\n  var toString = Object.prototype.toString;\n  var arrayTypeStr = \"[object Array]\";\n\n  var result = [];\n  var nodes = (mutable && array) || array.slice();\n  var node;\n\n  if (!array.length) {\n    return result;\n  }\n\n  node = nodes.pop();\n\n  do {\n    if (toString.call(node) === arrayTypeStr) {\n      nodes.push.apply(nodes, node);\n    } else {\n      result.push(node);\n    }\n  } while (nodes.length && (node = nodes.pop()) !== undefined);\n\n  result.reverse(); // we reverse result to restore the original order\n  return result;\n}\n","import { merge$, isStream } from \"./streamy\";\nimport { resolve$, flatten } from \"./streamy-helpers\";\n\nexport class Component {\n  constructor(constructorFn) {\n    this.build = constructorFn;\n  }\n}\n\n/*\n* wrap vdom elements in reactive streams dependent on their children streams\n* the vdom constructor function returns another constructor so we can pass down globals from the renderer to the components\n*/\nexport const h = (tag, props, ...children) => {\n  props = props ? props : {};\n\n  return new Component(globals => {\n    let version = -1;\n\n    let constructedChildren = resolveChildren(children, globals);\n    let mergedChildren$ = mergeChildren$(constructedChildren);\n    // jsx usually resolves known tags as strings and unknown tags as functions\n    // if it is a function it is treated as a component and will resolve it\n    // props are not automatically resolved\n    if (typeof tag === \"function\") {\n      // TODO refactor component resolution\n      let output = tag(props, mergedChildren$, globals);\n\n      if (Array.isArray(output)) {\n        return resolveChildren(output, globals);\n      }\n      if (output instanceof Component || isStream(output)) {\n        return resolveChild(output, globals);\n      }\n\n      // allow simple component that receives resolved streams\n      return merge$([resolve$(props), mergedChildren$.map(flatten)])\n        .map(([props, children]) => output(props, children, globals))\n        .map(children => resolveChildren(children, globals));\n    }\n\n    return merge$([resolve$(props), mergedChildren$.map(flatten)]).map(\n      ([props, children]) => {\n        return {\n          tag,\n          props,\n          children,\n          version: ++version\n        };\n      }\n    );\n  });\n};\n\n/*\n* wrap all children in streams and merge those\n* we make sure that all children streams are flat arrays to make processing uniform\n* input: [stream]\n* output: stream([])\n*/\nfunction mergeChildren$(children) {\n  if (!Array.isArray(children)) {\n    children = [children];\n  }\n  children = flatten(children).filter(_ => _ !== null);\n  let childrenVdom$arr = children.map(child => {\n    if (isStream(child)) {\n      return child.flatMap(mergeChildren$);\n    }\n    return child;\n  });\n\n  return merge$(childrenVdom$arr);\n}\n\n/*\n* children can be nested arrays, nested streams and element contstructors\n* this function unifies them into the format [string|number|vdom|stream<string|number|vdom>]\n*/\nexport function resolveChildren(children, globals) {\n  if (!Array.isArray(children)) {\n    children = [].concat(children);\n  }\n  let resolvedChilden = children.map(child => {\n    if (Array.isArray(child)) {\n      return resolveChildren(child, globals);\n    }\n    return resolveChild(child, globals);\n  });\n  return flatten(resolvedChilden);\n}\n\n/*\n* resolve the element constructor, also for elements nested in streams\n* returns the format string|number|vdom|stream<string|number|vdom>\n*/\nexport function resolveChild(child, globals) {\n  if (child instanceof Component) {\n    return resolveChildren(child.build(globals), globals);\n  }\n  if (isStream(child)) {\n    return child.map(x => resolveChildren(x, globals));\n  }\n  return child;\n}\n","import { isStream } from \"./streamy\";\n\nexport const TEXT_NODE = \"#text\";\n\nexport function diff(\n  parentElement,\n  oldElement,\n  newChild,\n  oldChild,\n  cacheContainer\n) {\n  // if there is no element on the parent to diff against yet,\n  // we create the element here to make diffing later on more uniform\n  if (oldElement === null) {\n    oldElement = createNode(newChild.tag, newChild.children);\n    if (parentElement) {\n      parentElement.appendChild(oldElement);\n    }\n  }\n\n  let newElement = oldElement;\n  let isCaching = newChild.props && newChild.props.id;\n\n  try {\n    // for keyed/idd elements, we recall unchanged elements\n    if (isCaching) {\n      newElement = diffCachedElement(\n        oldElement,\n        newChild,\n        oldChild,\n        cacheContainer\n      );\n    } else {\n      newElement = diffElement(oldElement, newChild, oldChild, cacheContainer);\n    }\n  } catch (err) {\n    // on errors, show an error element instead of crashing\n    newElement = {\n      tag: \"div\",\n      props: {\n        style: \"border: 1px solid red; color: red;\"\n      },\n      children: [\"FAULTY ELEMENT\"]\n    };\n    console.error(\"[ERROR]: An element failed to render.\\n\", err);\n  }\n\n  return newElement;\n}\n\nfunction diffCachedElement(\n  oldElement,\n  { tag, props, children, version },\n  { props: oldProps },\n  cacheContainer\n) {\n  let id = props.id;\n  let gotCreated = false;\n  let gotUpdated = false;\n\n  // if there is no cache, create one\n  if (cacheContainer[id] === undefined) {\n    cacheContainer[id] = {\n      element: document.createElement(tag),\n      vdom: {\n        tag,\n        props: {},\n        children: []\n      }\n    };\n    gotCreated = true;\n  }\n\n  let elementCache = cacheContainer[id];\n\n  // ignore update if version equals cache\n  if (version !== elementCache.version) {\n    diffAttributes(elementCache.element, props, oldProps);\n    diffChildren(\n      elementCache.element,\n      children,\n      elementCache.vdom.children,\n      cacheContainer\n    );\n\n    elementCache.version = version;\n    elementCache.vdom.props = props;\n    elementCache.vdom.children = children;\n\n    gotUpdated = true;\n  }\n\n  if (gotCreated) {\n    triggerLifecycle(elementCache.element, props, \"created\");\n  } else if (gotUpdated) {\n    triggerLifecycle(elementCache.element, props, \"updated\");\n  }\n\n  // elements are updated in place, so only insert cached element if it's not already there\n  if (oldElement !== elementCache.element) {\n    oldElement.parentElement.replaceChild(elementCache.element, oldElement);\n    triggerLifecycle(elementCache.element, props, \"mounted\");\n  }\n\n  return elementCache.element;\n}\n\nfunction diffElement(\n  element,\n  { tag, props, children: newChildren, version: newVersion },\n  { props: oldProps, children: oldChildren, version: oldVersion },\n  cacheContainer\n) {\n  let initialRender = oldVersion === -1 || oldVersion === undefined;\n\n  // text nodes behave differently then normal dom elements\n  if (isTextNode(element) && tag === TEXT_NODE) {\n    updateTextNode(element, newChildren[0]);\n    return element;\n  }\n\n  // if the node types do not differ, we reuse the old node\n  // we reuse the existing node to save time rerendering it\n  // we do not reuse/mutate cached (id) elements as this will mutate the cache\n  if (shouldRecycleElement(element, props, tag) === false) {\n    let newElement = createNode(tag, newChildren);\n    element.parentElement.replaceChild(newElement, element);\n    element = newElement;\n    // there are no children anymore on the newly created node\n    oldChildren = [];\n  }\n\n  diffAttributes(element, props, oldProps);\n\n  // sometimes you might want to skip updates to children on renderer elements i.e. if externals handle this component\n  let isolated = props && props.isolated !== undefined;\n\n  // text nodes we don't want to handle children like with other elements\n  // and for isolated components we want to skip all updates after the first render\n  if (tag !== TEXT_NODE && (!isolated || initialRender)) {\n    diffChildren(element, newChildren, oldChildren, cacheContainer);\n  }\n\n  if (initialRender) {\n    triggerLifecycle(element, props, \"created\");\n  }\n\n  if (newVersion > 0) {\n    triggerLifecycle(element, props, \"updated\");\n  }\n\n  return element;\n}\n\n// this removes nodes at the end of the children, that are not needed anymore in the current state for recycling\nfunction removeNotNeededNodes(parentElements, newChildren, oldChildren) {\n  let remaining = parentElements.childNodes.length;\n  if (oldChildren.length !== remaining) {\n    console.warn(\n      \"ZLIQ: Something other then ZLIQ has manipulated the children of the element\",\n      parentElements,\n      \". This can lead to sideffects. Consider using the 'isolated' attribute for this element to prevent updates.\"\n    );\n  }\n\n  for (; remaining > newChildren.length; remaining--) {\n    let childToRemove = parentElements.childNodes[remaining - 1];\n    parentElements.removeChild(childToRemove);\n\n    if (oldChildren.length < remaining) {\n      continue;\n    } else {\n      let { cycle } = oldChildren[remaining - 1];\n\n      triggerLifecycle(childToRemove, { cycle }, \"removed\");\n    }\n  }\n}\n\nfunction updateExistingNodes(\n  parentElement,\n  newChildren,\n  oldChildren,\n  cacheContainer\n) {\n  let nodes = parentElement.childNodes;\n  for (let i = 0; i < nodes.length && i < newChildren.length; i++) {\n    diff(\n      parentElement,\n      nodes[i],\n      newChildren[i],\n      oldChildren[i] || {},\n      cacheContainer\n    );\n  }\n}\n\nfunction addNewNodes(parentElement, newChildren, cacheContainer) {\n  for (let i = parentElement.childNodes.length; i < newChildren.length; i++) {\n    let { tag, props, children, version } = newChildren[i];\n    let newElement = createNode(tag, children);\n\n    parentElement.appendChild(newElement);\n\n    diff(parentElement, newElement, newChildren[i], {}, cacheContainer);\n\n    if (props && props.cycle && props.cycle.mounted && !props.id) {\n      console.error(\n        \"The 'mounted' lifecycle event is only called on elements with id. As elements are updated in place, it is hard to define when a normal element is mounted.\"\n      );\n    }\n  }\n}\n\nfunction diffAttributes(element, props, oldProps = {}) {\n  if (props !== undefined) {\n    Object.keys(props).map(function applyPropertyToElement(attribute) {\n      applyAttribute(element, attribute, props[attribute]);\n    });\n    Object.keys(oldProps).map(function removeNotNeededAttributes(oldAttribute) {\n      if (props[oldAttribute] === undefined) {\n        element.removeAttribute(oldAttribute);\n      }\n    });\n  }\n}\n\nfunction applyAttribute(element, attribute, value) {\n  // allow for any custom attribute to be set on the element\n  if (attribute.startsWith(\"*\")) {\n    element.setAttribute(attribute.substr(1), value);\n    return;\n  }\n\n  if (attribute === \"class\") {\n    element.className = value || \"\"; // \"\" in the case of a class stream returning null\n    // we leave the possibility to define styles as strings\n    // but we allow styles to be defined as an object\n  } else if (attribute === \"style\" && typeof value !== \"string\") {\n    const cssText = value\n      ? Object.keys(value)\n          .map(key => key + \":\" + value[key] + \";\")\n          .join(\" \")\n      : \"\";\n    element.style.cssText = cssText;\n    // other propertys are just added as is to the DOM\n  } else {\n    if (element[attribute] !== undefined) {\n      if (value === null) {\n        element[attribute] = undefined;\n      } else {\n        element[attribute] = value;\n      }\n    }\n    // also remove attributes on null to allow better handling of streams\n    // streams don't emit on undefined\n    if (value === null) {\n      element[attribute] = undefined;\n    } else {\n      element[attribute] = value;\n    }\n  }\n}\n\nfunction diffChildren(\n  element,\n  newChildren = [],\n  oldChildren = [],\n  cacheContainer\n) {\n  if (newChildren.length === 0 && oldChildren.length === 0) {\n    return;\n  }\n\n  let oldChildNodes = element.childNodes;\n  let unifiedNewChildren = unifyChildren(newChildren);\n  let unifiedOldChildren = unifyChildren(oldChildren);\n\n  updateExistingNodes(\n    element,\n    unifiedNewChildren,\n    unifiedOldChildren,\n    cacheContainer\n  );\n  removeNotNeededNodes(element, unifiedNewChildren, oldChildren);\n  addNewNodes(element, unifiedNewChildren, cacheContainer);\n}\n\n/* HELPERS */\n\n/*\n  * jsx has children mixed as vdom-elements and numbers or strings\n  * to consistently treat these children similar in the code we transform those numbers and strings\n  * into vdom-elements with the tag #text that have one child with their value\n  */\nfunction unifyChildren(children) {\n  return children.map(child => {\n    // if there is no tag we assume it's a number or a string\n    if (!isStream(child) && child.tag === undefined) {\n      return {\n        tag: TEXT_NODE,\n        children: [child],\n        version: 0\n      };\n    } else {\n      return child;\n    }\n  });\n}\n\n// create text_nodes from numbers or strings\n// create domNodes from regular vdom descriptions\nexport function createNode(tag, children) {\n  if (tag === TEXT_NODE) {\n    return document.createTextNode(children[0]);\n  } else {\n    return document.createElement(tag);\n  }\n}\n\n// TODO use React like effects for lifecycle events\n// shorthand to call a cycle event for an element if existing\nexport function triggerLifecycle(element, { cycle } = {}, event) {\n  if (cycle && cycle[event]) {\n    cycle[event](element);\n  }\n}\n\nfunction nodeTypeDiffers(element, tag) {\n  return element.nodeName.toLowerCase() !== tag;\n}\n\nfunction isTextNode(element) {\n  return element instanceof window.Text;\n}\n\nfunction updateTextNode(element, value) {\n  if (element.nodeValue !== value) {\n    element.nodeValue = value;\n  }\n}\n\n// we want to recycle elements to save time on creating and inserting nodes into the dom\n// we don't want to manipulate elements that go into the cache, because they would mutate in the cache as well\nfunction shouldRecycleElement(oldElement, props, tag) {\n  return (\n    !isTextNode(oldElement) &&\n    oldElement.id === \"\" &&\n    !nodeTypeDiffers(oldElement, tag)\n  );\n}\n","import { isStream, stream } from \"./streamy\";\nimport { Component, resolveChild, resolveChildren } from \"./streamy-vdom\";\nimport { diff, triggerLifecycle } from \"./vdom-diff\";\n\nexport function render(vdom, parentElement, globals = {}, debounce = 10) {\n  const vdom$ = resolveInputToStream(vdom, globals);\n  const renderStartState = {\n    element: null,\n    version: -1,\n    children: [],\n    keyContainer: {}\n  };\n\n  return vdom$\n    .debounce(debounce)\n    .reduce(renderUpdate.bind(null, parentElement), renderStartState);\n}\n\nfunction renderUpdate(\n  parentElement,\n  // current known state\n  {\n    element: oldElement,\n    version: oldVersion,\n    children: oldChildren,\n    keyContainer\n  },\n  // new vdom tree\n  { tag, props, children, version }\n) {\n  try {\n    let newElement = diff(\n      parentElement,\n      oldElement,\n      { tag, props, children, version },\n      { children: oldChildren, version: oldVersion },\n      keyContainer\n    );\n\n    // signalise mount of root element on initial render\n    if (parentElement && version === 0) {\n      triggerLifecycle(oldElement, props, \"mounted\");\n    }\n\n    return {\n      element: newElement,\n      version,\n      children: copyChildren(children),\n      keyContainer\n    };\n  } catch (err) {\n    console.error(\"Error in rendering step:\", err);\n  }\n}\n\n// we allow inputs to the render function to be:\n// a vdom-stream\n// a stream of Component\n// a Component\n// this function resolves the input to a vdom-stream\nfunction resolveInputToStream(input, globals) {\n  let vdom$;\n  if (isStream(input)) {\n    // resolve downstream components\n    vdom$ = input\n      .flatMap(input => {\n        let resolved = resolveChild(input, globals);\n\n        // resolvedChild can return an array of elements but we expect only one\n        // TODO make this better\n        if (Array.isArray(resolved)) {\n          resolved = resolved[0];\n        }\n\n        // because we are flatMapping we need to return streams\n        if (!isStream(resolved)) {\n          return stream(resolved);\n        }\n\n        return resolved;\n      })\n      // a resolved input could return an array but we expect the vdom$\n      // to return just one root vdom elem\n      .map(x => {\n        if (Array.isArray(x)) {\n          x = x[0];\n        }\n        return x;\n      });\n    return vdom$;\n  }\n\n  if (input instanceof Component) {\n    vdom$ = input.build(globals);\n    vdom$ = resolveInputToStream(vdom$, globals);\n    return vdom$;\n  } else if (typeof input === \"function\") {\n    // simple element constructor\n    vdom$ = input({}, [], globals);\n  }\n\n  // reiterate if still not a vdom-stream\n  if (!isStream(vdom$)) vdom$ = resolveInputToStream(vdom$, globals);\n\n  return vdom$;\n}\n\n// to not mutate the representation of our children from the last iteration we clone them\n// we copy the cycle functions for each element, as JSON parse/stringify does not work for functions\nfunction copyChildren(oldChildren = []) {\n  let newChildren = JSON.parse(JSON.stringify(oldChildren));\n  newChildren.forEach((child, index) => {\n    let oldChild = oldChildren[index];\n    if (oldChild.props && oldChild.props.cycle) {\n      child.cycle = oldChild.props.cycle;\n    }\n\n    if (typeof oldChildren[index] === \"object\") {\n      child.children = copyChildren(oldChild.children);\n    }\n  });\n  return newChildren;\n}\n","// forked from https://github.com/choojs/hyperx\n\nimport { Component, resolveChildren } from \"./index.js\";\n\nlet VAR = 0,\n  TEXT = 1,\n  OPEN = 2,\n  CLOSE = 3,\n  ATTR = 4;\nlet ATTR_KEY = 5,\n  ATTR_KEY_WHITESPACE = 6;\nlet ATTR_VALUE_WHITESPACE = 7,\n  ATTR_VALUE = 8;\nlet ATTR_VALUE_SINGLEQUOTE = 9,\n  ATTR_VALUE_DOUBLEQUOTE = 10;\nlet ATTR_EQ = 11,\n  ATTR_BREAK = 12;\nlet COMMENT = 13;\n\nexport default function hyperx(h, opts) {\n  if (!opts) opts = {};\n  let concat =\n    opts.concat ||\n    function(a, b) {\n      return String(a) + String(b);\n    };\n  if (opts.attrToProp !== false) {\n    h = attributeToProperty(h);\n  }\n\n  return (strings, ...values) => {\n    return new Component(globals => {\n      let component = handleTemplateLiteral(globals, strings, values);\n      if (Array.isArray(component)) {\n        return resolveChildren(component, globals);\n      }\n\n      // resolve nested components\n      // TODO needed? why?\n      let output = component;\n      while (output instanceof Component) {\n        output = output.build(globals);\n      }\n      return output;\n    });\n  };\n\n  // return (strings, ...values) => handleTemplateLiteral(null, strings, values);\n\n  function handleTemplateLiteral(globals, strings, values) {\n    let state = TEXT,\n      token = \"\";\n    let valuesLength = values.length;\n    let parts = [];\n\n    for (let i = 0; i < strings.length; i++) {\n      if (i < valuesLength) {\n        let value = escape(values[i]);\n        let parsedTokens = parse(strings[i]);\n        let xstate = state;\n        if (xstate === ATTR_VALUE_DOUBLEQUOTE) xstate = ATTR_VALUE;\n        if (xstate === ATTR_VALUE_SINGLEQUOTE) xstate = ATTR_VALUE;\n        if (xstate === ATTR_VALUE_WHITESPACE) xstate = ATTR_VALUE;\n        if (xstate === ATTR) xstate = ATTR_KEY;\n        if (xstate === OPEN) {\n          if (token === \"/\") {\n            parsedTokens.push([OPEN, \"/\", value]);\n            token = \"\";\n          } else {\n            parsedTokens.push([OPEN, value]);\n          }\n        } else {\n          // TODO resolve component here?\n          // if (typeof value === \"function\") value = value(globals);\n          parsedTokens.push([VAR, xstate, value]);\n        }\n        parts.push.apply(parts, parsedTokens);\n      } else parts.push.apply(parts, parse(strings[i]));\n    }\n\n    let tree = [null, {}, []];\n    let stack = [[tree, -1]];\n    for (let i = 0; i < parts.length; i++) {\n      let cur = stack[stack.length - 1][0];\n      let p = parts[i],\n        tokenType = p[0];\n      if (tokenType === OPEN && /^\\//.test(p[1])) {\n        let ix = stack[stack.length - 1][1];\n        if (stack.length > 1) {\n          stack.pop();\n          stack[stack.length - 1][0][2][ix] = h(\n            cur[0],\n            cur[1],\n            cur[2].length ? cur[2] : undefined\n          );\n        }\n      } else if (tokenType === OPEN) {\n        let c = [p[1], {}, []];\n        cur[2].push(c);\n        stack.push([c, cur[2].length - 1]);\n      } else if (\n        tokenType === ATTR_KEY ||\n        (tokenType === VAR && p[1] === ATTR_KEY)\n      ) {\n        let key = \"\";\n        let copyKey;\n        for (; i < parts.length; i++) {\n          if (parts[i][0] === ATTR_KEY) {\n            key = concat(key, parts[i][1]);\n          } else if (parts[i][0] === VAR && parts[i][1] === ATTR_KEY) {\n            if (typeof parts[i][2] === \"object\" && !key) {\n              for (copyKey in parts[i][2]) {\n                if (parts[i][2].hasOwnProperty(copyKey) && !cur[1][copyKey]) {\n                  cur[1][copyKey] = parts[i][2][copyKey];\n                }\n              }\n            } else {\n              key = concat(key, parts[i][2]);\n            }\n          } else break;\n        }\n        if (parts[i][0] === ATTR_EQ) i++;\n        let j = i;\n        for (; i < parts.length; i++) {\n          if (parts[i][0] === ATTR_VALUE || parts[i][0] === ATTR_KEY) {\n            if (!cur[1][key]) cur[1][key] = strfn(parts[i][1]);\n            else\n              parts[i][1] === \"\" ||\n                (cur[1][key] = concat(cur[1][key], parts[i][1]));\n          } else if (\n            parts[i][0] === VAR &&\n            (parts[i][1] === ATTR_VALUE || parts[i][1] === ATTR_KEY)\n          ) {\n            if (!cur[1][key]) cur[1][key] = strfn(parts[i][2]);\n            else\n              parts[i][2] === \"\" ||\n                (cur[1][key] = concat(cur[1][key], parts[i][2]));\n          } else {\n            if (\n              key.length &&\n              !cur[1][key] &&\n              i === j &&\n              (parts[i][0] === CLOSE || parts[i][0] === ATTR_BREAK)\n            ) {\n              // https://html.spec.whatwg.org/multipage/infrastructure.html#boolean-attributes\n              // empty string is falsy, not well behaved value in browser\n              cur[1][key] = key.toLowerCase();\n            }\n            if (parts[i][0] === CLOSE) {\n              i--;\n            }\n            break;\n          }\n        }\n      } else if (tokenType === ATTR_KEY) {\n        cur[1][p[1]] = true;\n      } else if (tokenType === VAR && p[1] === ATTR_KEY) {\n        cur[1][p[2]] = true;\n      } else if (tokenType === CLOSE) {\n        if (selfClosing(cur[0]) && stack.length) {\n          let ix = stack[stack.length - 1][1];\n          stack.pop();\n          stack[stack.length - 1][0][2][ix] = h(\n            cur[0],\n            cur[1],\n            cur[2].length ? cur[2] : undefined\n          );\n        }\n      } else if (tokenType === VAR && p[1] === TEXT) {\n        if (p[2] === undefined || p[2] === null) p[2] = \"\";\n        else if (!p[2]) p[2] = concat(\"\", p[2]);\n        if (Array.isArray(p[2][0])) {\n          cur[2].push.apply(cur[2], p[2]);\n        } else {\n          cur[2].push(p[2]);\n        }\n      } else if (tokenType === TEXT) {\n        cur[2].push(p[1]);\n      } else if (tokenType === ATTR_EQ || tokenType === ATTR_BREAK) {\n        // no-op\n      } else {\n        throw new Error(\"unhandled: \" + tokenType);\n      }\n    }\n\n    // TODO handle components\n\n    if (tree[2].length > 1 && /^\\s*$/.test(tree[2][0])) {\n      tree[2].shift();\n    }\n\n    if (tree[2].length > 2 || (tree[2].length === 2 && /\\S/.test(tree[2][1]))) {\n      return tree[2];\n    }\n    if (\n      Array.isArray(tree[2][0]) &&\n      typeof tree[2][0][0] === \"string\" &&\n      Array.isArray(tree[2][0][2])\n    ) {\n      tree[2][0] = h(tree[2][0][0], tree[2][0][1], tree[2][0][2]);\n    }\n    return tree[2][0];\n\n    function parse(str) {\n      let res = [];\n      if (state === ATTR_VALUE_WHITESPACE) state = ATTR;\n      for (let i = 0; i < str.length; i++) {\n        let curChar = str.charAt(i);\n\n        if (state === TEXT && curChar === \"<\") {\n          // _<button>HALLO_</button>\n          if (token.length) res.push([TEXT, token]);\n          token = \"\";\n          state = OPEN;\n          // <button_>HALLO</button_>,  ?? not <button x=\"y _> 2\"></button ??, not // <button_></button_>\n        } else if (curChar === \">\" && !quot(state) && state !== COMMENT) {\n          // <button_>HALLO</button_>\n          if (state === OPEN && token.length) {\n            res.push([OPEN, token]);\n            // <button disabled_>HALLO</button>\n          } else if (state === ATTR_KEY) {\n            res.push([ATTR_KEY, token]);\n          }\n          // <button x=\"y _> 2\">\n          else if (state === ATTR_VALUE && token.length) {\n            res.push([ATTR_VALUE, token]);\n          }\n          res.push([CLOSE]);\n          token = \"\";\n          state = TEXT;\n        } else if (state === COMMENT && /-$/.test(token) && curChar === \"-\") {\n          token = \"\";\n          state = TEXT;\n        } else if (state === OPEN && /^!--$/.test(token)) {\n          token = curChar;\n          state = COMMENT;\n        } else if (state === TEXT || state === COMMENT) {\n          token += curChar;\n        } else if (state === OPEN && curChar === \"/\" && token.length) {\n          // no-op, self closing tag without a space <br/>\n        } else if (state === OPEN && /\\s/.test(curChar)) {\n          if (token.length) {\n            res.push([OPEN, token]);\n          }\n          token = \"\";\n          state = ATTR;\n        } else if (state === OPEN) {\n          token += curChar;\n        } else if (state === ATTR && /[^\\s\"'=/]/.test(curChar)) {\n          state = ATTR_KEY;\n          token = curChar;\n        } else if (state === ATTR && /\\s/.test(curChar)) {\n          if (token.length) res.push([ATTR_KEY, token]);\n          res.push([ATTR_BREAK]);\n        } else if (state === ATTR_KEY && /\\s/.test(curChar)) {\n          res.push([ATTR_KEY, token]);\n          token = \"\";\n          state = ATTR_KEY_WHITESPACE;\n        } else if (state === ATTR_KEY && curChar === \"=\") {\n          res.push([ATTR_KEY, token], [ATTR_EQ]);\n          token = \"\";\n          state = ATTR_VALUE_WHITESPACE;\n        } else if (state === ATTR_KEY) {\n          token += curChar;\n        } else if (\n          (state === ATTR_KEY_WHITESPACE || state === ATTR) &&\n          curChar === \"=\"\n        ) {\n          res.push([ATTR_EQ]);\n          state = ATTR_VALUE_WHITESPACE;\n        } else if (\n          (state === ATTR_KEY_WHITESPACE || state === ATTR) &&\n          !/\\s/.test(curChar)\n        ) {\n          res.push([ATTR_BREAK]);\n          if (/[\\w-]/.test(curChar)) {\n            token += curChar;\n            state = ATTR_KEY;\n          } else state = ATTR;\n        } else if (state === ATTR_VALUE_WHITESPACE && curChar === '\"') {\n          state = ATTR_VALUE_DOUBLEQUOTE;\n        } else if (state === ATTR_VALUE_WHITESPACE && curChar === \"'\") {\n          state = ATTR_VALUE_SINGLEQUOTE;\n        } else if (state === ATTR_VALUE_DOUBLEQUOTE && curChar === '\"') {\n          res.push([ATTR_VALUE, token], [ATTR_BREAK]);\n          token = \"\";\n          state = ATTR;\n        } else if (state === ATTR_VALUE_SINGLEQUOTE && curChar === \"'\") {\n          res.push([ATTR_VALUE, token], [ATTR_BREAK]);\n          token = \"\";\n          state = ATTR;\n        } else if (state === ATTR_VALUE_WHITESPACE && !/\\s/.test(curChar)) {\n          state = ATTR_VALUE;\n          i--;\n        } else if (state === ATTR_VALUE && /\\s/.test(curChar)) {\n          res.push([ATTR_VALUE, token], [ATTR_BREAK]);\n          token = \"\";\n          state = ATTR;\n        } else if (\n          state === ATTR_VALUE ||\n          state === ATTR_VALUE_SINGLEQUOTE ||\n          state === ATTR_VALUE_DOUBLEQUOTE\n        ) {\n          token += curChar;\n        }\n      }\n      if (state === TEXT && token.length) {\n        res.push([TEXT, token]);\n        token = \"\";\n      } else if (state === ATTR_VALUE && token.length) {\n        res.push([ATTR_VALUE, token]);\n        token = \"\";\n      } else if (state === ATTR_VALUE_DOUBLEQUOTE && token.length) {\n        res.push([ATTR_VALUE, token]);\n        token = \"\";\n      } else if (state === ATTR_VALUE_SINGLEQUOTE && token.length) {\n        res.push([ATTR_VALUE, token]);\n        token = \"\";\n      } else if (state === ATTR_KEY) {\n        res.push([ATTR_KEY, token]);\n        token = \"\";\n      }\n      return res;\n    }\n  }\n\n  function strfn(x) {\n    if (typeof x === \"function\") return x;\n    else if (typeof x === \"string\") return x;\n    else if (x && typeof x === \"object\") return x;\n    else return concat(\"\", x);\n  }\n}\n\nfunction quot(state) {\n  return state === ATTR_VALUE_SINGLEQUOTE || state === ATTR_VALUE_DOUBLEQUOTE;\n}\n\nlet closeRE = RegExp(\n  \"^(\" +\n    [\n      \"area\",\n      \"base\",\n      \"basefont\",\n      \"bgsound\",\n      \"br\",\n      \"col\",\n      \"command\",\n      \"embed\",\n      \"frame\",\n      \"hr\",\n      \"img\",\n      \"input\",\n      \"isindex\",\n      \"keygen\",\n      \"link\",\n      \"meta\",\n      \"param\",\n      \"source\",\n      \"track\",\n      \"wbr\",\n      \"!--\",\n      // SVG TAGS\n      \"animate\",\n      \"animateTransform\",\n      \"circle\",\n      \"cursor\",\n      \"desc\",\n      \"ellipse\",\n      \"feBlend\",\n      \"feColorMatrix\",\n      \"feComposite\",\n      \"feConvolveMatrix\",\n      \"feDiffuseLighting\",\n      \"feDisplacementMap\",\n      \"feDistantLight\",\n      \"feFlood\",\n      \"feFuncA\",\n      \"feFuncB\",\n      \"feFuncG\",\n      \"feFuncR\",\n      \"feGaussianBlur\",\n      \"feImage\",\n      \"feMergeNode\",\n      \"feMorphology\",\n      \"feOffset\",\n      \"fePointLight\",\n      \"feSpecularLighting\",\n      \"feSpotLight\",\n      \"feTile\",\n      \"feTurbulence\",\n      \"font-face-format\",\n      \"font-face-name\",\n      \"font-face-uri\",\n      \"glyph\",\n      \"glyphRef\",\n      \"hkern\",\n      \"image\",\n      \"line\",\n      \"missing-glyph\",\n      \"mpath\",\n      \"path\",\n      \"polygon\",\n      \"polyline\",\n      \"rect\",\n      \"set\",\n      \"stop\",\n      \"tref\",\n      \"use\",\n      \"view\",\n      \"vkern\"\n    ].join(\"|\") +\n    \")(?:[.#][a-zA-Z0-9\\u007F-\\uFFFF_:-]+)*$\"\n);\nfunction selfClosing(tag) {\n  return closeRE.test(tag);\n}\n\n// convert DOM attribute names to the property name used in js elements\nfunction attributeToProperty(h) {\n  let transform = {\n    class: \"className\",\n    for: \"htmlFor\",\n    \"http-equiv\": \"httpEquiv\"\n  };\n\n  return function(tagName, attrs = {}, children = []) {\n    for (let attr in attrs) {\n      if (attr in transform) {\n        attrs[transform[attr]] = attrs[attr];\n        delete attrs[attr];\n      }\n    }\n    return h(tagName, attrs, children);\n  };\n}\n\n// escape potentially malicious strings\nexport const escape = arg => {\n  if (typeof arg !== \"string\") return arg;\n  return arg\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\");\n};\n","export * from \"./streamy\";\nexport * from \"./render\";\nexport * from \"./streamy-vdom\";\nexport * from \"./streamy-helpers\";\n\nimport hyperx from \"./hyperx\";\nimport { h } from \"./streamy-vdom\";\nexport const zx = hyperx(h);\n","import { render } from \"../../src\";\n\nexport function testRender(\n  vdom$,\n  schedule,\n  done,\n  options = {\n    attach: false,\n    debounce: 0,\n    globals: {}\n  }\n) {\n  let container = document.createElement(\"div\");\n  if (options.attach) {\n    document.body.appendChild(container);\n  }\n  // enable to just define the expected html in the render schedule\n  schedule = schedule.map(expected => {\n    if (typeof expected === \"string\") {\n      return ({ element }) =>\n        // we trim line breaks to make outerHTML more like the visible DOM\n        expect(trimWhitespaces(element.outerHTML)).toBe(\n          trimWhitespaces(expected)\n        );\n    }\n    return expected;\n  });\n  return test$(\n    render(vdom$, container, options.globals, options.debounce),\n    schedule,\n    done\n  );\n}\n\n// trims whitespaces between tags and strings\nfunction trimWhitespaces(html) {\n  let trimmed = html.replace(/\\>(\\s*)(.*)(\\s*)\\</g, \">$2<\");\n  return trimmed;\n}\n\nexport function test$(stream, schedule, done) {\n  return stream.schedule(\n    schedule.map(iteration => async value => {\n      await testIteration(iteration, value).catch(done.fail);\n      return value;\n    }),\n    done\n  );\n}\n\nfunction testIteration(iteration, value) {\n  return new Promise((resolve, reject) => {\n    // tests produce async behavior often synchronous\n    // this can cause race effects on stream declarations\n    // here the iterations are made asynchronous to prevent this\n    setTimeout(function() {\n      try {\n        if (typeof iteration === \"function\") {\n          iteration(value);\n        } else {\n          expect(value).toEqual(iteration);\n        }\n        resolve();\n      } catch (error) {\n        reject(error);\n      }\n    });\n  });\n}\n","export * from \"./utils\";\nexport * from \"../test/helpers/test-component\";\n"],"sourceRoot":""}